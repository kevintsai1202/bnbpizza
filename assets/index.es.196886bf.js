import{aO as Pr,b8 as k_,b9 as mr,ba as ur,bb as Yc,bc as bt,aP as Nn,bd as zo,be as V_,bf as Cl,b3 as G_}from"./index.e9e0d510.js";import{e as hr}from"./index.3efe5bb5.js";import{c as W_,r as Y_}from"./index.b2957645.js";import{t as jr}from"./tslib.d836e37b.js";var Wo={},Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});function J_(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}Ss.safeJsonParse=J_;function Q_(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}Ss.safeJsonStringify=Q_;var ss={exports:{}},Ll;function X_(){return Ll||(Ll=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Pr<"u"&&Pr.localStorage?ss.exports=Pr.localStorage:typeof window<"u"&&window.localStorage?ss.exports=window.localStorage:ss.exports=new t}()),ss.exports}var Tc={},os={},Ul;function Z_(){if(Ul)return os;Ul=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IKeyValueStorage=void 0;class n{}return os.IKeyValueStorage=n,os}var as={},Dl;function em(){if(Dl)return as;Dl=1,Object.defineProperty(as,"__esModule",{value:!0}),as.parseEntry=void 0;const n=Ss;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return as.parseEntry=t,as}var $l;function tm(){return $l||($l=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(Z_(),n),t.__exportStar(em(),n)}(Tc)),Tc}Object.defineProperty(Wo,"__esModule",{value:!0});Wo.KeyValueStorage=void 0;const Tn=jr.exports,Ml=Ss,rm=Tn.__importDefault(X_()),im=tm();class cd{constructor(){this.localStorage=rm.default}getKeys(){return Tn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Tn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(im.parseEntry)})}getItem(t){return Tn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Ml.safeJsonParse(r)})}setItem(t,r){return Tn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Ml.safeJsonStringify(r))})}removeItem(t){return Tn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Wo.KeyValueStorage=cd;var nm=Wo.default=cd,Dn={},cs={},ye={},Rc={},us={},Fl;function sm(){if(Fl)return us;Fl=1,Object.defineProperty(us,"__esModule",{value:!0}),us.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return us.delay=n,us}var Qi={},Nc={},Xi={},jl;function om(){return jl||(jl=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.ONE_THOUSAND=Xi.ONE_HUNDRED=void 0,Xi.ONE_HUNDRED=100,Xi.ONE_THOUSAND=1e3),Xi}var Cc={},ql;function am(){return ql||(ql=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Cc)),Cc}var zl;function ud(){return zl||(zl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(om(),n),t.__exportStar(am(),n)}(Nc)),Nc}var Hl;function cm(){if(Hl)return Qi;Hl=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.fromMiliseconds=Qi.toMiliseconds=void 0;const n=ud();function t(s){return s*n.ONE_THOUSAND}Qi.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Qi.fromMiliseconds=r,Qi}var Kl;function um(){return Kl||(Kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(sm(),n),t.__exportStar(cm(),n)}(Rc)),Rc}var An={},Bl;function hm(){if(Bl)return An;Bl=1,Object.defineProperty(An,"__esModule",{value:!0}),An.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return An.Watch=n,An.default=n,An}var Lc={},hs={},kl;function lm(){if(kl)return hs;kl=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.IWatch=void 0;class n{}return hs.IWatch=n,hs}var Vl;function fm(){return Vl||(Vl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.exports.__exportStar(lm(),n)}(Lc)),Lc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(um(),n),t.__exportStar(hm(),n),t.__exportStar(fm(),n),t.__exportStar(ud(),n)})(ye);var Uc={},ls={};class rn{}const dm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:rn},Symbol.toStringTag,{value:"Module"})),pm=k_(dm);var Gl;function gm(){if(Gl)return ls;Gl=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.IHeartBeat=void 0;const n=pm;class t extends n.IEvents{constructor(s){super()}}return ls.IHeartBeat=t,ls}var Wl;function hd(){return Wl||(Wl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.exports.__exportStar(gm(),n)}(Uc)),Uc}var Dc={},Zi={},Yl;function vm(){if(Yl)return Zi;Yl=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.HEARTBEAT_EVENTS=Zi.HEARTBEAT_INTERVAL=void 0;const n=ye;return Zi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Zi}var Jl;function ld(){return Jl||(Jl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.exports.__exportStar(vm(),n)}(Dc)),Dc}var Ql;function ym(){if(Ql)return cs;Ql=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.HeartBeat=void 0;const n=jr.exports,t=hr.exports,r=ye,s=hd(),a=ld();class l extends s.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||a.HEARTBEAT_INTERVAL}static init(d){return n.__awaiter(this,void 0,void 0,function*(){const v=new l(d);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,v){this.events.on(d,v)}once(d,v){this.events.once(d,v)}off(d,v){this.events.off(d,v)}removeListener(d,v){this.events.removeListener(d,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return cs.HeartBeat=l,cs}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(ym(),n),t.__exportStar(hd(),n),t.__exportStar(ld(),n)})(Dn);var Ze={},$c,Xl;function _m(){if(Xl)return $c;Xl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}$c=t;function t(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var d=s.length+p;if(d===1)return r;var v=new Array(d);v[0]=l(r);for(var w=1;w<d;w++)v[w]=l(s[w]);return v.join(" ")}if(typeof r!="string")return r;var x=s.length;if(x===0)return r;for(var N="",L=1-p,T=-1,M=r&&r.length||0,H=0;H<M;){if(r.charCodeAt(H)===37&&H+1<M){switch(T=T>-1?T:0,r.charCodeAt(H+1)){case 100:case 102:if(L>=x||s[L]==null)break;T<H&&(N+=r.slice(T,H)),N+=Number(s[L]),T=H+2,H++;break;case 105:if(L>=x||s[L]==null)break;T<H&&(N+=r.slice(T,H)),N+=Math.floor(Number(s[L])),T=H+2,H++;break;case 79:case 111:case 106:if(L>=x||s[L]===void 0)break;T<H&&(N+=r.slice(T,H));var K=typeof s[L];if(K==="string"){N+="'"+s[L]+"'",T=H+2,H++;break}if(K==="function"){N+=s[L].name||"<anonymous>",T=H+2,H++;break}N+=l(s[L]),T=H+2,H++;break;case 115:if(L>=x)break;T<H&&(N+=r.slice(T,H)),N+=String(s[L]),T=H+2,H++;break;case 37:T<H&&(N+=r.slice(T,H)),N+="%",T=H+2,H++,L--;break}++L}++H}return T===-1?r:(T<M&&(N+=r.slice(T)),N)}return $c}var Mc,Zl;function mm(){if(Zl)return Mc;Zl=1;const n=_m();Mc=a;const t=q().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:H,wrapResponseSerializer:H,wrapErrorSerializer:H,req:M,res:M,err:L};function s(E,u){return Array.isArray(E)?E.filter(function(J){return J!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function a(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const m=E.browser.write||t;E.browser.write&&(E.browser.asObject=!0);const J=E.serializers||{},B=s(E.browser.serialize,J);let ie=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ie=!1);const ae=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),E.enabled===!1&&(E.level="silent");const ge=E.level||"info",O=Object.create(m);O.log||(O.log=K),Object.defineProperty(O,"levelVal",{get:he}),Object.defineProperty(O,"level",{get:Z,set:k});const $={transmit:u,serialize:B,asObject:E.browser.asObject,levels:ae,timestamp:T(E)};O.levels=a.levels,O.level=ge,O.setMaxListeners=O.getMaxListeners=O.emit=O.addListener=O.on=O.prependListener=O.once=O.prependOnceListener=O.removeListener=O.removeAllListeners=O.listeners=O.listenerCount=O.eventNames=O.write=O.flush=K,O.serializers=J,O._serialize=B,O._stdErrSerialize=ie,O.child=X,u&&(O._logEvent=N());function he(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Z(){return this._level}function k(V){if(V!=="silent"&&!this.levels.values[V])throw Error("unknown level "+V);this._level=V,l($,O,"error","log"),l($,O,"fatal","error"),l($,O,"warn","error"),l($,O,"info","log"),l($,O,"debug","log"),l($,O,"trace","log")}function X(V,ee){if(!V)throw new Error("missing bindings for child Pino");ee=ee||{},B&&V.serializers&&(ee.serializers=V.serializers);const Pe=ee.serializers;if(B&&Pe){var te=Object.assign({},J,Pe),we=E.browser.serialize===!0?Object.keys(te):B;delete V.serializers,v([V],we,te,this._stdErrSerialize)}function ue(_e){this._childLevel=(_e._childLevel|0)+1,this.error=w(_e,V,"error"),this.fatal=w(_e,V,"fatal"),this.warn=w(_e,V,"warn"),this.info=w(_e,V,"info"),this.debug=w(_e,V,"debug"),this.trace=w(_e,V,"trace"),te&&(this.serializers=te,this._serialize=we),u&&(this._logEvent=N([].concat(_e._logEvent.bindings,V)))}return ue.prototype=this,new ue(this)}return O}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:se,epochTime:fe,unixTime:ne,isoTime:F});function l(E,u,m,J){const B=Object.getPrototypeOf(u);u[m]=u.levelVal>u.levels.values[m]?K:B[m]?B[m]:t[m]||t[J]||K,p(E,u,m)}function p(E,u,m){!E.transmit&&u[m]===K||(u[m]=function(J){return function(){const ie=E.timestamp(),ae=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var O=0;O<ae.length;O++)ae[O]=arguments[O];if(E.serialize&&!E.asObject&&v(ae,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?J.call(ge,d(this,m,ae,ie)):J.apply(ge,ae),E.transmit){const $=E.transmit.level||u.level,he=a.levels.values[$],Z=a.levels.values[m];if(Z<he)return;x(this,{ts:ie,methodLevel:m,methodValue:Z,transmitLevel:$,transmitValue:a.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ae)}}}(u[m]))}function d(E,u,m,J){E._serialize&&v(m,E._serialize,E.serializers,E._stdErrSerialize);const B=m.slice();let ie=B[0];const ae={};J&&(ae.time=J),ae.level=a.levels.values[u];let ge=(E._childLevel|0)+1;if(ge<1&&(ge=1),ie!==null&&typeof ie=="object"){for(;ge--&&typeof B[0]=="object";)Object.assign(ae,B.shift());ie=B.length?n(B.shift(),B):void 0}else typeof ie=="string"&&(ie=n(B.shift(),B));return ie!==void 0&&(ae.msg=ie),ae}function v(E,u,m,J){for(const B in E)if(J&&E[B]instanceof Error)E[B]=a.stdSerializers.err(E[B]);else if(typeof E[B]=="object"&&!Array.isArray(E[B]))for(const ie in E[B])u&&u.indexOf(ie)>-1&&ie in m&&(E[B][ie]=m[ie](E[B][ie]))}function w(E,u,m){return function(){const J=new Array(1+arguments.length);J[0]=u;for(var B=1;B<J.length;B++)J[B]=arguments[B-1];return E[m].apply(this,J)}}function x(E,u,m){const J=u.send,B=u.ts,ie=u.methodLevel,ae=u.methodValue,ge=u.val,O=E._logEvent.bindings;v(m,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=B,E._logEvent.messages=m.filter(function($){return O.indexOf($)===-1}),E._logEvent.level.label=ie,E._logEvent.level.value=ae,J(ie,E._logEvent,ge),E._logEvent=N(O)}function N(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function L(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const m in E)u[m]===void 0&&(u[m]=E[m]);return u}function T(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?se:fe}function M(){return{}}function H(E){return E}function K(){}function se(){return!1}function fe(){return Date.now()}function ne(){return Math.round(Date.now()/1e3)}function F(){return new Date(Date.now()).toISOString()}function q(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Mc}var en={},ef;function fd(){return ef||(ef=1,Object.defineProperty(en,"__esModule",{value:!0}),en.PINO_CUSTOM_CONTEXT_KEY=en.PINO_LOGGER_DEFAULTS=void 0,en.PINO_LOGGER_DEFAULTS={level:"info"},en.PINO_CUSTOM_CONTEXT_KEY="custom_context"),en}var or={},tf;function wm(){if(tf)return or;tf=1,Object.defineProperty(or,"__esModule",{value:!0}),or.generateChildLogger=or.formatChildLoggerContext=or.getLoggerContext=or.setBrowserLoggerContext=or.getBrowserLoggerContext=or.getDefaultLoggerOptions=void 0;const n=fd();function t(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||n.PINO_LOGGER_DEFAULTS.level})}or.getDefaultLoggerOptions=t;function r(d,v=n.PINO_CUSTOM_CONTEXT_KEY){return d[v]||""}or.getBrowserLoggerContext=r;function s(d,v,w=n.PINO_CUSTOM_CONTEXT_KEY){return d[w]=v,d}or.setBrowserLoggerContext=s;function a(d,v=n.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof d.bindings>"u"?w=r(d,v):w=d.bindings().context||"",w}or.getLoggerContext=a;function l(d,v,w=n.PINO_CUSTOM_CONTEXT_KEY){const x=a(d,w);return x.trim()?`${x}/${v}`:v}or.formatChildLoggerContext=l;function p(d,v,w=n.PINO_CUSTOM_CONTEXT_KEY){const x=l(d,v,w),N=d.child({context:x});return s(N,x,w)}return or.generateChildLogger=p,or}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=jr.exports,r=t.__importDefault(mm());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(fd(),n),t.__exportStar(wm(),n)})(Ze);class bm extends rn{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Em extends rn{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class Sm{constructor(t,r){this.logger=t,this.core=r}}class Im extends rn{constructor(t,r){super(),this.relayer=t,this.logger=r}}class xm extends rn{constructor(t){super()}}class Pm{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}}class Om extends rn{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Am extends rn{constructor(t,r){super(),this.core=t,this.logger=r}}class Tm{constructor(t,r){this.projectId=t,this.logger=r}}class Rm{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class Nm{constructor(t){this.client=t}}const Cm=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Lm=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function lu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Lm(n)}catch{return n}}function bs(n){return typeof n=="string"?n:Cm(n)||""}var fu={},$n={},Yo={},Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});Jo.BrowserRandomSource=void 0;const rf=65536;class Um{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=rf)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,rf)));return r}}Jo.BrowserRandomSource=Um;var Qo={},Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function Dm(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Ar.wipe=Dm;Object.defineProperty(Qo,"__esModule",{value:!0});Qo.NodeRandomSource=void 0;const $m=Ar;class Mm{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof W_<"u"){const t=Y_();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,$m.wipe)(r),s}}Qo.NodeRandomSource=Mm;Object.defineProperty(Yo,"__esModule",{value:!0});Yo.SystemRandomSource=void 0;const Fm=Jo,jm=Qo;class qm{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Fm.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new jm.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Yo.SystemRandomSource=qm;var $e={},dd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(d,v){var w=d>>>16&65535,x=d&65535,N=v>>>16&65535,L=v&65535;return x*L+(w*L+x*N<<16>>>0)|0}n.mul=Math.imul||t;function r(d,v){return d+v|0}n.add=r;function s(d,v){return d-v|0}n.sub=s;function a(d,v){return d<<v|d>>>32-v}n.rotl=a;function l(d,v){return d<<32-v|d>>>v}n.rotr=l;function p(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(d){return n.isInteger(d)&&d>=-n.MAX_SAFE_INTEGER&&d<=n.MAX_SAFE_INTEGER}})(dd);Object.defineProperty($e,"__esModule",{value:!0});var pd=dd;function zm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}$e.readInt16BE=zm;function Hm(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}$e.readUint16BE=Hm;function Km(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}$e.readInt16LE=Km;function Bm(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}$e.readUint16LE=Bm;function gd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}$e.writeUint16BE=gd;$e.writeInt16BE=gd;function vd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}$e.writeUint16LE=vd;$e.writeInt16LE=vd;function Jc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}$e.readInt32BE=Jc;function Qc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}$e.readUint32BE=Qc;function Xc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}$e.readInt32LE=Xc;function Zc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}$e.readUint32LE=Zc;function Ho(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}$e.writeUint32BE=Ho;$e.writeInt32BE=Ho;function Ko(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}$e.writeUint32LE=Ko;$e.writeInt32LE=Ko;function km(n,t){t===void 0&&(t=0);var r=Jc(n,t),s=Jc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}$e.readInt64BE=km;function Vm(n,t){t===void 0&&(t=0);var r=Qc(n,t),s=Qc(n,t+4);return r*4294967296+s}$e.readUint64BE=Vm;function Gm(n,t){t===void 0&&(t=0);var r=Xc(n,t),s=Xc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}$e.readInt64LE=Gm;function Wm(n,t){t===void 0&&(t=0);var r=Zc(n,t),s=Zc(n,t+4);return s*4294967296+r}$e.readUint64LE=Wm;function yd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ho(n/4294967296>>>0,t,r),Ho(n>>>0,t,r+4),t}$e.writeUint64BE=yd;$e.writeInt64BE=yd;function _d(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ko(n>>>0,t,r),Ko(n/4294967296>>>0,t,r+4),t}$e.writeUint64LE=_d;$e.writeInt64LE=_d;function Ym(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=t[l]*a,a*=256;return s}$e.readUintBE=Ym;function Jm(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=t[l]*a,a*=256;return s}$e.readUintLE=Jm;function Qm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!pd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=t/a&255,a*=256;return r}$e.writeUintBE=Qm;function Xm(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!pd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=t/a&255,a*=256;return r}$e.writeUintLE=Xm;function Zm(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}$e.readFloat32BE=Zm;function ew(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}$e.readFloat32LE=ew;function tw(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}$e.readFloat64BE=tw;function rw(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}$e.readFloat64LE=rw;function iw(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}$e.writeFloat32BE=iw;function nw(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}$e.writeFloat32LE=nw;function sw(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}$e.writeFloat64BE=sw;function ow(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}$e.writeFloat64LE=ow;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=Yo,r=$e,s=Ar;n.defaultRandomSource=new t.SystemRandomSource;function a(w,x=n.defaultRandomSource){return x.randomBytes(w)}n.randomBytes=a;function l(w=n.defaultRandomSource){const x=a(4,w),N=(0,r.readUint32LE)(x);return(0,s.wipe)(x),N}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(w,x=p,N=n.defaultRandomSource){if(x.length<2)throw new Error("randomString charset is too short");if(x.length>256)throw new Error("randomString charset is too long");let L="";const T=x.length,M=256-256%T;for(;w>0;){const H=a(Math.ceil(w*256/M),N);for(let K=0;K<H.length&&w>0;K++){const se=H[K];se<M&&(L+=x.charAt(se%T),w--)}(0,s.wipe)(H)}return L}n.randomString=d;function v(w,x=p,N=n.defaultRandomSource){const L=Math.ceil(w/(Math.log(x.length)/Math.LN2));return d(L,x,N)}n.randomStringForEntropy=v})($n);var md={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Ar;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(v,w){if(w===void 0&&(w=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var x=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=v[x++],w--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(x=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,x,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=v[x++],w--;return this},d.prototype.finish=function(v){if(!this._finished){var w=this._bytesHashed,x=this._bufferLength,N=w/536870912|0,L=w<<3,T=w%128<112?128:256;this._buffer[x]=128;for(var M=x+1;M<T-8;M++)this._buffer[M]=0;t.writeUint32BE(N,this._buffer,T-8),t.writeUint32BE(L,this._buffer,T-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)t.writeUint32BE(this._stateHi[M],v,M*8),t.writeUint32BE(this._stateLo[M],v,M*8+4);return this},d.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},d}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(d,v,w,x,N,L,T){for(var M=w[0],H=w[1],K=w[2],se=w[3],fe=w[4],ne=w[5],F=w[6],q=w[7],E=x[0],u=x[1],m=x[2],J=x[3],B=x[4],ie=x[5],ae=x[6],ge=x[7],O,$,he,Z,k,X,V,ee;T>=128;){for(var Pe=0;Pe<16;Pe++){var te=8*Pe+L;d[Pe]=t.readUint32BE(N,te),v[Pe]=t.readUint32BE(N,te+4)}for(var Pe=0;Pe<80;Pe++){var we=M,ue=H,_e=K,D=se,U=fe,P=ne,h=F,S=q,re=E,le=u,Ie=m,He=J,ke=B,Me=ie,pt=ae,gt=ge;if(O=q,$=ge,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=(fe>>>14|B<<32-14)^(fe>>>18|B<<32-18)^(B>>>41-32|fe<<32-(41-32)),$=(B>>>14|fe<<32-14)^(B>>>18|fe<<32-18)^(fe>>>41-32|B<<32-(41-32)),k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,O=fe&ne^~fe&F,$=B&ie^~B&ae,k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,O=a[Pe*2],$=a[Pe*2+1],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,O=d[Pe%16],$=v[Pe%16],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,he=V&65535|ee<<16,Z=k&65535|X<<16,O=he,$=Z,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=(M>>>28|E<<32-28)^(E>>>34-32|M<<32-(34-32))^(E>>>39-32|M<<32-(39-32)),$=(E>>>28|M<<32-28)^(M>>>34-32|E<<32-(34-32))^(M>>>39-32|E<<32-(39-32)),k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,O=M&H^M&K^H&K,$=E&u^E&m^u&m,k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,S=V&65535|ee<<16,gt=k&65535|X<<16,O=D,$=He,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=he,$=Z,k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,D=V&65535|ee<<16,He=k&65535|X<<16,H=we,K=ue,se=_e,fe=D,ne=U,F=P,q=h,M=S,u=re,m=le,J=Ie,B=He,ie=ke,ae=Me,ge=pt,E=gt,Pe%16===15)for(var te=0;te<16;te++)O=d[te],$=v[te],k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=d[(te+9)%16],$=v[(te+9)%16],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,he=d[(te+1)%16],Z=v[(te+1)%16],O=(he>>>1|Z<<32-1)^(he>>>8|Z<<32-8)^he>>>7,$=(Z>>>1|he<<32-1)^(Z>>>8|he<<32-8)^(Z>>>7|he<<32-7),k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,he=d[(te+14)%16],Z=v[(te+14)%16],O=(he>>>19|Z<<32-19)^(Z>>>61-32|he<<32-(61-32))^he>>>6,$=(Z>>>19|he<<32-19)^(he>>>61-32|Z<<32-(61-32))^(Z>>>6|he<<32-6),k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,d[te]=V&65535|ee<<16,v[te]=k&65535|X<<16}O=M,$=E,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[0],$=x[0],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[0]=M=V&65535|ee<<16,x[0]=E=k&65535|X<<16,O=H,$=u,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[1],$=x[1],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[1]=H=V&65535|ee<<16,x[1]=u=k&65535|X<<16,O=K,$=m,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[2],$=x[2],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[2]=K=V&65535|ee<<16,x[2]=m=k&65535|X<<16,O=se,$=J,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[3],$=x[3],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[3]=se=V&65535|ee<<16,x[3]=J=k&65535|X<<16,O=fe,$=B,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[4],$=x[4],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[4]=fe=V&65535|ee<<16,x[4]=B=k&65535|X<<16,O=ne,$=ie,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[5],$=x[5],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[5]=ne=V&65535|ee<<16,x[5]=ie=k&65535|X<<16,O=F,$=ae,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[6],$=x[6],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[6]=F=V&65535|ee<<16,x[6]=ae=k&65535|X<<16,O=q,$=ge,k=$&65535,X=$>>>16,V=O&65535,ee=O>>>16,O=w[7],$=x[7],k+=$&65535,X+=$>>>16,V+=O&65535,ee+=O>>>16,X+=k>>>16,V+=X>>>16,ee+=V>>>16,w[7]=q=V&65535|ee<<16,x[7]=ge=k&65535|X<<16,L+=128,T-=128}return L}function p(d){var v=new s;v.update(d);var w=v.digest();return v.clean(),w}n.hash=p})(md);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=$n,r=md,s=Ar;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(D){const U=new Float64Array(16);if(D)for(let P=0;P<D.length;P++)U[P]=D[P];return U}const l=new Uint8Array(32);l[0]=9;const p=a(),d=a([1]),v=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),x=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(D,U){for(let P=0;P<16;P++)D[P]=U[P]|0}function M(D){let U=1;for(let P=0;P<16;P++){let h=D[P]+U+65535;U=Math.floor(h/65536),D[P]=h-U*65536}D[0]+=U-1+37*(U-1)}function H(D,U,P){const h=~(P-1);for(let S=0;S<16;S++){const re=h&(D[S]^U[S]);D[S]^=re,U[S]^=re}}function K(D,U){const P=a(),h=a();for(let S=0;S<16;S++)h[S]=U[S];M(h),M(h),M(h);for(let S=0;S<2;S++){P[0]=h[0]-65517;for(let le=1;le<15;le++)P[le]=h[le]-65535-(P[le-1]>>16&1),P[le-1]&=65535;P[15]=h[15]-32767-(P[14]>>16&1);const re=P[15]>>16&1;P[14]&=65535,H(h,P,1-re)}for(let S=0;S<16;S++)D[2*S]=h[S]&255,D[2*S+1]=h[S]>>8}function se(D,U){let P=0;for(let h=0;h<32;h++)P|=D[h]^U[h];return(1&P-1>>>8)-1}function fe(D,U){const P=new Uint8Array(32),h=new Uint8Array(32);return K(P,D),K(h,U),se(P,h)}function ne(D){const U=new Uint8Array(32);return K(U,D),U[0]&1}function F(D,U){for(let P=0;P<16;P++)D[P]=U[2*P]+(U[2*P+1]<<8);D[15]&=32767}function q(D,U,P){for(let h=0;h<16;h++)D[h]=U[h]+P[h]}function E(D,U,P){for(let h=0;h<16;h++)D[h]=U[h]-P[h]}function u(D,U,P){let h,S,re=0,le=0,Ie=0,He=0,ke=0,Me=0,pt=0,gt=0,je=0,xe=0,Le=0,Ue=0,qe=0,Ae=0,De=0,Se=0,Te=0,Ke=0,Oe=0,Ve=0,We=0,et=0,tt=0,Je=0,er=0,lr=0,Wr=0,tr=0,ni=0,bi=0,Mi=0,Et=P[0],vt=P[1],St=P[2],It=P[3],mt=P[4],yt=P[5],Dt=P[6],$t=P[7],xt=P[8],Mt=P[9],Pt=P[10],Tt=P[11],Ot=P[12],ht=P[13],Ft=P[14],jt=P[15];h=U[0],re+=h*Et,le+=h*vt,Ie+=h*St,He+=h*It,ke+=h*mt,Me+=h*yt,pt+=h*Dt,gt+=h*$t,je+=h*xt,xe+=h*Mt,Le+=h*Pt,Ue+=h*Tt,qe+=h*Ot,Ae+=h*ht,De+=h*Ft,Se+=h*jt,h=U[1],le+=h*Et,Ie+=h*vt,He+=h*St,ke+=h*It,Me+=h*mt,pt+=h*yt,gt+=h*Dt,je+=h*$t,xe+=h*xt,Le+=h*Mt,Ue+=h*Pt,qe+=h*Tt,Ae+=h*Ot,De+=h*ht,Se+=h*Ft,Te+=h*jt,h=U[2],Ie+=h*Et,He+=h*vt,ke+=h*St,Me+=h*It,pt+=h*mt,gt+=h*yt,je+=h*Dt,xe+=h*$t,Le+=h*xt,Ue+=h*Mt,qe+=h*Pt,Ae+=h*Tt,De+=h*Ot,Se+=h*ht,Te+=h*Ft,Ke+=h*jt,h=U[3],He+=h*Et,ke+=h*vt,Me+=h*St,pt+=h*It,gt+=h*mt,je+=h*yt,xe+=h*Dt,Le+=h*$t,Ue+=h*xt,qe+=h*Mt,Ae+=h*Pt,De+=h*Tt,Se+=h*Ot,Te+=h*ht,Ke+=h*Ft,Oe+=h*jt,h=U[4],ke+=h*Et,Me+=h*vt,pt+=h*St,gt+=h*It,je+=h*mt,xe+=h*yt,Le+=h*Dt,Ue+=h*$t,qe+=h*xt,Ae+=h*Mt,De+=h*Pt,Se+=h*Tt,Te+=h*Ot,Ke+=h*ht,Oe+=h*Ft,Ve+=h*jt,h=U[5],Me+=h*Et,pt+=h*vt,gt+=h*St,je+=h*It,xe+=h*mt,Le+=h*yt,Ue+=h*Dt,qe+=h*$t,Ae+=h*xt,De+=h*Mt,Se+=h*Pt,Te+=h*Tt,Ke+=h*Ot,Oe+=h*ht,Ve+=h*Ft,We+=h*jt,h=U[6],pt+=h*Et,gt+=h*vt,je+=h*St,xe+=h*It,Le+=h*mt,Ue+=h*yt,qe+=h*Dt,Ae+=h*$t,De+=h*xt,Se+=h*Mt,Te+=h*Pt,Ke+=h*Tt,Oe+=h*Ot,Ve+=h*ht,We+=h*Ft,et+=h*jt,h=U[7],gt+=h*Et,je+=h*vt,xe+=h*St,Le+=h*It,Ue+=h*mt,qe+=h*yt,Ae+=h*Dt,De+=h*$t,Se+=h*xt,Te+=h*Mt,Ke+=h*Pt,Oe+=h*Tt,Ve+=h*Ot,We+=h*ht,et+=h*Ft,tt+=h*jt,h=U[8],je+=h*Et,xe+=h*vt,Le+=h*St,Ue+=h*It,qe+=h*mt,Ae+=h*yt,De+=h*Dt,Se+=h*$t,Te+=h*xt,Ke+=h*Mt,Oe+=h*Pt,Ve+=h*Tt,We+=h*Ot,et+=h*ht,tt+=h*Ft,Je+=h*jt,h=U[9],xe+=h*Et,Le+=h*vt,Ue+=h*St,qe+=h*It,Ae+=h*mt,De+=h*yt,Se+=h*Dt,Te+=h*$t,Ke+=h*xt,Oe+=h*Mt,Ve+=h*Pt,We+=h*Tt,et+=h*Ot,tt+=h*ht,Je+=h*Ft,er+=h*jt,h=U[10],Le+=h*Et,Ue+=h*vt,qe+=h*St,Ae+=h*It,De+=h*mt,Se+=h*yt,Te+=h*Dt,Ke+=h*$t,Oe+=h*xt,Ve+=h*Mt,We+=h*Pt,et+=h*Tt,tt+=h*Ot,Je+=h*ht,er+=h*Ft,lr+=h*jt,h=U[11],Ue+=h*Et,qe+=h*vt,Ae+=h*St,De+=h*It,Se+=h*mt,Te+=h*yt,Ke+=h*Dt,Oe+=h*$t,Ve+=h*xt,We+=h*Mt,et+=h*Pt,tt+=h*Tt,Je+=h*Ot,er+=h*ht,lr+=h*Ft,Wr+=h*jt,h=U[12],qe+=h*Et,Ae+=h*vt,De+=h*St,Se+=h*It,Te+=h*mt,Ke+=h*yt,Oe+=h*Dt,Ve+=h*$t,We+=h*xt,et+=h*Mt,tt+=h*Pt,Je+=h*Tt,er+=h*Ot,lr+=h*ht,Wr+=h*Ft,tr+=h*jt,h=U[13],Ae+=h*Et,De+=h*vt,Se+=h*St,Te+=h*It,Ke+=h*mt,Oe+=h*yt,Ve+=h*Dt,We+=h*$t,et+=h*xt,tt+=h*Mt,Je+=h*Pt,er+=h*Tt,lr+=h*Ot,Wr+=h*ht,tr+=h*Ft,ni+=h*jt,h=U[14],De+=h*Et,Se+=h*vt,Te+=h*St,Ke+=h*It,Oe+=h*mt,Ve+=h*yt,We+=h*Dt,et+=h*$t,tt+=h*xt,Je+=h*Mt,er+=h*Pt,lr+=h*Tt,Wr+=h*Ot,tr+=h*ht,ni+=h*Ft,bi+=h*jt,h=U[15],Se+=h*Et,Te+=h*vt,Ke+=h*St,Oe+=h*It,Ve+=h*mt,We+=h*yt,et+=h*Dt,tt+=h*$t,Je+=h*xt,er+=h*Mt,lr+=h*Pt,Wr+=h*Tt,tr+=h*Ot,ni+=h*ht,bi+=h*Ft,Mi+=h*jt,re+=38*Te,le+=38*Ke,Ie+=38*Oe,He+=38*Ve,ke+=38*We,Me+=38*et,pt+=38*tt,gt+=38*Je,je+=38*er,xe+=38*lr,Le+=38*Wr,Ue+=38*tr,qe+=38*ni,Ae+=38*bi,De+=38*Mi,S=1,h=re+S+65535,S=Math.floor(h/65536),re=h-S*65536,h=le+S+65535,S=Math.floor(h/65536),le=h-S*65536,h=Ie+S+65535,S=Math.floor(h/65536),Ie=h-S*65536,h=He+S+65535,S=Math.floor(h/65536),He=h-S*65536,h=ke+S+65535,S=Math.floor(h/65536),ke=h-S*65536,h=Me+S+65535,S=Math.floor(h/65536),Me=h-S*65536,h=pt+S+65535,S=Math.floor(h/65536),pt=h-S*65536,h=gt+S+65535,S=Math.floor(h/65536),gt=h-S*65536,h=je+S+65535,S=Math.floor(h/65536),je=h-S*65536,h=xe+S+65535,S=Math.floor(h/65536),xe=h-S*65536,h=Le+S+65535,S=Math.floor(h/65536),Le=h-S*65536,h=Ue+S+65535,S=Math.floor(h/65536),Ue=h-S*65536,h=qe+S+65535,S=Math.floor(h/65536),qe=h-S*65536,h=Ae+S+65535,S=Math.floor(h/65536),Ae=h-S*65536,h=De+S+65535,S=Math.floor(h/65536),De=h-S*65536,h=Se+S+65535,S=Math.floor(h/65536),Se=h-S*65536,re+=S-1+37*(S-1),S=1,h=re+S+65535,S=Math.floor(h/65536),re=h-S*65536,h=le+S+65535,S=Math.floor(h/65536),le=h-S*65536,h=Ie+S+65535,S=Math.floor(h/65536),Ie=h-S*65536,h=He+S+65535,S=Math.floor(h/65536),He=h-S*65536,h=ke+S+65535,S=Math.floor(h/65536),ke=h-S*65536,h=Me+S+65535,S=Math.floor(h/65536),Me=h-S*65536,h=pt+S+65535,S=Math.floor(h/65536),pt=h-S*65536,h=gt+S+65535,S=Math.floor(h/65536),gt=h-S*65536,h=je+S+65535,S=Math.floor(h/65536),je=h-S*65536,h=xe+S+65535,S=Math.floor(h/65536),xe=h-S*65536,h=Le+S+65535,S=Math.floor(h/65536),Le=h-S*65536,h=Ue+S+65535,S=Math.floor(h/65536),Ue=h-S*65536,h=qe+S+65535,S=Math.floor(h/65536),qe=h-S*65536,h=Ae+S+65535,S=Math.floor(h/65536),Ae=h-S*65536,h=De+S+65535,S=Math.floor(h/65536),De=h-S*65536,h=Se+S+65535,S=Math.floor(h/65536),Se=h-S*65536,re+=S-1+37*(S-1),D[0]=re,D[1]=le,D[2]=Ie,D[3]=He,D[4]=ke,D[5]=Me,D[6]=pt,D[7]=gt,D[8]=je,D[9]=xe,D[10]=Le,D[11]=Ue,D[12]=qe,D[13]=Ae,D[14]=De,D[15]=Se}function m(D,U){u(D,U,U)}function J(D,U){const P=a();let h;for(h=0;h<16;h++)P[h]=U[h];for(h=253;h>=0;h--)m(P,P),h!==2&&h!==4&&u(P,P,U);for(h=0;h<16;h++)D[h]=P[h]}function B(D,U){const P=a();let h;for(h=0;h<16;h++)P[h]=U[h];for(h=250;h>=0;h--)m(P,P),h!==1&&u(P,P,U);for(h=0;h<16;h++)D[h]=P[h]}function ie(D,U){const P=a(),h=a(),S=a(),re=a(),le=a(),Ie=a(),He=a(),ke=a(),Me=a();E(P,D[1],D[0]),E(Me,U[1],U[0]),u(P,P,Me),q(h,D[0],D[1]),q(Me,U[0],U[1]),u(h,h,Me),u(S,D[3],U[3]),u(S,S,w),u(re,D[2],U[2]),q(re,re,re),E(le,h,P),E(Ie,re,S),q(He,re,S),q(ke,h,P),u(D[0],le,Ie),u(D[1],ke,He),u(D[2],He,Ie),u(D[3],le,ke)}function ae(D,U,P){for(let h=0;h<4;h++)H(D[h],U[h],P)}function ge(D,U){const P=a(),h=a(),S=a();J(S,U[2]),u(P,U[0],S),u(h,U[1],S),K(D,h),D[31]^=ne(P)<<7}function O(D,U,P){T(D[0],p),T(D[1],d),T(D[2],d),T(D[3],p);for(let h=255;h>=0;--h){const S=P[h/8|0]>>(h&7)&1;ae(D,U,S),ie(U,D),ie(D,D),ae(D,U,S)}}function $(D,U){const P=[a(),a(),a(),a()];T(P[0],x),T(P[1],N),T(P[2],d),u(P[3],x,N),O(D,P,U)}function he(D){if(D.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const U=(0,r.hash)(D);U[0]&=248,U[31]&=127,U[31]|=64;const P=new Uint8Array(32),h=[a(),a(),a(),a()];$(h,U),ge(P,h);const S=new Uint8Array(64);return S.set(D),S.set(P,32),{publicKey:P,secretKey:S}}n.generateKeyPairFromSeed=he;function Z(D){const U=(0,t.randomBytes)(32,D),P=he(U);return(0,s.wipe)(U),P}n.generateKeyPair=Z;function k(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}n.extractPublicKeyFromSecretKey=k;const X=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function V(D,U){let P,h,S,re;for(h=63;h>=32;--h){for(P=0,S=h-32,re=h-12;S<re;++S)U[S]+=P-16*U[h]*X[S-(h-32)],P=Math.floor((U[S]+128)/256),U[S]-=P*256;U[S]+=P,U[h]=0}for(P=0,S=0;S<32;S++)U[S]+=P-(U[31]>>4)*X[S],P=U[S]>>8,U[S]&=255;for(S=0;S<32;S++)U[S]-=P*X[S];for(h=0;h<32;h++)U[h+1]+=U[h]>>8,D[h]=U[h]&255}function ee(D){const U=new Float64Array(64);for(let P=0;P<64;P++)U[P]=D[P];for(let P=0;P<64;P++)D[P]=0;V(D,U)}function Pe(D,U){const P=new Float64Array(64),h=[a(),a(),a(),a()],S=(0,r.hash)(D.subarray(0,32));S[0]&=248,S[31]&=127,S[31]|=64;const re=new Uint8Array(64);re.set(S.subarray(32),32);const le=new r.SHA512;le.update(re.subarray(32)),le.update(U);const Ie=le.digest();le.clean(),ee(Ie),$(h,Ie),ge(re,h),le.reset(),le.update(re.subarray(0,32)),le.update(D.subarray(32)),le.update(U);const He=le.digest();ee(He);for(let ke=0;ke<32;ke++)P[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)P[ke+Me]+=He[ke]*S[Me];return V(re.subarray(32),P),re}n.sign=Pe;function te(D,U){const P=a(),h=a(),S=a(),re=a(),le=a(),Ie=a(),He=a();return T(D[2],d),F(D[1],U),m(S,D[1]),u(re,S,v),E(S,S,D[2]),q(re,D[2],re),m(le,re),m(Ie,le),u(He,Ie,le),u(P,He,S),u(P,P,re),B(P,P),u(P,P,S),u(P,P,re),u(P,P,re),u(D[0],P,re),m(h,D[0]),u(h,h,re),fe(h,S)&&u(D[0],D[0],L),m(h,D[0]),u(h,h,re),fe(h,S)?-1:(ne(D[0])===U[31]>>7&&E(D[0],p,D[0]),u(D[3],D[0],D[1]),0)}function we(D,U,P){const h=new Uint8Array(32),S=[a(),a(),a(),a()],re=[a(),a(),a(),a()];if(P.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(te(re,D))return!1;const le=new r.SHA512;le.update(P.subarray(0,32)),le.update(D),le.update(U);const Ie=le.digest();return ee(Ie),O(S,re,Ie),$(re,P.subarray(32)),ie(S,re),ge(h,S),!se(P,h)}n.verify=we;function ue(D){let U=[a(),a(),a(),a()];if(te(U,D))throw new Error("Ed25519: invalid public key");let P=a(),h=a(),S=U[1];q(P,d,S),E(h,d,S),J(h,h),u(P,P,h);let re=new Uint8Array(32);return K(re,P),re}n.convertPublicKeyToX25519=ue;function _e(D){const U=(0,r.hash)(D.subarray(0,32));U[0]&=248,U[31]&=127,U[31]|=64;const P=new Uint8Array(U.subarray(0,32));return(0,s.wipe)(U),P}n.convertSecretKeyToX25519=_e})(fu);const aw="EdDSA",cw="JWT",wd=".",bd="base64url",uw="utf8",hw="utf8",lw=":",fw="did",dw="key",nf="base58btc",pw="z",gw="K36",vw=32;function Bo(n){return ur(mr(bs(n),uw),bd)}function Ed(n){const t=mr(gw,nf),r=pw+ur(Yc([t,n]),nf);return[fw,dw,r].join(lw)}function yw(n){return ur(n,bd)}function _w(n){return mr([Bo(n.header),Bo(n.payload)].join(wd),hw)}function mw(n){return[Bo(n.header),Bo(n.payload),yw(n.signature)].join(wd)}function sf(n=$n.randomBytes(vw)){return fu.generateKeyPairFromSeed(n)}async function ww(n,t,r,s,a=ye.fromMiliseconds(Date.now())){const l={alg:aw,typ:cw},p=Ed(s.publicKey),d=a+r,v={iss:p,sub:n,aud:t,iat:a,exp:d},w=_w({header:l,payload:v}),x=fu.sign(s.secretKey,w);return mw({header:l,payload:v,signature:x})}var du={},Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});var Xt=$e,eu=Ar,bw=20;function Ew(n,t,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,d=r[3]<<24|r[2]<<16|r[1]<<8|r[0],v=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],x=r[15]<<24|r[14]<<16|r[13]<<8|r[12],N=r[19]<<24|r[18]<<16|r[17]<<8|r[16],L=r[23]<<24|r[22]<<16|r[21]<<8|r[20],T=r[27]<<24|r[26]<<16|r[25]<<8|r[24],M=r[31]<<24|r[30]<<16|r[29]<<8|r[28],H=t[3]<<24|t[2]<<16|t[1]<<8|t[0],K=t[7]<<24|t[6]<<16|t[5]<<8|t[4],se=t[11]<<24|t[10]<<16|t[9]<<8|t[8],fe=t[15]<<24|t[14]<<16|t[13]<<8|t[12],ne=s,F=a,q=l,E=p,u=d,m=v,J=w,B=x,ie=N,ae=L,ge=T,O=M,$=H,he=K,Z=se,k=fe,X=0;X<bw;X+=2)ne=ne+u|0,$^=ne,$=$>>>32-16|$<<16,ie=ie+$|0,u^=ie,u=u>>>32-12|u<<12,F=F+m|0,he^=F,he=he>>>32-16|he<<16,ae=ae+he|0,m^=ae,m=m>>>32-12|m<<12,q=q+J|0,Z^=q,Z=Z>>>32-16|Z<<16,ge=ge+Z|0,J^=ge,J=J>>>32-12|J<<12,E=E+B|0,k^=E,k=k>>>32-16|k<<16,O=O+k|0,B^=O,B=B>>>32-12|B<<12,q=q+J|0,Z^=q,Z=Z>>>32-8|Z<<8,ge=ge+Z|0,J^=ge,J=J>>>32-7|J<<7,E=E+B|0,k^=E,k=k>>>32-8|k<<8,O=O+k|0,B^=O,B=B>>>32-7|B<<7,F=F+m|0,he^=F,he=he>>>32-8|he<<8,ae=ae+he|0,m^=ae,m=m>>>32-7|m<<7,ne=ne+u|0,$^=ne,$=$>>>32-8|$<<8,ie=ie+$|0,u^=ie,u=u>>>32-7|u<<7,ne=ne+m|0,k^=ne,k=k>>>32-16|k<<16,ge=ge+k|0,m^=ge,m=m>>>32-12|m<<12,F=F+J|0,$^=F,$=$>>>32-16|$<<16,O=O+$|0,J^=O,J=J>>>32-12|J<<12,q=q+B|0,he^=q,he=he>>>32-16|he<<16,ie=ie+he|0,B^=ie,B=B>>>32-12|B<<12,E=E+u|0,Z^=E,Z=Z>>>32-16|Z<<16,ae=ae+Z|0,u^=ae,u=u>>>32-12|u<<12,q=q+B|0,he^=q,he=he>>>32-8|he<<8,ie=ie+he|0,B^=ie,B=B>>>32-7|B<<7,E=E+u|0,Z^=E,Z=Z>>>32-8|Z<<8,ae=ae+Z|0,u^=ae,u=u>>>32-7|u<<7,F=F+J|0,$^=F,$=$>>>32-8|$<<8,O=O+$|0,J^=O,J=J>>>32-7|J<<7,ne=ne+m|0,k^=ne,k=k>>>32-8|k<<8,ge=ge+k|0,m^=ge,m=m>>>32-7|m<<7;Xt.writeUint32LE(ne+s|0,n,0),Xt.writeUint32LE(F+a|0,n,4),Xt.writeUint32LE(q+l|0,n,8),Xt.writeUint32LE(E+p|0,n,12),Xt.writeUint32LE(u+d|0,n,16),Xt.writeUint32LE(m+v|0,n,20),Xt.writeUint32LE(J+w|0,n,24),Xt.writeUint32LE(B+x|0,n,28),Xt.writeUint32LE(ie+N|0,n,32),Xt.writeUint32LE(ae+L|0,n,36),Xt.writeUint32LE(ge+T|0,n,40),Xt.writeUint32LE(O+M|0,n,44),Xt.writeUint32LE($+H|0,n,48),Xt.writeUint32LE(he+K|0,n,52),Xt.writeUint32LE(Z+se|0,n,56),Xt.writeUint32LE(k+fe|0,n,60)}function Sd(n,t,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-t.length,l.set(t,p)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,p=a}for(var d=new Uint8Array(64),v=0;v<r.length;v+=64){Ew(d,l,n);for(var w=v;w<v+64&&w<r.length;w++)s[w]=r[w]^d[w-v];Iw(l,0,p)}return eu.wipe(d),a===0&&eu.wipe(l),s}Xo.streamXOR=Sd;function Sw(n,t,r,s){return s===void 0&&(s=0),eu.wipe(r),Sd(n,t,r,r,s)}Xo.stream=Sw;function Iw(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var Id={},Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});function xw(n,t,r){return~(n-1)&t|n-1&r}Ui.select=xw;function Pw(n,t){return(n|0)-(t|0)-1>>>31&1}Ui.lessOrEqual=Pw;function xd(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ui.compare=xd;function Ow(n,t){return n.length===0||t.length===0?!1:xd(n,t)!==0}Ui.equal=Ow;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ui,r=Ar;n.DIGEST_LENGTH=16;var s=function(){function p(d){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=d[0]|d[1]<<8;this._r[0]=v&8191;var w=d[2]|d[3]<<8;this._r[1]=(v>>>13|w<<3)&8191;var x=d[4]|d[5]<<8;this._r[2]=(w>>>10|x<<6)&7939;var N=d[6]|d[7]<<8;this._r[3]=(x>>>7|N<<9)&8191;var L=d[8]|d[9]<<8;this._r[4]=(N>>>4|L<<12)&255,this._r[5]=L>>>1&8190;var T=d[10]|d[11]<<8;this._r[6]=(L>>>14|T<<2)&8191;var M=d[12]|d[13]<<8;this._r[7]=(T>>>11|M<<5)&8065;var H=d[14]|d[15]<<8;this._r[8]=(M>>>8|H<<8)&8191,this._r[9]=H>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return p.prototype._blocks=function(d,v,w){for(var x=this._fin?0:2048,N=this._h[0],L=this._h[1],T=this._h[2],M=this._h[3],H=this._h[4],K=this._h[5],se=this._h[6],fe=this._h[7],ne=this._h[8],F=this._h[9],q=this._r[0],E=this._r[1],u=this._r[2],m=this._r[3],J=this._r[4],B=this._r[5],ie=this._r[6],ae=this._r[7],ge=this._r[8],O=this._r[9];w>=16;){var $=d[v+0]|d[v+1]<<8;N+=$&8191;var he=d[v+2]|d[v+3]<<8;L+=($>>>13|he<<3)&8191;var Z=d[v+4]|d[v+5]<<8;T+=(he>>>10|Z<<6)&8191;var k=d[v+6]|d[v+7]<<8;M+=(Z>>>7|k<<9)&8191;var X=d[v+8]|d[v+9]<<8;H+=(k>>>4|X<<12)&8191,K+=X>>>1&8191;var V=d[v+10]|d[v+11]<<8;se+=(X>>>14|V<<2)&8191;var ee=d[v+12]|d[v+13]<<8;fe+=(V>>>11|ee<<5)&8191;var Pe=d[v+14]|d[v+15]<<8;ne+=(ee>>>8|Pe<<8)&8191,F+=Pe>>>5|x;var te=0,we=te;we+=N*q,we+=L*(5*O),we+=T*(5*ge),we+=M*(5*ae),we+=H*(5*ie),te=we>>>13,we&=8191,we+=K*(5*B),we+=se*(5*J),we+=fe*(5*m),we+=ne*(5*u),we+=F*(5*E),te+=we>>>13,we&=8191;var ue=te;ue+=N*E,ue+=L*q,ue+=T*(5*O),ue+=M*(5*ge),ue+=H*(5*ae),te=ue>>>13,ue&=8191,ue+=K*(5*ie),ue+=se*(5*B),ue+=fe*(5*J),ue+=ne*(5*m),ue+=F*(5*u),te+=ue>>>13,ue&=8191;var _e=te;_e+=N*u,_e+=L*E,_e+=T*q,_e+=M*(5*O),_e+=H*(5*ge),te=_e>>>13,_e&=8191,_e+=K*(5*ae),_e+=se*(5*ie),_e+=fe*(5*B),_e+=ne*(5*J),_e+=F*(5*m),te+=_e>>>13,_e&=8191;var D=te;D+=N*m,D+=L*u,D+=T*E,D+=M*q,D+=H*(5*O),te=D>>>13,D&=8191,D+=K*(5*ge),D+=se*(5*ae),D+=fe*(5*ie),D+=ne*(5*B),D+=F*(5*J),te+=D>>>13,D&=8191;var U=te;U+=N*J,U+=L*m,U+=T*u,U+=M*E,U+=H*q,te=U>>>13,U&=8191,U+=K*(5*O),U+=se*(5*ge),U+=fe*(5*ae),U+=ne*(5*ie),U+=F*(5*B),te+=U>>>13,U&=8191;var P=te;P+=N*B,P+=L*J,P+=T*m,P+=M*u,P+=H*E,te=P>>>13,P&=8191,P+=K*q,P+=se*(5*O),P+=fe*(5*ge),P+=ne*(5*ae),P+=F*(5*ie),te+=P>>>13,P&=8191;var h=te;h+=N*ie,h+=L*B,h+=T*J,h+=M*m,h+=H*u,te=h>>>13,h&=8191,h+=K*E,h+=se*q,h+=fe*(5*O),h+=ne*(5*ge),h+=F*(5*ae),te+=h>>>13,h&=8191;var S=te;S+=N*ae,S+=L*ie,S+=T*B,S+=M*J,S+=H*m,te=S>>>13,S&=8191,S+=K*u,S+=se*E,S+=fe*q,S+=ne*(5*O),S+=F*(5*ge),te+=S>>>13,S&=8191;var re=te;re+=N*ge,re+=L*ae,re+=T*ie,re+=M*B,re+=H*J,te=re>>>13,re&=8191,re+=K*m,re+=se*u,re+=fe*E,re+=ne*q,re+=F*(5*O),te+=re>>>13,re&=8191;var le=te;le+=N*O,le+=L*ge,le+=T*ae,le+=M*ie,le+=H*B,te=le>>>13,le&=8191,le+=K*J,le+=se*m,le+=fe*u,le+=ne*E,le+=F*q,te+=le>>>13,le&=8191,te=(te<<2)+te|0,te=te+we|0,we=te&8191,te=te>>>13,ue+=te,N=we,L=ue,T=_e,M=D,H=U,K=P,se=h,fe=S,ne=re,F=le,v+=16,w-=16}this._h[0]=N,this._h[1]=L,this._h[2]=T,this._h[3]=M,this._h[4]=H,this._h[5]=K,this._h[6]=se,this._h[7]=fe,this._h[8]=ne,this._h[9]=F},p.prototype.finish=function(d,v){v===void 0&&(v=0);var w=new Uint16Array(10),x,N,L,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(x=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=x,x=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=x*5,x=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=x,x=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=x,w[0]=this._h[0]+5,x=w[0]>>>13,w[0]&=8191,T=1;T<10;T++)w[T]=this._h[T]+x,x=w[T]>>>13,w[T]&=8191;for(w[9]-=1<<13,N=(x^1)-1,T=0;T<10;T++)w[T]&=N;for(N=~N,T=0;T<10;T++)this._h[T]=this._h[T]&N|w[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,L=this._h[0]+this._pad[0],this._h[0]=L&65535,T=1;T<8;T++)L=(this._h[T]+this._pad[T]|0)+(L>>>16)|0,this._h[T]=L&65535;return d[v+0]=this._h[0]>>>0,d[v+1]=this._h[0]>>>8,d[v+2]=this._h[1]>>>0,d[v+3]=this._h[1]>>>8,d[v+4]=this._h[2]>>>0,d[v+5]=this._h[2]>>>8,d[v+6]=this._h[3]>>>0,d[v+7]=this._h[3]>>>8,d[v+8]=this._h[4]>>>0,d[v+9]=this._h[4]>>>8,d[v+10]=this._h[5]>>>0,d[v+11]=this._h[5]>>>8,d[v+12]=this._h[6]>>>0,d[v+13]=this._h[6]>>>8,d[v+14]=this._h[7]>>>0,d[v+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(d){var v=0,w=d.length,x;if(this._leftover){x=16-this._leftover,x>w&&(x=w);for(var N=0;N<x;N++)this._buffer[this._leftover+N]=d[v+N];if(w-=x,v+=x,this._leftover+=x,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(x=w-w%16,this._blocks(d,v,x),v+=x,w-=x),w){for(var N=0;N<w;N++)this._buffer[this._leftover+N]=d[v+N];this._leftover+=w}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,d){var v=new s(p);v.update(d);var w=v.digest();return v.clean(),w}n.oneTimeAuth=a;function l(p,d){return p.length!==n.DIGEST_LENGTH||d.length!==n.DIGEST_LENGTH?!1:t.equal(p,d)}n.equal=l})(Id);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Xo,r=Id,s=Ar,a=$e,l=Ui;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),d=function(){function v(w){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,w.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return v.prototype.seal=function(w,x,N,L){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(w,T.length-w.length);var M=new Uint8Array(32);t.stream(this._key,T,M,4);var H=x.length+this.tagLength,K;if(L){if(L.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");K=L}else K=new Uint8Array(H);return t.streamXOR(this._key,T,x,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),M,K.subarray(0,K.length-this.tagLength),N),s.wipe(T),K},v.prototype.open=function(w,x,N,L){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(x.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(w,T.length-w.length);var M=new Uint8Array(32);t.stream(this._key,T,M,4);var H=new Uint8Array(this.tagLength);if(this._authenticate(H,M,x.subarray(0,x.length-this.tagLength),N),!l.equal(H,x.subarray(x.length-this.tagLength,x.length)))return null;var K=x.length-this.tagLength,se;if(L){if(L.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");se=L}else se=new Uint8Array(K);return t.streamXOR(this._key,T,x.subarray(0,x.length-this.tagLength),se,4),s.wipe(T),se},v.prototype.clean=function(){return s.wipe(this._key),this},v.prototype._authenticate=function(w,x,N,L){var T=new r.Poly1305(x);L&&(T.update(L),L.length%16>0&&T.update(p.subarray(L.length%16))),T.update(N),N.length%16>0&&T.update(p.subarray(N.length%16));var M=new Uint8Array(8);L&&a.writeUint64LE(L.length,M),T.update(M),a.writeUint64LE(N.length,M),T.update(M);for(var H=T.digest(),K=0;K<H.length;K++)w[K]=H[K];T.clean(),s.wipe(H),s.wipe(M)},v}();n.ChaCha20Poly1305=d})(du);var Pd={},Is={},pu={};Object.defineProperty(pu,"__esModule",{value:!0});function Aw(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}pu.isSerializableHash=Aw;Object.defineProperty(Is,"__esModule",{value:!0});var ei=pu,Tw=Ui,Rw=Ar,Od=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),ei.isSerializableHash(this._inner)&&ei.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Rw.wipe(s)}return n.prototype.reset=function(){if(!ei.isSerializableHash(this._inner)||!ei.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){ei.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ei.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!ei.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!ei.isSerializableHash(this._inner)||!ei.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!ei.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();Is.HMAC=Od;function Nw(n,t,r){var s=new Od(n,t);s.update(r);var a=s.digest();return s.clean(),a}Is.hmac=Nw;Is.equal=Tw.equal;Object.defineProperty(Pd,"__esModule",{value:!0});var of=Is,af=Ar,Cw=function(){function n(t,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=a;var l=of.hmac(this._hash,s,r);this._hmac=new of.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),af.wipe(this._buffer),af.wipe(this._counter),this._bufpos=0},n}(),Lw=Pd.HKDF=Cw,Zo={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=$e,r=Ar;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function d(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},d.prototype.update=function(v,w){if(w===void 0&&(w=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var x=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=v[x++],w--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(x=l(this._temp,this._state,v,x,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=v[x++],w--;return this},d.prototype.finish=function(v){if(!this._finished){var w=this._bytesHashed,x=this._bufferLength,N=w/536870912|0,L=w<<3,T=w%64<56?64:128;this._buffer[x]=128;for(var M=x+1;M<T-8;M++)this._buffer[M]=0;t.writeUint32BE(N,this._buffer,T-8),t.writeUint32BE(L,this._buffer,T-4),l(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)t.writeUint32BE(this._state[M],v,M*4);return this},d.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(v){r.wipe(v.state),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},d}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(d,v,w,x,N){for(;N>=64;){for(var L=v[0],T=v[1],M=v[2],H=v[3],K=v[4],se=v[5],fe=v[6],ne=v[7],F=0;F<16;F++){var q=x+F*4;d[F]=t.readUint32BE(w,q)}for(var F=16;F<64;F++){var E=d[F-2],u=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=d[F-15];var m=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;d[F]=(u+d[F-7]|0)+(m+d[F-16]|0)}for(var F=0;F<64;F++){var u=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&se^~K&fe)|0)+(ne+(a[F]+d[F]|0)|0)|0,m=((L>>>2|L<<32-2)^(L>>>13|L<<32-13)^(L>>>22|L<<32-22))+(L&T^L&M^T&M)|0;ne=fe,fe=se,se=K,K=H+u|0,H=M,M=T,T=L,L=u+m|0}v[0]+=L,v[1]+=T,v[2]+=M,v[3]+=H,v[4]+=K,v[5]+=se,v[6]+=fe,v[7]+=ne,x+=64,N-=64}return x}function p(d){var v=new s;v.update(d);var w=v.digest();return v.clean(),w}n.hash=p})(Zo);var gu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=$n,r=Ar;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(F){const q=new Float64Array(16);if(F)for(let E=0;E<F.length;E++)q[E]=F[E];return q}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(F){let q=1;for(let E=0;E<16;E++){let u=F[E]+q+65535;q=Math.floor(u/65536),F[E]=u-q*65536}F[0]+=q-1+37*(q-1)}function d(F,q,E){const u=~(E-1);for(let m=0;m<16;m++){const J=u&(F[m]^q[m]);F[m]^=J,q[m]^=J}}function v(F,q){const E=s(),u=s();for(let m=0;m<16;m++)u[m]=q[m];p(u),p(u),p(u);for(let m=0;m<2;m++){E[0]=u[0]-65517;for(let B=1;B<15;B++)E[B]=u[B]-65535-(E[B-1]>>16&1),E[B-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const J=E[15]>>16&1;E[14]&=65535,d(u,E,1-J)}for(let m=0;m<16;m++)F[2*m]=u[m]&255,F[2*m+1]=u[m]>>8}function w(F,q){for(let E=0;E<16;E++)F[E]=q[2*E]+(q[2*E+1]<<8);F[15]&=32767}function x(F,q,E){for(let u=0;u<16;u++)F[u]=q[u]+E[u]}function N(F,q,E){for(let u=0;u<16;u++)F[u]=q[u]-E[u]}function L(F,q,E){let u,m,J=0,B=0,ie=0,ae=0,ge=0,O=0,$=0,he=0,Z=0,k=0,X=0,V=0,ee=0,Pe=0,te=0,we=0,ue=0,_e=0,D=0,U=0,P=0,h=0,S=0,re=0,le=0,Ie=0,He=0,ke=0,Me=0,pt=0,gt=0,je=E[0],xe=E[1],Le=E[2],Ue=E[3],qe=E[4],Ae=E[5],De=E[6],Se=E[7],Te=E[8],Ke=E[9],Oe=E[10],Ve=E[11],We=E[12],et=E[13],tt=E[14],Je=E[15];u=q[0],J+=u*je,B+=u*xe,ie+=u*Le,ae+=u*Ue,ge+=u*qe,O+=u*Ae,$+=u*De,he+=u*Se,Z+=u*Te,k+=u*Ke,X+=u*Oe,V+=u*Ve,ee+=u*We,Pe+=u*et,te+=u*tt,we+=u*Je,u=q[1],B+=u*je,ie+=u*xe,ae+=u*Le,ge+=u*Ue,O+=u*qe,$+=u*Ae,he+=u*De,Z+=u*Se,k+=u*Te,X+=u*Ke,V+=u*Oe,ee+=u*Ve,Pe+=u*We,te+=u*et,we+=u*tt,ue+=u*Je,u=q[2],ie+=u*je,ae+=u*xe,ge+=u*Le,O+=u*Ue,$+=u*qe,he+=u*Ae,Z+=u*De,k+=u*Se,X+=u*Te,V+=u*Ke,ee+=u*Oe,Pe+=u*Ve,te+=u*We,we+=u*et,ue+=u*tt,_e+=u*Je,u=q[3],ae+=u*je,ge+=u*xe,O+=u*Le,$+=u*Ue,he+=u*qe,Z+=u*Ae,k+=u*De,X+=u*Se,V+=u*Te,ee+=u*Ke,Pe+=u*Oe,te+=u*Ve,we+=u*We,ue+=u*et,_e+=u*tt,D+=u*Je,u=q[4],ge+=u*je,O+=u*xe,$+=u*Le,he+=u*Ue,Z+=u*qe,k+=u*Ae,X+=u*De,V+=u*Se,ee+=u*Te,Pe+=u*Ke,te+=u*Oe,we+=u*Ve,ue+=u*We,_e+=u*et,D+=u*tt,U+=u*Je,u=q[5],O+=u*je,$+=u*xe,he+=u*Le,Z+=u*Ue,k+=u*qe,X+=u*Ae,V+=u*De,ee+=u*Se,Pe+=u*Te,te+=u*Ke,we+=u*Oe,ue+=u*Ve,_e+=u*We,D+=u*et,U+=u*tt,P+=u*Je,u=q[6],$+=u*je,he+=u*xe,Z+=u*Le,k+=u*Ue,X+=u*qe,V+=u*Ae,ee+=u*De,Pe+=u*Se,te+=u*Te,we+=u*Ke,ue+=u*Oe,_e+=u*Ve,D+=u*We,U+=u*et,P+=u*tt,h+=u*Je,u=q[7],he+=u*je,Z+=u*xe,k+=u*Le,X+=u*Ue,V+=u*qe,ee+=u*Ae,Pe+=u*De,te+=u*Se,we+=u*Te,ue+=u*Ke,_e+=u*Oe,D+=u*Ve,U+=u*We,P+=u*et,h+=u*tt,S+=u*Je,u=q[8],Z+=u*je,k+=u*xe,X+=u*Le,V+=u*Ue,ee+=u*qe,Pe+=u*Ae,te+=u*De,we+=u*Se,ue+=u*Te,_e+=u*Ke,D+=u*Oe,U+=u*Ve,P+=u*We,h+=u*et,S+=u*tt,re+=u*Je,u=q[9],k+=u*je,X+=u*xe,V+=u*Le,ee+=u*Ue,Pe+=u*qe,te+=u*Ae,we+=u*De,ue+=u*Se,_e+=u*Te,D+=u*Ke,U+=u*Oe,P+=u*Ve,h+=u*We,S+=u*et,re+=u*tt,le+=u*Je,u=q[10],X+=u*je,V+=u*xe,ee+=u*Le,Pe+=u*Ue,te+=u*qe,we+=u*Ae,ue+=u*De,_e+=u*Se,D+=u*Te,U+=u*Ke,P+=u*Oe,h+=u*Ve,S+=u*We,re+=u*et,le+=u*tt,Ie+=u*Je,u=q[11],V+=u*je,ee+=u*xe,Pe+=u*Le,te+=u*Ue,we+=u*qe,ue+=u*Ae,_e+=u*De,D+=u*Se,U+=u*Te,P+=u*Ke,h+=u*Oe,S+=u*Ve,re+=u*We,le+=u*et,Ie+=u*tt,He+=u*Je,u=q[12],ee+=u*je,Pe+=u*xe,te+=u*Le,we+=u*Ue,ue+=u*qe,_e+=u*Ae,D+=u*De,U+=u*Se,P+=u*Te,h+=u*Ke,S+=u*Oe,re+=u*Ve,le+=u*We,Ie+=u*et,He+=u*tt,ke+=u*Je,u=q[13],Pe+=u*je,te+=u*xe,we+=u*Le,ue+=u*Ue,_e+=u*qe,D+=u*Ae,U+=u*De,P+=u*Se,h+=u*Te,S+=u*Ke,re+=u*Oe,le+=u*Ve,Ie+=u*We,He+=u*et,ke+=u*tt,Me+=u*Je,u=q[14],te+=u*je,we+=u*xe,ue+=u*Le,_e+=u*Ue,D+=u*qe,U+=u*Ae,P+=u*De,h+=u*Se,S+=u*Te,re+=u*Ke,le+=u*Oe,Ie+=u*Ve,He+=u*We,ke+=u*et,Me+=u*tt,pt+=u*Je,u=q[15],we+=u*je,ue+=u*xe,_e+=u*Le,D+=u*Ue,U+=u*qe,P+=u*Ae,h+=u*De,S+=u*Se,re+=u*Te,le+=u*Ke,Ie+=u*Oe,He+=u*Ve,ke+=u*We,Me+=u*et,pt+=u*tt,gt+=u*Je,J+=38*ue,B+=38*_e,ie+=38*D,ae+=38*U,ge+=38*P,O+=38*h,$+=38*S,he+=38*re,Z+=38*le,k+=38*Ie,X+=38*He,V+=38*ke,ee+=38*Me,Pe+=38*pt,te+=38*gt,m=1,u=J+m+65535,m=Math.floor(u/65536),J=u-m*65536,u=B+m+65535,m=Math.floor(u/65536),B=u-m*65536,u=ie+m+65535,m=Math.floor(u/65536),ie=u-m*65536,u=ae+m+65535,m=Math.floor(u/65536),ae=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=O+m+65535,m=Math.floor(u/65536),O=u-m*65536,u=$+m+65535,m=Math.floor(u/65536),$=u-m*65536,u=he+m+65535,m=Math.floor(u/65536),he=u-m*65536,u=Z+m+65535,m=Math.floor(u/65536),Z=u-m*65536,u=k+m+65535,m=Math.floor(u/65536),k=u-m*65536,u=X+m+65535,m=Math.floor(u/65536),X=u-m*65536,u=V+m+65535,m=Math.floor(u/65536),V=u-m*65536,u=ee+m+65535,m=Math.floor(u/65536),ee=u-m*65536,u=Pe+m+65535,m=Math.floor(u/65536),Pe=u-m*65536,u=te+m+65535,m=Math.floor(u/65536),te=u-m*65536,u=we+m+65535,m=Math.floor(u/65536),we=u-m*65536,J+=m-1+37*(m-1),m=1,u=J+m+65535,m=Math.floor(u/65536),J=u-m*65536,u=B+m+65535,m=Math.floor(u/65536),B=u-m*65536,u=ie+m+65535,m=Math.floor(u/65536),ie=u-m*65536,u=ae+m+65535,m=Math.floor(u/65536),ae=u-m*65536,u=ge+m+65535,m=Math.floor(u/65536),ge=u-m*65536,u=O+m+65535,m=Math.floor(u/65536),O=u-m*65536,u=$+m+65535,m=Math.floor(u/65536),$=u-m*65536,u=he+m+65535,m=Math.floor(u/65536),he=u-m*65536,u=Z+m+65535,m=Math.floor(u/65536),Z=u-m*65536,u=k+m+65535,m=Math.floor(u/65536),k=u-m*65536,u=X+m+65535,m=Math.floor(u/65536),X=u-m*65536,u=V+m+65535,m=Math.floor(u/65536),V=u-m*65536,u=ee+m+65535,m=Math.floor(u/65536),ee=u-m*65536,u=Pe+m+65535,m=Math.floor(u/65536),Pe=u-m*65536,u=te+m+65535,m=Math.floor(u/65536),te=u-m*65536,u=we+m+65535,m=Math.floor(u/65536),we=u-m*65536,J+=m-1+37*(m-1),F[0]=J,F[1]=B,F[2]=ie,F[3]=ae,F[4]=ge,F[5]=O,F[6]=$,F[7]=he,F[8]=Z,F[9]=k,F[10]=X,F[11]=V,F[12]=ee,F[13]=Pe,F[14]=te,F[15]=we}function T(F,q){L(F,q,q)}function M(F,q){const E=s();for(let u=0;u<16;u++)E[u]=q[u];for(let u=253;u>=0;u--)T(E,E),u!==2&&u!==4&&L(E,E,q);for(let u=0;u<16;u++)F[u]=E[u]}function H(F,q){const E=new Uint8Array(32),u=new Float64Array(80),m=s(),J=s(),B=s(),ie=s(),ae=s(),ge=s();for(let Z=0;Z<31;Z++)E[Z]=F[Z];E[31]=F[31]&127|64,E[0]&=248,w(u,q);for(let Z=0;Z<16;Z++)J[Z]=u[Z];m[0]=ie[0]=1;for(let Z=254;Z>=0;--Z){const k=E[Z>>>3]>>>(Z&7)&1;d(m,J,k),d(B,ie,k),x(ae,m,B),N(m,m,B),x(B,J,ie),N(J,J,ie),T(ie,ae),T(ge,m),L(m,B,m),L(B,J,ae),x(ae,m,B),N(m,m,B),T(J,m),N(B,ie,ge),L(m,B,l),x(m,m,ie),L(B,B,m),L(m,ie,ge),L(ie,J,u),T(J,ae),d(m,J,k),d(B,ie,k)}for(let Z=0;Z<16;Z++)u[Z+16]=m[Z],u[Z+32]=B[Z],u[Z+48]=J[Z],u[Z+64]=ie[Z];const O=u.subarray(32),$=u.subarray(16);M(O,O),L($,$,O);const he=new Uint8Array(32);return v(he,$),he}n.scalarMult=H;function K(F){return H(F,a)}n.scalarMultBase=K;function se(F){if(F.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const q=new Uint8Array(F);return{publicKey:K(q),secretKey:q}}n.generateKeyPairFromSeed=se;function fe(F){const q=(0,t.randomBytes)(32,F),E=se(q);return(0,r.wipe)(q),E}n.generateKeyPair=fe;function ne(F,q,E=!1){if(F.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(q.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=H(F,q);if(E){let m=0;for(let J=0;J<u.length;J++)m|=u[J];if(m===0)throw new Error("X25519: invalid shared key")}return u}n.sharedKey=ne})(gu);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Td=lt.getLocation=lt.getLocationOrThrow=vu=lt.getNavigator=lt.getNavigatorOrThrow=Ad=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function nn(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}lt.getFromWindow=nn;function Mn(n){const t=nn(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}lt.getFromWindowOrThrow=Mn;function Uw(){return Mn("document")}lt.getDocumentOrThrow=Uw;function Dw(){return nn("document")}var Ad=lt.getDocument=Dw;function $w(){return Mn("navigator")}lt.getNavigatorOrThrow=$w;function Mw(){return nn("navigator")}var vu=lt.getNavigator=Mw;function Fw(){return Mn("location")}lt.getLocationOrThrow=Fw;function jw(){return nn("location")}var Td=lt.getLocation=jw;function qw(){return Mn("crypto")}lt.getCryptoOrThrow=qw;function zw(){return nn("crypto")}lt.getCrypto=zw;function Hw(){return Mn("localStorage")}lt.getLocalStorageOrThrow=Hw;function Kw(){return nn("localStorage")}lt.getLocalStorage=Kw;var yu={};Object.defineProperty(yu,"__esModule",{value:!0});var Rd=yu.getWindowMetadata=void 0;const cf=lt;function Bw(){let n,t;try{n=cf.getDocumentOrThrow(),t=cf.getLocationOrThrow()}catch{return null}function r(){const N=n.getElementsByTagName("link"),L=[];for(let T=0;T<N.length;T++){const M=N[T],H=M.getAttribute("rel");if(H&&H.toLowerCase().indexOf("icon")>-1){const K=M.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let se=t.protocol+"//"+t.host;if(K.indexOf("/")===0)se+=K;else{const fe=t.pathname.split("/");fe.pop();const ne=fe.join("/");se+=ne+"/"+K}L.push(se)}else if(K.indexOf("//")===0){const se=t.protocol+K;L.push(se)}else L.push(K)}}return L}function s(...N){const L=n.getElementsByTagName("meta");for(let T=0;T<L.length;T++){const M=L[T],H=["itemprop","property","name"].map(K=>M.getAttribute(K)).filter(K=>K?N.includes(K):!1);if(H.length&&H){const K=M.getAttribute("content");if(K)return K}}return""}function a(){let N=s("name","og:site_name","og:title","twitter:title");return N||(N=n.title),N}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),d=l(),v=t.origin,w=r();return{description:d,url:v,icons:w,name:p}}Rd=yu.getWindowMetadata=Bw;const kw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Vw=":";function Gw(n){const[t,r]=n.split(Vw);return{namespace:t,reference:r}}function Ww(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Nd(n,t){return n.includes(":")?[n]:t.chains||[]}const Cd="base10",cr="base16",tu="base64pad",_u="utf8",Ld=0,sn=1,Yw=0,uf=1,ru=12,mu=32;function Jw(){const n=gu.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function iu(){const n=$n.randomBytes(mu);return ur(n,cr)}function Qw(n,t){const r=gu.sharedKey(mr(n,cr),mr(t,cr),!0),s=new Lw(Zo.SHA256,r).expand(mu);return ur(s,cr)}function Xw(n){const t=Zo.hash(mr(n,cr));return ur(t,cr)}function Cn(n){const t=Zo.hash(mr(n,_u));return ur(t,cr)}function Zw(n){return mr(`${n}`,Cd)}function xs(n){return Number(ur(n,Cd))}function eb(n){const t=Zw(typeof n.type<"u"?n.type:Ld);if(xs(t)===sn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?mr(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?mr(n.iv,cr):$n.randomBytes(ru),a=new du.ChaCha20Poly1305(mr(n.symKey,cr)).seal(s,mr(n.message,_u));return rb({type:t,sealed:a,iv:s,senderPublicKey:r})}function tb(n){const t=new du.ChaCha20Poly1305(mr(n.symKey,cr)),{sealed:r,iv:s}=ko(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return ur(a,_u)}function rb(n){if(xs(n.type)===sn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Yc([n.type,n.senderPublicKey,n.iv,n.sealed]),tu)}return ur(Yc([n.type,n.iv,n.sealed]),tu)}function ko(n){const t=mr(n,tu),r=t.slice(Yw,uf),s=uf;if(xs(r)===sn){const d=s+mu,v=d+ru,w=t.slice(s,d),x=t.slice(d,v),N=t.slice(v);return{type:r,sealed:N,iv:x,senderPublicKey:w}}const a=s+ru,l=t.slice(s,a),p=t.slice(a);return{type:r,sealed:p,iv:l}}function ib(n,t){const r=ko(n);return Ud({type:xs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Ud(n){const t=(n==null?void 0:n.type)||Ld;if(t===sn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function hf(n){return n.type===sn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var nb=Object.defineProperty,lf=Object.getOwnPropertySymbols,sb=Object.prototype.hasOwnProperty,ob=Object.prototype.propertyIsEnumerable,ff=(n,t,r)=>t in n?nb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,df=(n,t)=>{for(var r in t||(t={}))sb.call(t,r)&&ff(n,r,t[r]);if(lf)for(var r of lf(t))ob.call(t,r)&&ff(n,r,t[r]);return n};const ab="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},cb="js";function wu(){return typeof Nn.exports<"u"&&typeof Nn.exports.versions<"u"&&typeof Nn.exports.versions.node<"u"}function ea(){return!Ad()&&!!vu()&&navigator.product===ab}function Ps(){return!wu()&&!!vu()}function Os(){return ea()?Or.reactNative:wu()?Or.node:Ps()?Or.browser:Or.unknown}function ub(n,t){let r=zo.parse(n);return r=df(df({},r),t),n=zo.stringify(r),n}function hb(){return Rd()||{name:"",description:"",url:"",icons:[""]}}function lb(){if(Os()===Or.reactNative&&typeof bt<"u"&&typeof(bt==null?void 0:bt.Platform)<"u"){const{OS:r,Version:s}=bt.Platform;return[r,s].join("-")}const n=V_();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function fb(){var n;const t=Os();return t===Or.browser?[t,((n=Td())==null?void 0:n.host)||"unknown"].join(":"):t}function db(n,t,r){const s=lb(),a=fb();return[[n,t].join("-"),[cb,r].join("-"),s,a].join("/")}function pb({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p}){const d=r.split("?"),v=db(n,t,s),w={auth:a,ua:v,projectId:l,useOnCloseEvent:p||void 0},x=ub(d[1]||"",w);return d[0]+"?"+x}function tn(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Dd(n){return Object.fromEntries(n.entries())}function $d(n){return new Map(Object.entries(n))}function Rn(n=ye.FIVE_MINUTES,t){const r=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,d)=>{l=setTimeout(()=>{d(new Error(t))},r),s=p,a=d})}}function Es(n,t,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),t);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function Md(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function gb(n){return Md("topic",n)}function vb(n){return Md("id",n)}function Fd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Vr(n,t){return ye.fromMiliseconds((t||Date.now())+ye.toMiliseconds(n))}function Ci(n){return Date.now()>=ye.toMiliseconds(n)}function Ht(n,t){return`${n}${t?`:${t}`:""}`}function Fc(n=[],t=[]){return[...new Set([...n,...t])]}async function yb({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${n}&sessionTopic=${t}`,p=Os();p===Or.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):p===Or.reactNative&&typeof(bt==null?void 0:bt.Linking)<"u"&&await bt.Linking.openURL(l)}catch(s){console.error(s)}}const _b="irn";function nu(n){return(n==null?void 0:n.relay)||{protocol:_b}}function Fo(n){const t=kw[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var mb=Object.defineProperty,pf=Object.getOwnPropertySymbols,wb=Object.prototype.hasOwnProperty,bb=Object.prototype.propertyIsEnumerable,gf=(n,t,r)=>t in n?mb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Eb=(n,t)=>{for(var r in t||(t={}))wb.call(t,r)&&gf(n,r,t[r]);if(pf)for(var r of pf(t))bb.call(t,r)&&gf(n,r,t[r]);return n};function Sb(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function Ib(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=zo.parse(l);return{protocol:s,topic:xb(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:Sb(p)}}function xb(n){return n.startsWith("//")?n.substring(2):n}function Pb(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+t+a;n[a]&&(s[l]=n[a])}),s}function Ob(n){return`${n.protocol}:${n.topic}@${n.version}?`+zo.stringify(Eb({symKey:n.symKey},Pb(n.relay)))}function Fn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function Ab(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Fn(r.accounts))}),t}function Tb(n,t){const r=[];return Object.values(n).forEach(s=>{Fn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function Rb(n,t){const r=[];return Object.values(n).forEach(s=>{Fn(s.accounts).includes(t)&&r.push(...s.events)}),r}function Nb(n,t){const r=jo(n,t);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function bu(n){return n.includes(":")}function ys(n){return bu(n)?n.split(":")[0]:n}const Cb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Lb={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(n,t){const{message:r,code:s}=Lb[n];return{message:t?`${r} ${t}`:r,code:s}}function Lt(n,t){const{message:r,code:s}=Cb[n];return{message:t?`${r} ${t}`:r,code:s}}function ii(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Ln(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ar(n){return typeof n>"u"}function Gt(n,t){return t&&ar(n)?!0:typeof n=="string"&&!!n.trim().length}function Eu(n,t){return t&&ar(n)?!0:typeof n=="number"&&!isNaN(n)}function Ub(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return tn(a,s)?(s.forEach(p=>{const{accounts:d,methods:v,events:w}=n.namespaces[p],x=Fn(d),N=r[p];(!tn(Nd(p,N),x)||!tn(N.methods,v)||!tn(N.events,w))&&(l=!1)}),l):!1}function Vo(n){return Gt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Db(n){if(Gt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Vo(r)}}return!1}function $b(n){if(Gt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Mb(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function Fb(n){return n==null?void 0:n.topic}function jb(n,t){let r=null;return Gt(n==null?void 0:n.publicKey,!1)||(r=ce("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function vf(n){let t=!0;return ii(n)?n.length&&(t=n.every(r=>Gt(r,!1))):t=!1,t}function qb(n,t,r){let s=null;return ii(t)&&t.length?t.forEach(a=>{s||Vo(a)||(s=Lt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Vo(n)||(s=Lt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function zb(n,t,r){let s=null;return Object.entries(n).forEach(([a,l])=>{if(s)return;const p=qb(a,Nd(a,l),`${t} ${r}`);p&&(s=p)}),s}function Hb(n,t){let r=null;return ii(n)?n.forEach(s=>{r||Db(s)||(r=Lt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Lt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Kb(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Hb(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function Bb(n,t){let r=null;return vf(n==null?void 0:n.methods)?vf(n==null?void 0:n.events)||(r=Lt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Lt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function jd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Bb(s,`${t}, namespace`);a&&(r=a)}),r}function kb(n,t,r){let s=null;if(n&&Ln(n)){const a=jd(n,t);a&&(s=a);const l=zb(n,t,r);l&&(s=l)}else s=ce("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function jo(n,t){let r=null;if(n&&Ln(n)){const s=jd(n,t);s&&(r=s);const a=Kb(n,t);a&&(r=a)}else r=ce("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function qd(n){return Gt(n.protocol,!0)}function Vb(n,t){let r=!1;return t&&!n?r=!0:n&&ii(n)&&n.length&&n.forEach(s=>{r=qd(s)}),r}function Gb(n){return typeof n=="number"}function _r(n){return typeof n<"u"&&typeof n!==null}function Wb(n){return!(!n||typeof n!="object"||!n.code||!Eu(n.code,!1)||!n.message||!Gt(n.message,!1))}function Yb(n){return!(ar(n)||!Gt(n.method,!1))}function Jb(n){return!(ar(n)||ar(n.result)&&ar(n.error)||!Eu(n.id,!1)||!Gt(n.jsonrpc,!1))}function Qb(n){return!(ar(n)||!Gt(n.name,!1))}function yf(n,t){return!(!Vo(t)||!Ab(n).includes(t))}function Xb(n,t,r){return Gt(r,!1)?Tb(n,t).includes(r):!1}function Zb(n,t,r){return Gt(r,!1)?Rb(n,t).includes(r):!1}function _f(n,t,r){let s=null;const a=eE(n),l=tE(t),p=Object.keys(a),d=Object.keys(l),v=mf(Object.keys(n)),w=mf(Object.keys(t)),x=v.filter(N=>!w.includes(N));return x.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${x.toString()}
      Received: ${Object.keys(t).toString()}`)),tn(p,d)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${d.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const L=Fn(t[N].accounts);L.includes(N)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${L.toString()}`))}),p.forEach(N=>{s||(tn(a[N].methods,l[N].methods)?tn(a[N].events,l[N].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${N}`)):s=ce("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function eE(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function mf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function tE(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Fn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function rE(n,t){return Eu(n,!1)&&n<=t.max&&n>=t.min}function wf(){const n=Os();return new Promise(t=>{switch(n){case Or.browser:t(iE());break;case Or.reactNative:t(nE());break;case Or.node:t(sE());break;default:t(!0)}})}function iE(){return Ps()&&(navigator==null?void 0:navigator.onLine)}async function nE(){if(ea()&&typeof bt<"u"&&bt!=null&&bt.NetInfo){const n=await(bt==null?void 0:bt.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function sE(){return!0}function oE(n){switch(Os()){case Or.browser:aE(n);break;case Or.reactNative:cE(n);break}}function aE(n){Ps()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function cE(n){var t;ea()&&typeof bt<"u"&&bt!=null&&bt.NetInfo&&((t=bt)==null||t.NetInfo.addEventListener(r=>n(r==null?void 0:r.isConnected)))}const jc={};class Uo{static get(t){return jc[t]}static set(t,r){jc[t]=r}static delete(t){delete jc[t]}}const uE="PARSE_ERROR",hE="INVALID_REQUEST",lE="METHOD_NOT_FOUND",fE="INVALID_PARAMS",zd="INTERNAL_ERROR",Su="SERVER_ERROR",dE=[-32700,-32600,-32601,-32602,-32603],ws={[uE]:{code:-32700,message:"Parse error"},[hE]:{code:-32600,message:"Invalid Request"},[lE]:{code:-32601,message:"Method not found"},[fE]:{code:-32602,message:"Invalid params"},[zd]:{code:-32603,message:"Internal error"},[Su]:{code:-32e3,message:"Server error"}},Hd=Su;function pE(n){return dE.includes(n)}function bf(n){return Object.keys(ws).includes(n)?ws[n]:ws[Hd]}function gE(n){const t=Object.values(ws).find(r=>r.code===n);return t||ws[Hd]}function Kd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Bd={},vi={},Ef;function vE(){if(Ef)return vi;Ef=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function n(){return(Pr===null||Pr===void 0?void 0:Pr.crypto)||(Pr===null||Pr===void 0?void 0:Pr.msCrypto)||{}}vi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return vi.isBrowserCryptoAvailable=r,vi}var yi={},Sf;function yE(){if(Sf)return yi;Sf=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.isBrowser=yi.isNode=yi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}yi.isReactNative=n;function t(){return typeof Nn.exports<"u"&&typeof Nn.exports.versions<"u"&&typeof Nn.exports.versions.node<"u"}yi.isNode=t;function r(){return!n()&&!t()}return yi.isBrowser=r,yi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr.exports;t.__exportStar(vE(),n),t.__exportStar(yE(),n)})(Bd);function Iu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function kd(n=6){return BigInt(Iu(n))}function Un(n,t,r){return{id:r||Iu(),jsonrpc:"2.0",method:n,params:t}}function xu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function ta(n,t,r){return{id:n,jsonrpc:"2.0",error:_E(t,r)}}function _E(n,t){return typeof n>"u"?bf(zd):(typeof n=="string"&&(n=Object.assign(Object.assign({},bf(Su)),{message:n})),typeof t<"u"&&(n.data=t),pE(n.code)&&(n=gE(n.code)),n)}class mE{}class wE extends mE{constructor(){super()}}class bE extends wE{constructor(t){super()}}const EE="^https?:",SE="^wss?:";function IE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Vd(n,t){const r=IE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function If(n){return Vd(n,EE)}function xf(n){return Vd(n,SE)}function xE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Gd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Pu(n){return Gd(n)&&"method"in n}function ra(n){return Gd(n)&&(wi(n)||Gr(n))}function wi(n){return"result"in n}function Gr(n){return"error"in n}class Di extends bE{constructor(t){super(t),this.events=new hr.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Un(t.method,t.params||[],t.id||kd().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(l){a(l)}this.events.on(`${t.id}`,l=>{Gr(l)?a(l.error):s(l.result)});try{await this.connection.send(t,r)}catch(l){a(l)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),ra(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const PE=()=>typeof WebSocket<"u"?WebSocket:typeof bt<"u"&&typeof bt.WebSocket<"u"?bt.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),OE=()=>typeof WebSocket<"u"||typeof bt<"u"&&typeof bt.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Pf=n=>n.split("?")[0],Of=10,AE=PE();class TE{constructor(t){if(this.url=t,this.events=new hr.exports.EventEmitter,this.registering=!1,!xf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(bs(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!xf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=Bd.isReactNative()?void 0:{rejectUnauthorized:!xE(t)},l=new AE(t,[],a);OE()?l.onerror=p=>{const d=p;s(this.emitError(d.error))}:l.on("error",p=>{s(this.emitError(p))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?lu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=ta(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return Kd(t,Pf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Of&&this.events.setMaxListeners(Of)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Pf(this.url)}`));return this.events.emit("register_error",r),r}}var su={exports:{}};(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,l=2,p=9007199254740991,d="[object Arguments]",v="[object Array]",w="[object AsyncFunction]",x="[object Boolean]",N="[object Date]",L="[object Error]",T="[object Function]",M="[object GeneratorFunction]",H="[object Map]",K="[object Number]",se="[object Null]",fe="[object Object]",ne="[object Promise]",F="[object Proxy]",q="[object RegExp]",E="[object Set]",u="[object String]",m="[object Symbol]",J="[object Undefined]",B="[object WeakMap]",ie="[object ArrayBuffer]",ae="[object DataView]",ge="[object Float32Array]",O="[object Float64Array]",$="[object Int8Array]",he="[object Int16Array]",Z="[object Int32Array]",k="[object Uint8Array]",X="[object Uint8ClampedArray]",V="[object Uint16Array]",ee="[object Uint32Array]",Pe=/[\\^$.*+?()[\]{}|]/g,te=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,ue={};ue[ge]=ue[O]=ue[$]=ue[he]=ue[Z]=ue[k]=ue[X]=ue[V]=ue[ee]=!0,ue[d]=ue[v]=ue[ie]=ue[x]=ue[ae]=ue[N]=ue[L]=ue[T]=ue[H]=ue[K]=ue[fe]=ue[q]=ue[E]=ue[u]=ue[B]=!1;var _e=typeof Pr=="object"&&Pr&&Pr.Object===Object&&Pr,D=typeof self=="object"&&self&&self.Object===Object&&self,U=_e||D||Function("return this")(),P=t&&!t.nodeType&&t,h=P&&!0&&n&&!n.nodeType&&n,S=h&&h.exports===P,re=S&&_e.process,le=function(){try{return re&&re.binding&&re.binding("util")}catch{}}(),Ie=le&&le.isTypedArray;function He(_,A){for(var Y=-1,de=_==null?0:_.length,at=0,Ne=[];++Y<de;){var ft=_[Y];A(ft,Y,_)&&(Ne[at++]=ft)}return Ne}function ke(_,A){for(var Y=-1,de=A.length,at=_.length;++Y<de;)_[at+Y]=A[Y];return _}function Me(_,A){for(var Y=-1,de=_==null?0:_.length;++Y<de;)if(A(_[Y],Y,_))return!0;return!1}function pt(_,A){for(var Y=-1,de=Array(_);++Y<_;)de[Y]=A(Y);return de}function gt(_){return function(A){return _(A)}}function je(_,A){return _.has(A)}function xe(_,A){return _==null?void 0:_[A]}function Le(_){var A=-1,Y=Array(_.size);return _.forEach(function(de,at){Y[++A]=[at,de]}),Y}function Ue(_,A){return function(Y){return _(A(Y))}}function qe(_){var A=-1,Y=Array(_.size);return _.forEach(function(de){Y[++A]=de}),Y}var Ae=Array.prototype,De=Function.prototype,Se=Object.prototype,Te=U["__core-js_shared__"],Ke=De.toString,Oe=Se.hasOwnProperty,Ve=function(){var _=/[^.]+$/.exec(Te&&Te.keys&&Te.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),We=Se.toString,et=RegExp("^"+Ke.call(Oe).replace(Pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=S?U.Buffer:void 0,Je=U.Symbol,er=U.Uint8Array,lr=Se.propertyIsEnumerable,Wr=Ae.splice,tr=Je?Je.toStringTag:void 0,ni=Object.getOwnPropertySymbols,bi=tt?tt.isBuffer:void 0,Mi=Ue(Object.keys,Object),Et=wr(U,"DataView"),vt=wr(U,"Map"),St=wr(U,"Promise"),It=wr(U,"Set"),mt=wr(U,"WeakMap"),yt=wr(Object,"create"),Dt=oi(Et),$t=oi(vt),xt=oi(St),Mt=oi(It),Pt=oi(mt),Tt=Je?Je.prototype:void 0,Ot=Tt?Tt.valueOf:void 0;function ht(_){var A=-1,Y=_==null?0:_.length;for(this.clear();++A<Y;){var de=_[A];this.set(de[0],de[1])}}function Ft(){this.__data__=yt?yt(null):{},this.size=0}function jt(_){var A=this.has(_)&&delete this.__data__[_];return this.size-=A?1:0,A}function sa(_){var A=this.__data__;if(yt){var Y=A[_];return Y===s?void 0:Y}return Oe.call(A,_)?A[_]:void 0}function oa(_){var A=this.__data__;return yt?A[_]!==void 0:Oe.call(A,_)}function aa(_,A){var Y=this.__data__;return this.size+=this.has(_)?0:1,Y[_]=yt&&A===void 0?s:A,this}ht.prototype.clear=Ft,ht.prototype.delete=jt,ht.prototype.get=sa,ht.prototype.has=oa,ht.prototype.set=aa;function Tr(_){var A=-1,Y=_==null?0:_.length;for(this.clear();++A<Y;){var de=_[A];this.set(de[0],de[1])}}function ca(){this.__data__=[],this.size=0}function ua(_){var A=this.__data__,Y=Fi(A,_);if(Y<0)return!1;var de=A.length-1;return Y==de?A.pop():Wr.call(A,Y,1),--this.size,!0}function ha(_){var A=this.__data__,Y=Fi(A,_);return Y<0?void 0:A[Y][1]}function la(_){return Fi(this.__data__,_)>-1}function fa(_,A){var Y=this.__data__,de=Fi(Y,_);return de<0?(++this.size,Y.push([_,A])):Y[de][1]=A,this}Tr.prototype.clear=ca,Tr.prototype.delete=ua,Tr.prototype.get=ha,Tr.prototype.has=la,Tr.prototype.set=fa;function si(_){var A=-1,Y=_==null?0:_.length;for(this.clear();++A<Y;){var de=_[A];this.set(de[0],de[1])}}function cn(){this.size=0,this.__data__={hash:new ht,map:new(vt||Tr),string:new ht}}function da(_){var A=Ei(this,_).delete(_);return this.size-=A?1:0,A}function un(_){return Ei(this,_).get(_)}function pa(_){return Ei(this,_).has(_)}function ga(_,A){var Y=Ei(this,_),de=Y.size;return Y.set(_,A),this.size+=Y.size==de?0:1,this}si.prototype.clear=cn,si.prototype.delete=da,si.prototype.get=un,si.prototype.has=pa,si.prototype.set=ga;function hn(_){var A=-1,Y=_==null?0:_.length;for(this.__data__=new si;++A<Y;)this.add(_[A])}function Ts(_){return this.__data__.set(_,s),this}function Rs(_){return this.__data__.has(_)}hn.prototype.add=hn.prototype.push=Ts,hn.prototype.has=Rs;function qr(_){var A=this.__data__=new Tr(_);this.size=A.size}function va(){this.__data__=new Tr,this.size=0}function ya(_){var A=this.__data__,Y=A.delete(_);return this.size=A.size,Y}function _a(_){return this.__data__.get(_)}function ma(_){return this.__data__.has(_)}function Ns(_,A){var Y=this.__data__;if(Y instanceof Tr){var de=Y.__data__;if(!vt||de.length<r-1)return de.push([_,A]),this.size=++Y.size,this;Y=this.__data__=new si(de)}return Y.set(_,A),this.size=Y.size,this}qr.prototype.clear=va,qr.prototype.delete=ya,qr.prototype.get=_a,qr.prototype.has=ma,qr.prototype.set=Ns;function Cs(_,A){var Y=dn(_),de=!Y&&Bs(_),at=!Y&&!de&&Hn(_),Ne=!Y&&!de&&!at&&Gs(_),ft=Y||de||at||Ne,qt=ft?pt(_.length,String):[],Qe=qt.length;for(var ct in _)(A||Oe.call(_,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Ne&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||js(ct,Qe)))&&qt.push(ct);return qt}function Fi(_,A){for(var Y=_.length;Y--;)if(Ks(_[Y][0],A))return Y;return-1}function qn(_,A,Y){var de=A(_);return dn(_)?de:ke(de,Y(_))}function ji(_){return _==null?_===void 0?J:se:tr&&tr in Object(_)?Ms(_):Ea(_)}function zn(_){return zi(_)&&ji(_)==d}function qi(_,A,Y,de,at){return _===A?!0:_==null||A==null||!zi(_)&&!zi(A)?_!==_&&A!==A:Ls(_,A,Y,de,qi,at)}function Ls(_,A,Y,de,at,Ne){var ft=dn(_),qt=dn(A),Qe=ft?v:Yr(_),ct=qt?v:Yr(A);Qe=Qe==d?fe:Qe,ct=ct==d?fe:ct;var Rt=Qe==fe,fr=ct==fe,zt=Qe==ct;if(zt&&Hn(_)){if(!Hn(A))return!1;ft=!0,Rt=!1}if(zt&&!Rt)return Ne||(Ne=new qr),ft||Gs(_)?ln(_,A,Y,de,at,Ne):ba(_,A,Qe,Y,de,at,Ne);if(!(Y&a)){var dt=Rt&&Oe.call(_,"__wrapped__"),rr=fr&&Oe.call(A,"__wrapped__");if(dt||rr){var zr=dt?_.value():_,Rr=rr?A.value():A;return Ne||(Ne=new qr),at(zr,Rr,Y,de,Ne)}}return zt?(Ne||(Ne=new qr),$s(_,A,Y,de,at,Ne)):!1}function wa(_){if(!Vs(_)||zs(_))return!1;var A=pn(_)?et:te;return A.test(oi(_))}function Us(_){return zi(_)&&ks(_.length)&&!!ue[ji(_)]}function Ds(_){if(!Hs(_))return Mi(_);var A=[];for(var Y in Object(_))Oe.call(_,Y)&&Y!="constructor"&&A.push(Y);return A}function ln(_,A,Y,de,at,Ne){var ft=Y&a,qt=_.length,Qe=A.length;if(qt!=Qe&&!(ft&&Qe>qt))return!1;var ct=Ne.get(_);if(ct&&Ne.get(A))return ct==A;var Rt=-1,fr=!0,zt=Y&l?new hn:void 0;for(Ne.set(_,A),Ne.set(A,_);++Rt<qt;){var dt=_[Rt],rr=A[Rt];if(de)var zr=ft?de(rr,dt,Rt,A,_,Ne):de(dt,rr,Rt,_,A,Ne);if(zr!==void 0){if(zr)continue;fr=!1;break}if(zt){if(!Me(A,function(Rr,Jr){if(!je(zt,Jr)&&(dt===Rr||at(dt,Rr,Y,de,Ne)))return zt.push(Jr)})){fr=!1;break}}else if(!(dt===rr||at(dt,rr,Y,de,Ne))){fr=!1;break}}return Ne.delete(_),Ne.delete(A),fr}function ba(_,A,Y,de,at,Ne,ft){switch(Y){case ae:if(_.byteLength!=A.byteLength||_.byteOffset!=A.byteOffset)return!1;_=_.buffer,A=A.buffer;case ie:return!(_.byteLength!=A.byteLength||!Ne(new er(_),new er(A)));case x:case N:case K:return Ks(+_,+A);case L:return _.name==A.name&&_.message==A.message;case q:case u:return _==A+"";case H:var qt=Le;case E:var Qe=de&a;if(qt||(qt=qe),_.size!=A.size&&!Qe)return!1;var ct=ft.get(_);if(ct)return ct==A;de|=l,ft.set(_,A);var Rt=ln(qt(_),qt(A),de,at,Ne,ft);return ft.delete(_),Rt;case m:if(Ot)return Ot.call(_)==Ot.call(A)}return!1}function $s(_,A,Y,de,at,Ne){var ft=Y&a,qt=fn(_),Qe=qt.length,ct=fn(A),Rt=ct.length;if(Qe!=Rt&&!ft)return!1;for(var fr=Qe;fr--;){var zt=qt[fr];if(!(ft?zt in A:Oe.call(A,zt)))return!1}var dt=Ne.get(_);if(dt&&Ne.get(A))return dt==A;var rr=!0;Ne.set(_,A),Ne.set(A,_);for(var zr=ft;++fr<Qe;){zt=qt[fr];var Rr=_[zt],Jr=A[zt];if(de)var Kn=ft?de(Jr,Rr,zt,A,_,Ne):de(Rr,Jr,zt,_,A,Ne);if(!(Kn===void 0?Rr===Jr||at(Rr,Jr,Y,de,Ne):Kn)){rr=!1;break}zr||(zr=zt=="constructor")}if(rr&&!zr){var Hi=_.constructor,kt=A.constructor;Hi!=kt&&"constructor"in _&&"constructor"in A&&!(typeof Hi=="function"&&Hi instanceof Hi&&typeof kt=="function"&&kt instanceof kt)&&(rr=!1)}return Ne.delete(_),Ne.delete(A),rr}function fn(_){return qn(_,xa,Fs)}function Ei(_,A){var Y=_.__data__;return qs(A)?Y[typeof A=="string"?"string":"hash"]:Y.map}function wr(_,A){var Y=xe(_,A);return wa(Y)?Y:void 0}function Ms(_){var A=Oe.call(_,tr),Y=_[tr];try{_[tr]=void 0;var de=!0}catch{}var at=We.call(_);return de&&(A?_[tr]=Y:delete _[tr]),at}var Fs=ni?function(_){return _==null?[]:(_=Object(_),He(ni(_),function(A){return lr.call(_,A)}))}:ot,Yr=ji;(Et&&Yr(new Et(new ArrayBuffer(1)))!=ae||vt&&Yr(new vt)!=H||St&&Yr(St.resolve())!=ne||It&&Yr(new It)!=E||mt&&Yr(new mt)!=B)&&(Yr=function(_){var A=ji(_),Y=A==fe?_.constructor:void 0,de=Y?oi(Y):"";if(de)switch(de){case Dt:return ae;case $t:return H;case xt:return ne;case Mt:return E;case Pt:return B}return A});function js(_,A){return A=A==null?p:A,!!A&&(typeof _=="number"||we.test(_))&&_>-1&&_%1==0&&_<A}function qs(_){var A=typeof _;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?_!=="__proto__":_===null}function zs(_){return!!Ve&&Ve in _}function Hs(_){var A=_&&_.constructor,Y=typeof A=="function"&&A.prototype||Se;return _===Y}function Ea(_){return We.call(_)}function oi(_){if(_!=null){try{return Ke.call(_)}catch{}try{return _+""}catch{}}return""}function Ks(_,A){return _===A||_!==_&&A!==A}var Bs=zn(function(){return arguments}())?zn:function(_){return zi(_)&&Oe.call(_,"callee")&&!lr.call(_,"callee")},dn=Array.isArray;function Sa(_){return _!=null&&ks(_.length)&&!pn(_)}var Hn=bi||st;function Ia(_,A){return qi(_,A)}function pn(_){if(!Vs(_))return!1;var A=ji(_);return A==T||A==M||A==w||A==F}function ks(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=p}function Vs(_){var A=typeof _;return _!=null&&(A=="object"||A=="function")}function zi(_){return _!=null&&typeof _=="object"}var Gs=Ie?gt(Ie):Us;function xa(_){return Sa(_)?Cs(_):Ds(_)}function ot(){return[]}function st(){return!1}n.exports=Ia})(su,su.exports);const RE=su.exports;function NE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var d=n.length,v=n.charAt(0),w=Math.log(d)/Math.log(256),x=Math.log(256)/Math.log(d);function N(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var H=0,K=0,se=0,fe=M.length;se!==fe&&M[se]===0;)se++,H++;for(var ne=(fe-se)*x+1>>>0,F=new Uint8Array(ne);se!==fe;){for(var q=M[se],E=0,u=ne-1;(q!==0||E<K)&&u!==-1;u--,E++)q+=256*F[u]>>>0,F[u]=q%d>>>0,q=q/d>>>0;if(q!==0)throw new Error("Non-zero carry");K=E,se++}for(var m=ne-K;m!==ne&&F[m]===0;)m++;for(var J=v.repeat(H);m<ne;++m)J+=n.charAt(F[m]);return J}function L(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var H=0;if(M[H]!==" "){for(var K=0,se=0;M[H]===v;)K++,H++;for(var fe=(M.length-H)*w+1>>>0,ne=new Uint8Array(fe);M[H];){var F=r[M.charCodeAt(H)];if(F===255)return;for(var q=0,E=fe-1;(F!==0||q<se)&&E!==-1;E--,q++)F+=d*ne[E]>>>0,ne[E]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");se=q,H++}if(M[H]!==" "){for(var u=fe-se;u!==fe&&ne[u]===0;)u++;for(var m=new Uint8Array(K+(fe-u)),J=K;u!==fe;)m[J++]=ne[u++];return m}}}function T(M){var H=L(M);if(H)return H;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:L,decode:T}}var CE=NE,LE=CE;const Wd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},UE=n=>new TextEncoder().encode(n),DE=n=>new TextDecoder().decode(n);class $E{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ME{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Yd(this,t)}}class FE{constructor(t){this.decoders=t}or(t){return Yd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Yd=(n,t)=>new FE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class jE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new $E(t,r,s),this.decoder=new ME(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ia=({name:n,prefix:t,encode:r,decode:s})=>new jE(n,t,r,s),As=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=LE(r,t);return ia({prefix:n,name:t,encode:s,decode:l=>Wd(a(l))})},qE=(n,t,r,s)=>{const a={};for(let x=0;x<t.length;++x)a[t[x]]=x;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let d=0,v=0,w=0;for(let x=0;x<l;++x){const N=a[n[x]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|N,d+=r,d>=8&&(d-=8,p[w++]=255&v>>d)}if(d>=r||255&v<<8-d)throw new SyntaxError("Unexpected end of data");return p},zE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,d=0;for(let v=0;v<n.length;++v)for(d=d<<8|n[v],p+=8;p>r;)p-=r,l+=t[a&d>>p];if(p&&(l+=t[a&d<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Yt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>ia({prefix:t,name:n,encode(a){return zE(a,s,r)},decode(a){return qE(a,s,r,n)}}),HE=ia({prefix:"\0",name:"identity",encode:n=>DE(n),decode:n=>UE(n)});var KE=Object.freeze({__proto__:null,identity:HE});const BE=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var kE=Object.freeze({__proto__:null,base2:BE});const VE=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var GE=Object.freeze({__proto__:null,base8:VE});const WE=As({prefix:"9",name:"base10",alphabet:"0123456789"});var YE=Object.freeze({__proto__:null,base10:WE});const JE=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QE=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var XE=Object.freeze({__proto__:null,base16:JE,base16upper:QE});const ZE=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),e6=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),t6=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),r6=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i6=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),n6=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),s6=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),o6=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),a6=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var c6=Object.freeze({__proto__:null,base32:ZE,base32upper:e6,base32pad:t6,base32padupper:r6,base32hex:i6,base32hexupper:n6,base32hexpad:s6,base32hexpadupper:o6,base32z:a6});const u6=As({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),h6=As({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var l6=Object.freeze({__proto__:null,base36:u6,base36upper:h6});const f6=As({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),d6=As({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var p6=Object.freeze({__proto__:null,base58btc:f6,base58flickr:d6});const g6=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),v6=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),y6=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_6=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var m6=Object.freeze({__proto__:null,base64:g6,base64pad:v6,base64url:y6,base64urlpad:_6});const Jd=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),w6=Jd.reduce((n,t,r)=>(n[r]=t,n),[]),b6=Jd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function E6(n){return n.reduce((t,r)=>(t+=w6[r],t),"")}function S6(n){const t=[];for(const r of n){const s=b6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const I6=ia({prefix:"\u{1F680}",name:"base256emoji",encode:E6,decode:S6});var x6=Object.freeze({__proto__:null,base256emoji:I6}),P6=Qd,Af=128,O6=127,A6=~O6,T6=Math.pow(2,31);function Qd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=T6;)t[r++]=n&255|Af,n/=128;for(;n&A6;)t[r++]=n&255|Af,n>>>=7;return t[r]=n|0,Qd.bytes=r-s+1,t}var R6=ou,N6=128,Tf=127;function ou(n,s){var r=0,s=s||0,a=0,l=s,p,d=n.length;do{if(l>=d)throw ou.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Tf)<<a:(p&Tf)*Math.pow(2,a),a+=7}while(p>=N6);return ou.bytes=l-s,r}var C6=Math.pow(2,7),L6=Math.pow(2,14),U6=Math.pow(2,21),D6=Math.pow(2,28),$6=Math.pow(2,35),M6=Math.pow(2,42),F6=Math.pow(2,49),j6=Math.pow(2,56),q6=Math.pow(2,63),z6=function(n){return n<C6?1:n<L6?2:n<U6?3:n<D6?4:n<$6?5:n<M6?6:n<F6?7:n<j6?8:n<q6?9:10},H6={encode:P6,decode:R6,encodingLength:z6},Xd=H6;const Rf=(n,t,r=0)=>(Xd.encode(n,t,r),t),Nf=n=>Xd.encodingLength(n),au=(n,t)=>{const r=t.byteLength,s=Nf(n),a=s+Nf(r),l=new Uint8Array(a+r);return Rf(n,l,0),Rf(r,l,s),l.set(t,a),new K6(n,r,t,l)};class K6{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Zd=({name:n,code:t,encode:r})=>new B6(n,t,r);class B6{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?au(this.code,r):r.then(s=>au(this.code,s))}else throw Error("Unknown type, must be binary type")}}const ep=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),k6=Zd({name:"sha2-256",code:18,encode:ep("SHA-256")}),V6=Zd({name:"sha2-512",code:19,encode:ep("SHA-512")});var G6=Object.freeze({__proto__:null,sha256:k6,sha512:V6});const tp=0,W6="identity",rp=Wd,Y6=n=>au(tp,rp(n)),J6={code:tp,name:W6,encode:rp,digest:Y6};var Q6=Object.freeze({__proto__:null,identity:J6});new TextEncoder,new TextDecoder;const Cf={...KE,...kE,...GE,...YE,...XE,...c6,...l6,...p6,...m6,...x6};({...G6,...Q6});function ip(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function X6(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ip(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function np(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Lf=np("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),qc=np("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=X6(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Z6={utf8:Lf,"utf-8":Lf,hex:Cf.base16,latin1:qc,ascii:qc,binary:qc,...Cf};function e2(n,t="utf8"){const r=Z6[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ip(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const sp="wc",t2=2,Ou="core",Li=`${sp}@2:${Ou}:`,r2={name:Ou,logger:"error"},i2={database:":memory:"},n2="crypto",Uf="client_ed25519_seed",s2=ye.ONE_DAY,o2="keychain",a2="0.3",c2="messages",u2="0.3",h2=ye.SIX_HOURS,l2="publisher",op="irn",f2="error",ap="wss://relay.walletconnect.com",Df="wss://relay.walletconnect.org",d2="relayer",Zt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},p2="_subscription",_i={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},g2=ye.ONE_SECOND,v2="2.10.1",y2=1e4,_2="0.3",m2="WALLETCONNECT_CLIENT_ID",ri={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},w2="subscription",b2="0.3",E2=ye.FIVE_SECONDS*1e3,S2="pairing",I2="0.3",fs={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},_s={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ti={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},x2="history",P2="0.3",O2="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},A2="0.3",zc="verify-api",qo="https://verify.walletconnect.com",$f="https://verify.walletconnect.org";class T2{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=o2,this.version=a2,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Dd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$d(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class R2{constructor(t,r,s){this.core=t,this.logger=r,this.name=n2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=sf(a);return Ed(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Jw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=sf(l),d=iu();return await ww(d,a,s2,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const d=this.getPrivateKey(a),v=Qw(d,l);return this.setSymKey(v,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||Xw(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const d=Ud(p),v=bs(l);if(hf(d)){const L=d.senderPublicKey,T=d.receiverPublicKey;a=await this.generateSharedKey(L,T)}const w=this.getSymKey(a),{type:x,senderPublicKey:N}=d;return eb({type:x,symKey:w,message:v,senderPublicKey:N})},this.decode=async(a,l,p)=>{this.isInitialized();const d=ib(l,p);if(hf(d)){const v=d.receiverPublicKey,w=d.senderPublicKey;a=await this.generateSharedKey(v,w)}try{const v=this.getSymKey(a),w=tb({symKey:v,encoded:l});return lu(w)}catch(v){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=a=>{const l=ko(a);return xs(l.type)},this.getPayloadSenderPublicKey=a=>{const l=ko(a);return l.senderPublicKey?ur(l.senderPublicKey,cr):void 0},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new T2(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Uf)}catch{t=iu(),await this.keychain.set(Uf,t)}return e2(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class N2 extends Sm{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=c2,this.version=u2,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=Cn(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=Cn(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(t,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Dd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$d(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class C2 extends Im{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new hr.exports.EventEmitter,this.name=l2,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const d=(l==null?void 0:l.ttl)||h2,v=nu(l),w=(l==null?void 0:l.prompt)||!1,x=(l==null?void 0:l.tag)||0,N=(l==null?void 0:l.id)||kd().toString(),L={topic:s,message:a,opts:{ttl:d,relay:v,prompt:w,tag:x,id:N}},T=setTimeout(()=>this.queue.set(N,L),this.publishTimeout);try{await await Es(this.rpcPublish(s,a,d,v,w,x,N),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(N),this.relayer.events.emit(Zt.publish,L)}catch(M){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=l==null?void 0:l.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(N),M;return}finally{clearTimeout(T)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,l,p,d){var v,w,x,N;const L={method:Fo(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:p},id:d};return ar((v=L.params)==null?void 0:v.prompt)&&((w=L.params)==null||delete w.prompt),ar((x=L.params)==null?void 0:x.tag)&&((N=L.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:L}),this.relayer.request(L)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Zt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Zt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class L2{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var U2=Object.defineProperty,D2=Object.defineProperties,$2=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,M2=Object.prototype.hasOwnProperty,F2=Object.prototype.propertyIsEnumerable,Ff=(n,t,r)=>t in n?U2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ds=(n,t)=>{for(var r in t||(t={}))M2.call(t,r)&&Ff(n,r,t[r]);if(Mf)for(var r of Mf(t))F2.call(t,r)&&Ff(n,r,t[r]);return n},Hc=(n,t)=>D2(n,$2(t));class j2 extends Om{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new L2,this.events=new hr.exports.EventEmitter,this.name=w2,this.version=b2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=nu(a),p={topic:s,relay:l};this.pending.set(s,p);const d=await this.rpcSubscribe(s,l);return this.onSubscribe(d,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),d}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new ye.Watch;p.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=E2&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=nu(s);await this.rpcUnsubscribe(t,r,a);const l=Lt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Fo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Es(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}return Cn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Fo(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Es(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Fo(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Hc(ds({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ds({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ds({},r)),this.topicMap.set(r.topic,t),this.events.emit(ri.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ri.deleted,Hc(ds({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ri.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ri.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ii(r)&&this.onBatchSubscribe(r.map((s,a)=>Hc(ds({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Zt.connect,async()=>{await this.onConnect()}),this.relayer.on(Zt.disconnect,()=>{this.onDisconnect()}),this.events.on(ri.created,async t=>{const r=ri.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ri.deleted,async t=>{const r=ri.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var q2=Object.defineProperty,jf=Object.getOwnPropertySymbols,z2=Object.prototype.hasOwnProperty,H2=Object.prototype.propertyIsEnumerable,qf=(n,t,r)=>t in n?q2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,K2=(n,t)=>{for(var r in t||(t={}))z2.call(t,r)&&qf(n,r,t[r]);if(jf)for(var r of jf(t))H2.call(t,r)&&qf(n,r,t[r]);return n};class B2 extends xm{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new hr.exports.EventEmitter,this.name=d2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Zt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Zt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(_i.payload,this.onPayloadHandler),this.provider.on(_i.connect,this.onConnectHandler),this.provider.on(_i.disconnect,this.onDisconnectHandler),this.provider.on(_i.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ze.generateChildLogger(t.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:t.logger||f2})),this.messages=new N2(this.logger,t.core),this.subscriber=new j2(this,this.logger),this.publisher=new C2(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||ap,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Df}...`),await this.restartTransport(Df)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},y2)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(ri.created,p=>{p.topic===t&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(t,r),l()})]),a)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Es(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(ri.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await Es(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(_i.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await wf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Di(new TE(pb({sdkVersion:v2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Pu(t)){if(!t.method.endsWith(p2))return;const r=t.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(K2({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else ra(t)&&this.events.emit(Zt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Zt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=xu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(_i.payload,this.onPayloadHandler),this.provider.off(_i.connect,this.onConnectHandler),this.provider.off(_i.disconnect,this.onDisconnectHandler),this.provider.off(_i.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Zt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await wf();oE(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Zt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ye.toMiliseconds(g2)))}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var k2=Object.defineProperty,zf=Object.getOwnPropertySymbols,V2=Object.prototype.hasOwnProperty,G2=Object.prototype.propertyIsEnumerable,Hf=(n,t,r)=>t in n?k2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Kf=(n,t)=>{for(var r in t||(t={}))V2.call(t,r)&&Hf(n,r,t[r]);if(zf)for(var r of zf(t))G2.call(t,r)&&Hf(n,r,t[r]);return n};class na extends Pm{constructor(t,r,s,a=Li,l=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=_2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!ar(p)?this.map.set(this.getKey(p),p):Mb(p)?this.map.set(p.id,p):Fb(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,d)=>{this.isInitialized(),this.map.has(p)?await this.update(p,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:d}),this.map.set(p,d),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(d=>Object.keys(p).every(v=>RE(d[v],p[v]))):this.values),this.update=async(p,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:d});const v=Kf(Kf({},this.getData(p)),d);this.map.set(p,v),await this.persist()},this.delete=async(p,d)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:d}),this.map.delete(p),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class W2{constructor(t,r){this.core=t,this.logger=r,this.name=S2,this.version=I2,this.events=new hr.exports,this.initialized=!1,this.storagePrefix=Li,this.ignoredPayloadTypes=[sn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=iu(),a=await this.core.crypto.setSymKey(s),l=Vr(ye.FIVE_MINUTES),p={protocol:op},d={topic:a,expiry:l,relay:p,active:!1},v=Ob({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,d),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=Ib(s.uri);let d;if(this.pairings.keys.includes(a)&&(d=this.pairings.get(a),d.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p}));const v=Vr(ye.FIVE_MINUTES),w={topic:a,relay:p,expiry:v,active:!1};return await this.pairings.set(a,w),this.core.expirer.set(a,v),s.activatePairing&&await this.activate({topic:a}),this.events.emit(_s.create,w),w},this.activate=async({topic:s})=>{this.isInitialized();const a=Vr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:d,reject:v}=Rn();this.events.once(Ht("pairing_ping",l),({error:w})=>{w?v(w):d()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Lt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=Un(a,l),d=await this.core.crypto.encode(s,p),v=fs[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,d,v),p.id},this.sendResult=async(s,a,l)=>{const p=xu(s,l),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),w=fs[v.request.method].res;await this.core.relayer.publish(a,d,w),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=ta(s,l),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,s),w=fs[v.request.method]?fs[v.request.method].res:fs.unregistered_method.res;await this.core.relayer.publish(a,d,w),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Lt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ci(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit(_s.ping,{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{wi(a)?this.events.emit(Ht("pairing_ping",l),{}):Gr(a)&&this.events.emit(Ht("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(_s.delete,{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const d=Lt("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,d),this.logger.error(d)}catch(d){await this.sendError(l,s,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Lt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!_r(s)){const{message:a}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!$b(s.uri)){const{message:a}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!_r(s)){const{message:l}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:l}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:a}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ci(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new na(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Zt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{Pu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):ra(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async t=>{const{topic:r}=Fd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(_s.expire,{topic:r}))})}}class Y2 extends Em{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new hr.exports.EventEmitter,this.name=x2,this.version=P2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:Vr(ye.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(ti.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Gr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(ti.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(ti.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Un(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ti.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ti.created,t=>{const r=ti.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ti.updated,t=>{const r=ti.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ti.deleted,t=>{const r=ti.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ye.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class J2 extends Am{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new hr.exports.EventEmitter,this.name=O2,this.version=A2,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(Fr.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Fr.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return gb(t);if(typeof t=="number")return vb(t);const{message:r}=ce("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Fr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.expired,t=>{const r=Fr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Q2 extends Tm{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=zc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||ea()||!Ps())return;const a=(s==null?void 0:s.verifyUrl)||qo;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=$f;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=(s==null?void 0:s.verifyUrl)||qo;let l;try{l=await this.fetchAttestation(s.attestationId,a)}catch(p){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(p),l=await this.fetchAttestation(s.attestationId,$f)}return l},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const l=this.startAbortTimer(ye.ONE_SECOND*2),p=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(l),p.status===200?await p.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(l=>{if(document.getElementById(zc))return l();window.addEventListener("message",a);const p=document.createElement("iframe");p.id=zc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,s=l}),new Promise((l,p)=>setTimeout(()=>{window.removeEventListener("message",a),p("verify iframe load timeout")},ye.toMiliseconds(ye.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=qo,this.abortController=new AbortController,this.isDevEnv=wu()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(t))}}var X2=Object.defineProperty,Bf=Object.getOwnPropertySymbols,Z2=Object.prototype.hasOwnProperty,e5=Object.prototype.propertyIsEnumerable,kf=(n,t,r)=>t in n?X2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Vf=(n,t)=>{for(var r in t||(t={}))Z2.call(t,r)&&kf(n,r,t[r]);if(Bf)for(var r of Bf(t))e5.call(t,r)&&kf(n,r,t[r]);return n};class Au extends bm{constructor(t){super(t),this.protocol=sp,this.version=t2,this.name=Ou,this.events=new hr.exports.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||ap;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||r2.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new Dn.HeartBeat,this.crypto=new R2(this,this.logger,t==null?void 0:t.keychain),this.history=new Y2(this,this.logger),this.expirer=new J2(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new nm(Vf(Vf({},i2),t==null?void 0:t.storageOptions)),this.relayer=new B2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new W2(this,this.logger),this.verify=new Q2(this.projectId||"",this.logger)}static async init(t){const r=new Au(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(m2,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const t5=Au,cp="wc",up=2,hp="client",Tu=`${cp}@${up}:${hp}:`,Kc={name:hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Gf="WALLETCONNECT_DEEPLINK_CHOICE",r5="proposal",lp="Proposal expired",i5="session",Do=ye.SEVEN_DAYS,n5="engine",ps={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},Bc={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},mi={idle:"IDLE",active:"ACTIVE"},s5="request",o5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var a5=Object.defineProperty,c5=Object.defineProperties,u5=Object.getOwnPropertyDescriptors,Wf=Object.getOwnPropertySymbols,h5=Object.prototype.hasOwnProperty,l5=Object.prototype.propertyIsEnumerable,Yf=(n,t,r)=>t in n?a5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,yr=(n,t)=>{for(var r in t||(t={}))h5.call(t,r)&&Yf(n,r,t[r]);if(Wf)for(var r of Wf(t))l5.call(t,r)&&Yf(n,r,t[r]);return n},gs=(n,t)=>c5(n,u5(t));class f5 extends Nm{constructor(t){super(t),this.name=n5,this.events=new hr.exports,this.initialized=!1,this.ignoredPayloadTypes=[sn],this.requestQueue={state:mi.idle,queue:[]},this.sessionRequestQueue={state:mi.idle,queue:[]},this.requestQueueDelay=ye.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ps)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=gs(yr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:d,relays:v}=s;let w=a,x,N=!1;if(w&&(N=this.client.core.pairing.pairings.get(w).active),!w||!N){const{topic:ne,uri:F}=await this.client.core.pairing.create();w=ne,x=F}const L=await this.client.core.crypto.generateKeyPair(),T=yr({requiredNamespaces:l,optionalNamespaces:p,relays:v!=null?v:[{protocol:op}],proposer:{publicKey:L,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:M,resolve:H,done:K}=Rn(ye.FIVE_MINUTES,lp);if(this.events.once(Ht("session_connect"),async({error:ne,session:F})=>{if(ne)M(ne);else if(F){F.self.publicKey=L;const q=gs(yr({},F),{requiredNamespaces:F.requiredNamespaces,optionalNamespaces:F.optionalNamespaces});await this.client.session.set(F.topic,q),await this.setExpiry(F.topic,F.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:F.peer.metadata}),H(q)}}),!w){const{message:ne}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(ne)}const se=await this.sendRequest({topic:w,method:"wc_sessionPropose",params:T}),fe=Vr(ye.FIVE_MINUTES);return await this.setProposal(se,yr({id:se,expiry:fe},T)),{uri:x,approval:K}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,d=this.client.proposal.get(s);let{pairingTopic:v,proposer:w,requiredNamespaces:x,optionalNamespaces:N}=d;v=v||"",Ln(x)||(x=Nb(l,"approve()"));const L=await this.client.core.crypto.generateKeyPair(),T=w.publicKey,M=await this.client.core.crypto.generateSharedKey(L,T);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:w.metadata}),await this.sendResult({id:s,topic:v,result:{relay:{protocol:a!=null?a:"irn"},responderPublicKey:L}}),await this.client.proposal.delete(s,Lt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const H=yr({relay:{protocol:a!=null?a:"irn"},namespaces:l,requiredNamespaces:x,optionalNamespaces:N,pairingTopic:v,controller:{publicKey:L,metadata:this.client.metadata},expiry:Vr(Do)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(M),await this.sendRequest({topic:M,method:"wc_sessionSettle",params:H,throwOnFailedPublish:!0});const K=gs(yr({},H),{topic:M,pairingTopic:v,acknowledged:!1,self:H.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:L});return await this.client.session.set(M,K),await this.setExpiry(M,Vr(Do)),{topic:M,acknowledged:()=>new Promise(se=>setTimeout(()=>se(this.client.session.get(M)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,Lt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:p,resolve:d,reject:v}=Rn();return this.events.once(Ht("session_update",l),({error:w})=>{w?v(w):d()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:l,resolve:p,reject:d}=Rn();return this.events.once(Ht("session_extend",a),({error:v})=>{v?d(v):p()}),await this.setExpiry(s,Vr(Do)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,d=Iu(),{done:v,resolve:w,reject:x}=Rn(p);return this.events.once(Ht("session_request",d),({error:N,result:L})=>{N?x(N):w(L)}),await Promise.all([new Promise(async N=>{await this.sendRequest({clientRpcId:d,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:p,throwOnFailedPublish:!0}).catch(L=>x(L)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:d}),N()}),new Promise(async N=>{const L=await this.client.core.storage.getItem(Gf);yb({id:d,topic:l,wcDeepLink:L}),N()}),v()]).then(N=>N[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;wi(a)?await this.sendResult({id:l,topic:s,result:a.result,throwOnFailedPublish:!0}):Gr(a)&&await this.sendError(l,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:l,resolve:p,reject:d}=Rn();this.events.once(Ht("session_ping",a),({error:v})=>{v?d(v):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Lt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Ub(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var p,d;return((p=l.peerMetadata)==null?void 0:p.url)&&((d=l.peerMetadata)==null?void 0:d.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Lt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Gf).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Lt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=mi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ps.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p,verifyContext:d}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p,verifyContext:d}),s&&this.client.core.expirer.set(a,Vr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:l,expiry:p,relayRpcId:d,clientRpcId:v,throwOnFailedPublish:w}=r,x=Un(a,l,v);if(Ps()&&o5.includes(a)){const T=Cn(JSON.stringify(x));this.client.core.verify.register({attestationId:T})}const N=await this.client.core.crypto.encode(s,x),L=ps[a].req;return p&&(L.ttl=p),d&&(L.id=d),this.client.core.history.set(s,x),w?(L.internal=gs(yr({},L.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,N,L)):this.client.core.relayer.publish(s,N,L).catch(T=>this.client.logger.error(T)),x.id},this.sendResult=async r=>{const{id:s,topic:a,result:l,throwOnFailedPublish:p}=r,d=xu(s,l),v=await this.client.core.crypto.encode(a,d),w=await this.client.core.history.get(a,s),x=ps[w.request.method].res;p?(x.internal=gs(yr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,v,x)):this.client.core.relayer.publish(a,v,x).catch(N=>this.client.logger.error(N)),await this.client.core.history.resolve(d)},this.sendError=async(r,s,a)=>{const l=ta(r,a),p=await this.client.core.crypto.encode(s,l),d=await this.client.core.history.get(s,r),v=ps[d.request.method].res;this.client.core.relayer.publish(s,p,v),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ci(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ci(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===mi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=mi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=mi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(yr({},s.params));const p=Vr(ye.FIVE_MINUTES),d=yr({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,d);const v=Cn(JSON.stringify(s)),w=await this.getVerifyContext(v,d.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:d,verifyContext:w})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(wi(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const d=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const v=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const w=await this.client.core.crypto.generateSharedKey(d,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const x=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:r})}else Gr(s)&&(await this.client.proposal.delete(a,Lt("USER_DISCONNECTED")),this.events.emit(Ht("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:d,expiry:v,namespaces:w,requiredNamespaces:x,optionalNamespaces:N,sessionProperties:L,pairingTopic:T}=s.params,M=yr({topic:r,relay:p,expiry:v,namespaces:w,acknowledged:!0,pairingTopic:T,requiredNamespaces:x,optionalNamespaces:N,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},L&&{sessionProperties:L});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ht("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;wi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ht("session_approve",a),{})):Gr(s)&&(await this.client.session.delete(r,Lt("USER_DISCONNECTED")),this.events.emit(Ht("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{const p=`${r}_session_update`,d=Uo.get(p);if(d&&this.isRequestOutOfSync(d,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(yr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),Uo.set(p,l)}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;wi(s)?this.events.emit(Ht("session_update",a),{}):Gr(s)&&this.events.emit(Ht("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Vr(Do)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;wi(s)?this.events.emit(Ht("session_extend",a),{}):Gr(s)&&this.events.emit(Ht("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{wi(s)?this.events.emit(Ht("session_ping",a),{}):Gr(s)&&this.events.emit(Ht("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Zt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(yr({topic:r},l));const p=Cn(JSON.stringify(Un("wc_sessionRequest",l,a))),d=this.client.session.get(r),v=await this.getVerifyContext(p,d.peer.metadata),w={id:a,topic:r,params:l,verifyContext:v};await this.setPendingSessionRequest(w),this.addSessionRequestToSessionRequestQueue(w),this.processSessionRequestQueue()}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;wi(s)?this.events.emit(Ht("session_request",a),{result:s.result}):Gr(s)&&this.events.emit(Ht("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{const p=`${r}_session_event_${l.event.name}`,d=Uo.get(p);if(d&&this.isRequestOutOfSync(d,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(yr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),Uo.set(p,a)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=mi.idle,this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===mi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=mi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Un("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer},s.id))},this.isValidConnect=async r=>{if(!_r(r)){const{message:v}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:d}=r;if(ar(s)||await this.isValidPairingTopic(s),!Vb(d,!0)){const{message:v}=ce("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(v)}!ar(a)&&Ln(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ar(l)&&Ln(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),ar(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=kb(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!_r(r))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const d=this.client.proposal.get(s),v=jo(a,"approve()");if(v)throw new Error(v.message);const w=_f(d.requiredNamespaces,a,"approve()");if(w)throw new Error(w.message);if(!Gt(l,!0)){const{message:x}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(x)}ar(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!_r(r)){const{message:l}=ce("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!Wb(a)){const{message:l}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!_r(r)){const{message:w}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!qd(s)){const{message:w}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const d=jb(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);const v=jo(l,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Ci(p)){const{message:w}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!_r(r)){const{message:v}=ce("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=jo(a,"update()");if(p)throw new Error(p.message);const d=_f(l.requiredNamespaces,a,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!_r(r)){const{message:a}=ce("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!_r(r)){const{message:v}=ce("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!yf(d,l)){const{message:v}=ce("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(v)}if(!Yb(a)){const{message:v}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!Xb(d,l,a.method)){const{message:v}=ce("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(p&&!rE(p,Bc)){const{message:v}=ce("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Bc.min} and ${Bc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!_r(r)){const{message:l}=ce("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!Jb(a)){const{message:l}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!_r(r)){const{message:a}=ce("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!_r(r)){const{message:d}=ce("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!yf(p,l)){const{message:d}=ce("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(d)}if(!Qb(a)){const{message:d}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}if(!Zb(p,l,a.name)){const{message:d}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!_r(r)){const{message:a}=ce("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||qo,validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Gt(a,!1)){const{message:l}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ce("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Zt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{Pu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):ra(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async t=>{const{topic:r,id:s}=Fd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(_s.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Gt(t,!1)){const{message:r}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ce("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Gt(t,!1)){const{message:r}=ce("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=ce("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Gt(t,!1)){const{message:r}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Gb(t)){const{message:r}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=ce("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class d5 extends na{constructor(t,r){super(t,r,r5,Tu),this.core=t,this.logger=r}}class p5 extends na{constructor(t,r){super(t,r,i5,Tu),this.core=t,this.logger=r}}class g5 extends na{constructor(t,r){super(t,r,s5,Tu,s=>s.id),this.core=t,this.logger=r}}class Ru extends Rm{constructor(t){super(t),this.protocol=cp,this.version=up,this.name=Kc.name,this.events=new hr.exports.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Kc.name,this.metadata=(t==null?void 0:t.metadata)||hb();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Kc.logger}));this.core=(t==null?void 0:t.core)||new t5(t),this.logger=Ze.generateChildLogger(r,this.name),this.session=new p5(this.core,this.logger),this.proposal=new d5(this.core,this.logger),this.pendingRequest=new g5(this.core,this.logger),this.engine=new f5(this)}static async init(t){const r=new Ru(t);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const v5={Accept:"application/json","Content-Type":"application/json"},y5="POST",Jf={headers:v5,method:y5},Qf=10;class on{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new hr.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!If(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=bs(t),l=await(await Cl(this.url,Object.assign(Object.assign({},Jf),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!If(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=bs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Cl(t,Object.assign(Object.assign({},Jf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?lu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=ta(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return Kd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Qf&&this.events.setMaxListeners(Qf)}}const Xf="error",_5="wss://relay.walletconnect.com",m5="wc",w5="universal_provider",Zf=`${m5}@2:${w5}:`,b5="https://rpc.walletconnect.com/v1/",$i={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof bt<"u"?bt:typeof self<"u"?self:{},cu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",d="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",w=500,x="__lodash_placeholder__",N=1,L=2,T=4,M=1,H=2,K=1,se=2,fe=4,ne=8,F=16,q=32,E=64,u=128,m=256,J=512,B=30,ie="...",ae=800,ge=16,O=1,$=2,he=3,Z=1/0,k=9007199254740991,X=17976931348623157e292,V=0/0,ee=4294967295,Pe=ee-1,te=ee>>>1,we=[["ary",u],["bind",K],["bindKey",se],["curry",ne],["curryRight",F],["flip",J],["partial",q],["partialRight",E],["rearg",m]],ue="[object Arguments]",_e="[object Array]",D="[object AsyncFunction]",U="[object Boolean]",P="[object Date]",h="[object DOMException]",S="[object Error]",re="[object Function]",le="[object GeneratorFunction]",Ie="[object Map]",He="[object Number]",ke="[object Null]",Me="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",xe="[object Set]",Le="[object String]",Ue="[object Symbol]",qe="[object Undefined]",Ae="[object WeakMap]",De="[object WeakSet]",Se="[object ArrayBuffer]",Te="[object DataView]",Ke="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",lr="[object Uint32Array]",Wr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ni=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bi=/&(?:amp|lt|gt|quot|#39);/g,Mi=/[&<>"']/g,Et=RegExp(bi.source),vt=RegExp(Mi.source),St=/<%-([\s\S]+?)%>/g,It=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,$t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xt=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(xt.source),Pt=/^\s+/,Tt=/\s/,Ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Ft=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sa=/[()=,{}\[\]\/\s]/,oa=/\\(\\)?/g,aa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tr=/\w*$/,ca=/^[-+]0x[0-9a-f]+$/i,ua=/^0b[01]+$/i,ha=/^\[object .+?Constructor\]$/,la=/^0o[0-7]+$/i,fa=/^(?:0|[1-9]\d*)$/,si=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,cn=/($^)/,da=/['\n\r\u2028\u2029\\]/g,un="\\ud800-\\udfff",pa="\\u0300-\\u036f",ga="\\ufe20-\\ufe2f",hn="\\u20d0-\\u20ff",Ts=pa+ga+hn,Rs="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",va="\\xac\\xb1\\xd7\\xf7",ya="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_a="\\u2000-\\u206f",ma=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ns="A-Z\\xc0-\\xd6\\xd8-\\xde",Cs="\\ufe0e\\ufe0f",Fi=va+ya+_a+ma,qn="['\u2019]",ji="["+un+"]",zn="["+Fi+"]",qi="["+Ts+"]",Ls="\\d+",wa="["+Rs+"]",Us="["+qr+"]",Ds="[^"+un+Fi+Ls+Rs+qr+Ns+"]",ln="\\ud83c[\\udffb-\\udfff]",ba="(?:"+qi+"|"+ln+")",$s="[^"+un+"]",fn="(?:\\ud83c[\\udde6-\\uddff]){2}",Ei="[\\ud800-\\udbff][\\udc00-\\udfff]",wr="["+Ns+"]",Ms="\\u200d",Fs="(?:"+Us+"|"+Ds+")",Yr="(?:"+wr+"|"+Ds+")",js="(?:"+qn+"(?:d|ll|m|re|s|t|ve))?",qs="(?:"+qn+"(?:D|LL|M|RE|S|T|VE))?",zs=ba+"?",Hs="["+Cs+"]?",Ea="(?:"+Ms+"(?:"+[$s,fn,Ei].join("|")+")"+Hs+zs+")*",oi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ks="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Bs=Hs+zs+Ea,dn="(?:"+[wa,fn,Ei].join("|")+")"+Bs,Sa="(?:"+[$s+qi+"?",qi,fn,Ei,ji].join("|")+")",Hn=RegExp(qn,"g"),Ia=RegExp(qi,"g"),pn=RegExp(ln+"(?="+ln+")|"+Sa+Bs,"g"),ks=RegExp([wr+"?"+Us+"+"+js+"(?="+[zn,wr,"$"].join("|")+")",Yr+"+"+qs+"(?="+[zn,wr+Fs,"$"].join("|")+")",wr+"?"+Fs+"+"+js,wr+"+"+qs,Ks,oi,Ls,dn].join("|"),"g"),Vs=RegExp("["+Ms+un+Ts+Cs+"]"),zi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xa=-1,ot={};ot[Ke]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[er]=ot[lr]=!0,ot[ue]=ot[_e]=ot[Se]=ot[U]=ot[Te]=ot[P]=ot[S]=ot[re]=ot[Ie]=ot[He]=ot[Me]=ot[je]=ot[xe]=ot[Le]=ot[Ae]=!1;var st={};st[ue]=st[_e]=st[Se]=st[Te]=st[U]=st[P]=st[Ke]=st[Oe]=st[Ve]=st[We]=st[et]=st[Ie]=st[He]=st[Me]=st[je]=st[xe]=st[Le]=st[Ue]=st[tt]=st[Je]=st[er]=st[lr]=!0,st[S]=st[re]=st[Ae]=!1;var _={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Y={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Ne=parseInt,ft=typeof vs=="object"&&vs&&vs.Object===Object&&vs,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=ft||qt||Function("return this")(),ct=t&&!t.nodeType&&t,Rt=ct&&!0&&n&&!n.nodeType&&n,fr=Rt&&Rt.exports===ct,zt=fr&&ft.process,dt=function(){try{var R=Rt&&Rt.require&&Rt.require("util").types;return R||zt&&zt.binding&&zt.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,zr=dt&&dt.isDate,Rr=dt&&dt.isMap,Jr=dt&&dt.isRegExp,Kn=dt&&dt.isSet,Hi=dt&&dt.isTypedArray;function kt(R,z,j){switch(j.length){case 0:return R.call(z);case 1:return R.call(z,j[0]);case 2:return R.call(z,j[0],j[1]);case 3:return R.call(z,j[0],j[1],j[2])}return R.apply(z,j)}function pp(R,z,j,pe){for(var Re=-1,rt=R==null?0:R.length;++Re<rt;){var Kt=R[Re];z(pe,Kt,j(Kt),R)}return pe}function Nr(R,z){for(var j=-1,pe=R==null?0:R.length;++j<pe&&z(R[j],j,R)!==!1;);return R}function gp(R,z){for(var j=R==null?0:R.length;j--&&z(R[j],j,R)!==!1;);return R}function Lu(R,z){for(var j=-1,pe=R==null?0:R.length;++j<pe;)if(!z(R[j],j,R))return!1;return!0}function Si(R,z){for(var j=-1,pe=R==null?0:R.length,Re=0,rt=[];++j<pe;){var Kt=R[j];z(Kt,j,R)&&(rt[Re++]=Kt)}return rt}function Ws(R,z){var j=R==null?0:R.length;return!!j&&gn(R,z,0)>-1}function Pa(R,z,j){for(var pe=-1,Re=R==null?0:R.length;++pe<Re;)if(j(z,R[pe]))return!0;return!1}function _t(R,z){for(var j=-1,pe=R==null?0:R.length,Re=Array(pe);++j<pe;)Re[j]=z(R[j],j,R);return Re}function Ii(R,z){for(var j=-1,pe=z.length,Re=R.length;++j<pe;)R[Re+j]=z[j];return R}function Oa(R,z,j,pe){var Re=-1,rt=R==null?0:R.length;for(pe&&rt&&(j=R[++Re]);++Re<rt;)j=z(j,R[Re],Re,R);return j}function vp(R,z,j,pe){var Re=R==null?0:R.length;for(pe&&Re&&(j=R[--Re]);Re--;)j=z(j,R[Re],Re,R);return j}function Aa(R,z){for(var j=-1,pe=R==null?0:R.length;++j<pe;)if(z(R[j],j,R))return!0;return!1}var yp=Ta("length");function _p(R){return R.split("")}function mp(R){return R.match(jt)||[]}function Uu(R,z,j){var pe;return j(R,function(Re,rt,Kt){if(z(Re,rt,Kt))return pe=rt,!1}),pe}function Ys(R,z,j,pe){for(var Re=R.length,rt=j+(pe?1:-1);pe?rt--:++rt<Re;)if(z(R[rt],rt,R))return rt;return-1}function gn(R,z,j){return z===z?Np(R,z,j):Ys(R,Du,j)}function wp(R,z,j,pe){for(var Re=j-1,rt=R.length;++Re<rt;)if(pe(R[Re],z))return Re;return-1}function Du(R){return R!==R}function $u(R,z){var j=R==null?0:R.length;return j?Na(R,z)/j:V}function Ta(R){return function(z){return z==null?r:z[R]}}function Ra(R){return function(z){return R==null?r:R[z]}}function Mu(R,z,j,pe,Re){return Re(R,function(rt,Kt,ut){j=pe?(pe=!1,rt):z(j,rt,Kt,ut)}),j}function bp(R,z){var j=R.length;for(R.sort(z);j--;)R[j]=R[j].value;return R}function Na(R,z){for(var j,pe=-1,Re=R.length;++pe<Re;){var rt=z(R[pe]);rt!==r&&(j=j===r?rt:j+rt)}return j}function Ca(R,z){for(var j=-1,pe=Array(R);++j<R;)pe[j]=z(j);return pe}function Ep(R,z){return _t(z,function(j){return[j,R[j]]})}function Fu(R){return R&&R.slice(0,Hu(R)+1).replace(Pt,"")}function br(R){return function(z){return R(z)}}function La(R,z){return _t(z,function(j){return R[j]})}function Bn(R,z){return R.has(z)}function ju(R,z){for(var j=-1,pe=R.length;++j<pe&&gn(z,R[j],0)>-1;);return j}function qu(R,z){for(var j=R.length;j--&&gn(z,R[j],0)>-1;);return j}function Sp(R,z){for(var j=R.length,pe=0;j--;)R[j]===z&&++pe;return pe}var Ip=Ra(_),xp=Ra(A);function Pp(R){return"\\"+de[R]}function Op(R,z){return R==null?r:R[z]}function vn(R){return Vs.test(R)}function Ap(R){return zi.test(R)}function Tp(R){for(var z,j=[];!(z=R.next()).done;)j.push(z.value);return j}function Ua(R){var z=-1,j=Array(R.size);return R.forEach(function(pe,Re){j[++z]=[Re,pe]}),j}function zu(R,z){return function(j){return R(z(j))}}function xi(R,z){for(var j=-1,pe=R.length,Re=0,rt=[];++j<pe;){var Kt=R[j];(Kt===z||Kt===x)&&(R[j]=x,rt[Re++]=j)}return rt}function Js(R){var z=-1,j=Array(R.size);return R.forEach(function(pe){j[++z]=pe}),j}function Rp(R){var z=-1,j=Array(R.size);return R.forEach(function(pe){j[++z]=[pe,pe]}),j}function Np(R,z,j){for(var pe=j-1,Re=R.length;++pe<Re;)if(R[pe]===z)return pe;return-1}function Cp(R,z,j){for(var pe=j+1;pe--;)if(R[pe]===z)return pe;return pe}function yn(R){return vn(R)?Up(R):yp(R)}function Hr(R){return vn(R)?Dp(R):_p(R)}function Hu(R){for(var z=R.length;z--&&Tt.test(R.charAt(z)););return z}var Lp=Ra(Y);function Up(R){for(var z=pn.lastIndex=0;pn.test(R);)++z;return z}function Dp(R){return R.match(pn)||[]}function $p(R){return R.match(ks)||[]}var Mp=function R(z){z=z==null?Qe:_n.defaults(Qe.Object(),z,_n.pick(Qe,Gs));var j=z.Array,pe=z.Date,Re=z.Error,rt=z.Function,Kt=z.Math,ut=z.Object,Da=z.RegExp,Fp=z.String,Cr=z.TypeError,Qs=j.prototype,jp=rt.prototype,mn=ut.prototype,Xs=z["__core-js_shared__"],Zs=jp.toString,nt=mn.hasOwnProperty,qp=0,Ku=function(){var e=/[^.]+$/.exec(Xs&&Xs.keys&&Xs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),eo=mn.toString,zp=Zs.call(ut),Hp=Qe._,Kp=Da("^"+Zs.call(nt).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),to=fr?z.Buffer:r,Pi=z.Symbol,ro=z.Uint8Array,Bu=to?to.allocUnsafe:r,io=zu(ut.getPrototypeOf,ut),ku=ut.create,Vu=mn.propertyIsEnumerable,no=Qs.splice,Gu=Pi?Pi.isConcatSpreadable:r,kn=Pi?Pi.iterator:r,Ki=Pi?Pi.toStringTag:r,so=function(){try{var e=Wi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),Bp=z.clearTimeout!==Qe.clearTimeout&&z.clearTimeout,kp=pe&&pe.now!==Qe.Date.now&&pe.now,Vp=z.setTimeout!==Qe.setTimeout&&z.setTimeout,oo=Kt.ceil,ao=Kt.floor,$a=ut.getOwnPropertySymbols,Gp=to?to.isBuffer:r,Wu=z.isFinite,Wp=Qs.join,Yp=zu(ut.keys,ut),Bt=Kt.max,Jt=Kt.min,Jp=pe.now,Qp=z.parseInt,Yu=Kt.random,Xp=Qs.reverse,Ma=Wi(z,"DataView"),Vn=Wi(z,"Map"),Fa=Wi(z,"Promise"),wn=Wi(z,"Set"),Gn=Wi(z,"WeakMap"),Wn=Wi(ut,"create"),co=Gn&&new Gn,bn={},Zp=Yi(Ma),eg=Yi(Vn),tg=Yi(Fa),rg=Yi(wn),ig=Yi(Gn),uo=Pi?Pi.prototype:r,Yn=uo?uo.valueOf:r,Ju=uo?uo.toString:r;function g(e){if(At(e)&&!Ce(e)&&!(e instanceof Ye)){if(e instanceof Lr)return e;if(nt.call(e,"__wrapped__"))return Qh(e)}return new Lr(e)}var En=function(){function e(){}return function(i){if(!wt(i))return{};if(ku)return ku(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function ho(){}function Lr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}g.templateSettings={escape:St,evaluate:It,interpolate:mt,variable:"",imports:{_:g}},g.prototype=ho.prototype,g.prototype.constructor=g,Lr.prototype=En(ho.prototype),Lr.prototype.constructor=Lr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ee,this.__views__=[]}function ng(){var e=new Ye(this.__wrapped__);return e.__actions__=dr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=dr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=dr(this.__views__),e}function sg(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function og(){var e=this.__wrapped__.value(),i=this.__dir__,o=Ce(e),c=i<0,f=o?e.length:0,y=_0(0,f,this.__views__),b=y.start,I=y.end,C=I-b,G=c?I:b-1,W=this.__iteratees__,Q=W.length,oe=0,ve=Jt(C,this.__takeCount__);if(!o||!c&&f==C&&ve==C)return wh(e,this.__actions__);var be=[];e:for(;C--&&oe<ve;){G+=i;for(var ze=-1,Ee=e[G];++ze<Q;){var Ge=W[ze],Xe=Ge.iteratee,Ir=Ge.type,sr=Xe(Ee);if(Ir==$)Ee=sr;else if(!sr){if(Ir==O)continue e;break e}}be[oe++]=Ee}return be}Ye.prototype=En(ho.prototype),Ye.prototype.constructor=Ye;function Bi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function ag(){this.__data__=Wn?Wn(null):{},this.size=0}function cg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function ug(e){var i=this.__data__;if(Wn){var o=i[e];return o===v?r:o}return nt.call(i,e)?i[e]:r}function hg(e){var i=this.__data__;return Wn?i[e]!==r:nt.call(i,e)}function lg(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Wn&&i===r?v:i,this}Bi.prototype.clear=ag,Bi.prototype.delete=cg,Bi.prototype.get=ug,Bi.prototype.has=hg,Bi.prototype.set=lg;function ai(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function fg(){this.__data__=[],this.size=0}function dg(e){var i=this.__data__,o=lo(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():no.call(i,o,1),--this.size,!0}function pg(e){var i=this.__data__,o=lo(i,e);return o<0?r:i[o][1]}function gg(e){return lo(this.__data__,e)>-1}function vg(e,i){var o=this.__data__,c=lo(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ai.prototype.clear=fg,ai.prototype.delete=dg,ai.prototype.get=pg,ai.prototype.has=gg,ai.prototype.set=vg;function ci(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function yg(){this.size=0,this.__data__={hash:new Bi,map:new(Vn||ai),string:new Bi}}function _g(e){var i=Io(this,e).delete(e);return this.size-=i?1:0,i}function mg(e){return Io(this,e).get(e)}function wg(e){return Io(this,e).has(e)}function bg(e,i){var o=Io(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ci.prototype.clear=yg,ci.prototype.delete=_g,ci.prototype.get=mg,ci.prototype.has=wg,ci.prototype.set=bg;function ki(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ci;++i<o;)this.add(e[i])}function Eg(e){return this.__data__.set(e,v),this}function Sg(e){return this.__data__.has(e)}ki.prototype.add=ki.prototype.push=Eg,ki.prototype.has=Sg;function Kr(e){var i=this.__data__=new ai(e);this.size=i.size}function Ig(){this.__data__=new ai,this.size=0}function xg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Pg(e){return this.__data__.get(e)}function Og(e){return this.__data__.has(e)}function Ag(e,i){var o=this.__data__;if(o instanceof ai){var c=o.__data__;if(!Vn||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ci(c)}return o.set(e,i),this.size=o.size,this}Kr.prototype.clear=Ig,Kr.prototype.delete=xg,Kr.prototype.get=Pg,Kr.prototype.has=Og,Kr.prototype.set=Ag;function Qu(e,i){var o=Ce(e),c=!o&&Ji(e),f=!o&&!c&&Ni(e),y=!o&&!c&&!f&&Pn(e),b=o||c||f||y,I=b?Ca(e.length,Fp):[],C=I.length;for(var G in e)(i||nt.call(e,G))&&!(b&&(G=="length"||f&&(G=="offset"||G=="parent")||y&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||fi(G,C)))&&I.push(G);return I}function Xu(e){var i=e.length;return i?e[Ya(0,i-1)]:r}function Tg(e,i){return xo(dr(e),Vi(i,0,e.length))}function Rg(e){return xo(dr(e))}function ja(e,i,o){(o!==r&&!Br(e[i],o)||o===r&&!(i in e))&&ui(e,i,o)}function Jn(e,i,o){var c=e[i];(!(nt.call(e,i)&&Br(c,o))||o===r&&!(i in e))&&ui(e,i,o)}function lo(e,i){for(var o=e.length;o--;)if(Br(e[o][0],i))return o;return-1}function Ng(e,i,o,c){return Oi(e,function(f,y,b){i(c,f,o(f),b)}),c}function Zu(e,i){return e&&Xr(i,Vt(i),e)}function Cg(e,i){return e&&Xr(i,gr(i),e)}function ui(e,i,o){i=="__proto__"&&so?so(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function qa(e,i){for(var o=-1,c=i.length,f=j(c),y=e==null;++o<c;)f[o]=y?r:wc(e,i[o]);return f}function Vi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Ur(e,i,o,c,f,y){var b,I=i&N,C=i&L,G=i&T;if(o&&(b=f?o(e,c,f,y):o(e)),b!==r)return b;if(!wt(e))return e;var W=Ce(e);if(W){if(b=w0(e),!I)return dr(e,b)}else{var Q=Qt(e),oe=Q==re||Q==le;if(Ni(e))return Sh(e,I);if(Q==Me||Q==ue||oe&&!f){if(b=C||oe?{}:Hh(e),!I)return C?u0(e,Cg(b,e)):c0(e,Zu(b,e))}else{if(!st[Q])return f?e:{};b=b0(e,Q,I)}}y||(y=new Kr);var ve=y.get(e);if(ve)return ve;y.set(e,b),yl(e)?e.forEach(function(Ee){b.add(Ur(Ee,i,o,Ee,e,y))}):gl(e)&&e.forEach(function(Ee,Ge){b.set(Ge,Ur(Ee,i,o,Ge,e,y))});var be=G?C?oc:sc:C?gr:Vt,ze=W?r:be(e);return Nr(ze||e,function(Ee,Ge){ze&&(Ge=Ee,Ee=e[Ge]),Jn(b,Ge,Ur(Ee,i,o,Ge,e,y))}),b}function Lg(e){var i=Vt(e);return function(o){return eh(o,e,i)}}function eh(e,i,o){var c=o.length;if(e==null)return!c;for(e=ut(e);c--;){var f=o[c],y=i[f],b=e[f];if(b===r&&!(f in e)||!y(b))return!1}return!0}function th(e,i,o){if(typeof e!="function")throw new Cr(p);return is(function(){e.apply(r,o)},i)}function Qn(e,i,o,c){var f=-1,y=Ws,b=!0,I=e.length,C=[],G=i.length;if(!I)return C;o&&(i=_t(i,br(o))),c?(y=Pa,b=!1):i.length>=a&&(y=Bn,b=!1,i=new ki(i));e:for(;++f<I;){var W=e[f],Q=o==null?W:o(W);if(W=c||W!==0?W:0,b&&Q===Q){for(var oe=G;oe--;)if(i[oe]===Q)continue e;C.push(W)}else y(i,Q,c)||C.push(W)}return C}var Oi=Ah(Qr),rh=Ah(Ha,!0);function Ug(e,i){var o=!0;return Oi(e,function(c,f,y){return o=!!i(c,f,y),o}),o}function fo(e,i,o){for(var c=-1,f=e.length;++c<f;){var y=e[c],b=i(y);if(b!=null&&(I===r?b===b&&!Sr(b):o(b,I)))var I=b,C=y}return C}function Dg(e,i,o,c){var f=e.length;for(o=Fe(o),o<0&&(o=-o>f?0:f+o),c=c===r||c>f?f:Fe(c),c<0&&(c+=f),c=o>c?0:ml(c);o<c;)e[o++]=i;return e}function ih(e,i){var o=[];return Oi(e,function(c,f,y){i(c,f,y)&&o.push(c)}),o}function Wt(e,i,o,c,f){var y=-1,b=e.length;for(o||(o=S0),f||(f=[]);++y<b;){var I=e[y];i>0&&o(I)?i>1?Wt(I,i-1,o,c,f):Ii(f,I):c||(f[f.length]=I)}return f}var za=Th(),nh=Th(!0);function Qr(e,i){return e&&za(e,i,Vt)}function Ha(e,i){return e&&nh(e,i,Vt)}function po(e,i){return Si(i,function(o){return di(e[o])})}function Gi(e,i){i=Ti(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Zr(i[o++])];return o&&o==c?e:r}function sh(e,i,o){var c=i(e);return Ce(e)?c:Ii(c,o(e))}function ir(e){return e==null?e===r?qe:ke:Ki&&Ki in ut(e)?y0(e):R0(e)}function Ka(e,i){return e>i}function $g(e,i){return e!=null&&nt.call(e,i)}function Mg(e,i){return e!=null&&i in ut(e)}function Fg(e,i,o){return e>=Jt(i,o)&&e<Bt(i,o)}function Ba(e,i,o){for(var c=o?Pa:Ws,f=e[0].length,y=e.length,b=y,I=j(y),C=1/0,G=[];b--;){var W=e[b];b&&i&&(W=_t(W,br(i))),C=Jt(W.length,C),I[b]=!o&&(i||f>=120&&W.length>=120)?new ki(b&&W):r}W=e[0];var Q=-1,oe=I[0];e:for(;++Q<f&&G.length<C;){var ve=W[Q],be=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(oe?Bn(oe,be):c(G,be,o))){for(b=y;--b;){var ze=I[b];if(!(ze?Bn(ze,be):c(e[b],be,o)))continue e}oe&&oe.push(be),G.push(ve)}}return G}function jg(e,i,o,c){return Qr(e,function(f,y,b){i(c,o(f),y,b)}),c}function Xn(e,i,o){i=Ti(i,e),e=Vh(e,i);var c=e==null?e:e[Zr($r(i))];return c==null?r:kt(c,e,o)}function oh(e){return At(e)&&ir(e)==ue}function qg(e){return At(e)&&ir(e)==Se}function zg(e){return At(e)&&ir(e)==P}function Zn(e,i,o,c,f){return e===i?!0:e==null||i==null||!At(e)&&!At(i)?e!==e&&i!==i:Hg(e,i,o,c,Zn,f)}function Hg(e,i,o,c,f,y){var b=Ce(e),I=Ce(i),C=b?_e:Qt(e),G=I?_e:Qt(i);C=C==ue?Me:C,G=G==ue?Me:G;var W=C==Me,Q=G==Me,oe=C==G;if(oe&&Ni(e)){if(!Ni(i))return!1;b=!0,W=!1}if(oe&&!W)return y||(y=new Kr),b||Pn(e)?jh(e,i,o,c,f,y):g0(e,i,C,o,c,f,y);if(!(o&M)){var ve=W&&nt.call(e,"__wrapped__"),be=Q&&nt.call(i,"__wrapped__");if(ve||be){var ze=ve?e.value():e,Ee=be?i.value():i;return y||(y=new Kr),f(ze,Ee,o,c,y)}}return oe?(y||(y=new Kr),v0(e,i,o,c,f,y)):!1}function Kg(e){return At(e)&&Qt(e)==Ie}function ka(e,i,o,c){var f=o.length,y=f,b=!c;if(e==null)return!y;for(e=ut(e);f--;){var I=o[f];if(b&&I[2]?I[1]!==e[I[0]]:!(I[0]in e))return!1}for(;++f<y;){I=o[f];var C=I[0],G=e[C],W=I[1];if(b&&I[2]){if(G===r&&!(C in e))return!1}else{var Q=new Kr;if(c)var oe=c(G,W,C,e,i,Q);if(!(oe===r?Zn(W,G,M|H,c,Q):oe))return!1}}return!0}function ah(e){if(!wt(e)||x0(e))return!1;var i=di(e)?Kp:ha;return i.test(Yi(e))}function Bg(e){return At(e)&&ir(e)==je}function kg(e){return At(e)&&Qt(e)==xe}function Vg(e){return At(e)&&No(e.length)&&!!ot[ir(e)]}function ch(e){return typeof e=="function"?e:e==null?vr:typeof e=="object"?Ce(e)?lh(e[0],e[1]):hh(e):Rl(e)}function Va(e){if(!rs(e))return Yp(e);var i=[];for(var o in ut(e))nt.call(e,o)&&o!="constructor"&&i.push(o);return i}function Gg(e){if(!wt(e))return T0(e);var i=rs(e),o=[];for(var c in e)c=="constructor"&&(i||!nt.call(e,c))||o.push(c);return o}function Ga(e,i){return e<i}function uh(e,i){var o=-1,c=pr(e)?j(e.length):[];return Oi(e,function(f,y,b){c[++o]=i(f,y,b)}),c}function hh(e){var i=cc(e);return i.length==1&&i[0][2]?Bh(i[0][0],i[0][1]):function(o){return o===e||ka(o,e,i)}}function lh(e,i){return hc(e)&&Kh(i)?Bh(Zr(e),i):function(o){var c=wc(o,e);return c===r&&c===i?bc(o,e):Zn(i,c,M|H)}}function go(e,i,o,c,f){e!==i&&za(i,function(y,b){if(f||(f=new Kr),wt(y))Wg(e,i,b,o,go,c,f);else{var I=c?c(fc(e,b),y,b+"",e,i,f):r;I===r&&(I=y),ja(e,b,I)}},gr)}function Wg(e,i,o,c,f,y,b){var I=fc(e,o),C=fc(i,o),G=b.get(C);if(G){ja(e,o,G);return}var W=y?y(I,C,o+"",e,i,b):r,Q=W===r;if(Q){var oe=Ce(C),ve=!oe&&Ni(C),be=!oe&&!ve&&Pn(C);W=C,oe||ve||be?Ce(I)?W=I:Nt(I)?W=dr(I):ve?(Q=!1,W=Sh(C,!0)):be?(Q=!1,W=Ih(C,!0)):W=[]:ns(C)||Ji(C)?(W=I,Ji(I)?W=wl(I):(!wt(I)||di(I))&&(W=Hh(C))):Q=!1}Q&&(b.set(C,W),f(W,C,c,y,b),b.delete(C)),ja(e,o,W)}function fh(e,i){var o=e.length;if(o)return i+=i<0?o:0,fi(i,o)?e[i]:r}function dh(e,i,o){i.length?i=_t(i,function(y){return Ce(y)?function(b){return Gi(b,y.length===1?y[0]:y)}:y}):i=[vr];var c=-1;i=_t(i,br(me()));var f=uh(e,function(y,b,I){var C=_t(i,function(G){return G(y)});return{criteria:C,index:++c,value:y}});return bp(f,function(y,b){return a0(y,b,o)})}function Yg(e,i){return ph(e,i,function(o,c){return bc(e,c)})}function ph(e,i,o){for(var c=-1,f=i.length,y={};++c<f;){var b=i[c],I=Gi(e,b);o(I,b)&&es(y,Ti(b,e),I)}return y}function Jg(e){return function(i){return Gi(i,e)}}function Wa(e,i,o,c){var f=c?wp:gn,y=-1,b=i.length,I=e;for(e===i&&(i=dr(i)),o&&(I=_t(e,br(o)));++y<b;)for(var C=0,G=i[y],W=o?o(G):G;(C=f(I,W,C,c))>-1;)I!==e&&no.call(I,C,1),no.call(e,C,1);return e}function gh(e,i){for(var o=e?i.length:0,c=o-1;o--;){var f=i[o];if(o==c||f!==y){var y=f;fi(f)?no.call(e,f,1):Xa(e,f)}}return e}function Ya(e,i){return e+ao(Yu()*(i-e+1))}function Qg(e,i,o,c){for(var f=-1,y=Bt(oo((i-e)/(o||1)),0),b=j(y);y--;)b[c?y:++f]=e,e+=o;return b}function Ja(e,i){var o="";if(!e||i<1||i>k)return o;do i%2&&(o+=e),i=ao(i/2),i&&(e+=e);while(i);return o}function Be(e,i){return dc(kh(e,i,vr),e+"")}function Xg(e){return Xu(On(e))}function Zg(e,i){var o=On(e);return xo(o,Vi(i,0,o.length))}function es(e,i,o,c){if(!wt(e))return e;i=Ti(i,e);for(var f=-1,y=i.length,b=y-1,I=e;I!=null&&++f<y;){var C=Zr(i[f]),G=o;if(C==="__proto__"||C==="constructor"||C==="prototype")return e;if(f!=b){var W=I[C];G=c?c(W,C,I):r,G===r&&(G=wt(W)?W:fi(i[f+1])?[]:{})}Jn(I,C,G),I=I[C]}return e}var vh=co?function(e,i){return co.set(e,i),e}:vr,e0=so?function(e,i){return so(e,"toString",{configurable:!0,enumerable:!1,value:Sc(i),writable:!0})}:vr;function t0(e){return xo(On(e))}function Dr(e,i,o){var c=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var y=j(f);++c<f;)y[c]=e[c+i];return y}function r0(e,i){var o;return Oi(e,function(c,f,y){return o=i(c,f,y),!o}),!!o}function vo(e,i,o){var c=0,f=e==null?c:e.length;if(typeof i=="number"&&i===i&&f<=te){for(;c<f;){var y=c+f>>>1,b=e[y];b!==null&&!Sr(b)&&(o?b<=i:b<i)?c=y+1:f=y}return f}return Qa(e,i,vr,o)}function Qa(e,i,o,c){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var b=i!==i,I=i===null,C=Sr(i),G=i===r;f<y;){var W=ao((f+y)/2),Q=o(e[W]),oe=Q!==r,ve=Q===null,be=Q===Q,ze=Sr(Q);if(b)var Ee=c||be;else G?Ee=be&&(c||oe):I?Ee=be&&oe&&(c||!ve):C?Ee=be&&oe&&!ve&&(c||!ze):ve||ze?Ee=!1:Ee=c?Q<=i:Q<i;Ee?f=W+1:y=W}return Jt(y,Pe)}function yh(e,i){for(var o=-1,c=e.length,f=0,y=[];++o<c;){var b=e[o],I=i?i(b):b;if(!o||!Br(I,C)){var C=I;y[f++]=b===0?0:b}}return y}function _h(e){return typeof e=="number"?e:Sr(e)?V:+e}function Er(e){if(typeof e=="string")return e;if(Ce(e))return _t(e,Er)+"";if(Sr(e))return Ju?Ju.call(e):"";var i=e+"";return i=="0"&&1/e==-Z?"-0":i}function Ai(e,i,o){var c=-1,f=Ws,y=e.length,b=!0,I=[],C=I;if(o)b=!1,f=Pa;else if(y>=a){var G=i?null:d0(e);if(G)return Js(G);b=!1,f=Bn,C=new ki}else C=i?[]:I;e:for(;++c<y;){var W=e[c],Q=i?i(W):W;if(W=o||W!==0?W:0,b&&Q===Q){for(var oe=C.length;oe--;)if(C[oe]===Q)continue e;i&&C.push(Q),I.push(W)}else f(C,Q,o)||(C!==I&&C.push(Q),I.push(W))}return I}function Xa(e,i){return i=Ti(i,e),e=Vh(e,i),e==null||delete e[Zr($r(i))]}function mh(e,i,o,c){return es(e,i,o(Gi(e,i)),c)}function yo(e,i,o,c){for(var f=e.length,y=c?f:-1;(c?y--:++y<f)&&i(e[y],y,e););return o?Dr(e,c?0:y,c?y+1:f):Dr(e,c?y+1:0,c?f:y)}function wh(e,i){var o=e;return o instanceof Ye&&(o=o.value()),Oa(i,function(c,f){return f.func.apply(f.thisArg,Ii([c],f.args))},o)}function Za(e,i,o){var c=e.length;if(c<2)return c?Ai(e[0]):[];for(var f=-1,y=j(c);++f<c;)for(var b=e[f],I=-1;++I<c;)I!=f&&(y[f]=Qn(y[f]||b,e[I],i,o));return Ai(Wt(y,1),i,o)}function bh(e,i,o){for(var c=-1,f=e.length,y=i.length,b={};++c<f;){var I=c<y?i[c]:r;o(b,e[c],I)}return b}function ec(e){return Nt(e)?e:[]}function tc(e){return typeof e=="function"?e:vr}function Ti(e,i){return Ce(e)?e:hc(e,i)?[e]:Jh(it(e))}var i0=Be;function Ri(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Dr(e,i,o)}var Eh=Bp||function(e){return Qe.clearTimeout(e)};function Sh(e,i){if(i)return e.slice();var o=e.length,c=Bu?Bu(o):new e.constructor(o);return e.copy(c),c}function rc(e){var i=new e.constructor(e.byteLength);return new ro(i).set(new ro(e)),i}function n0(e,i){var o=i?rc(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function s0(e){var i=new e.constructor(e.source,Tr.exec(e));return i.lastIndex=e.lastIndex,i}function o0(e){return Yn?ut(Yn.call(e)):{}}function Ih(e,i){var o=i?rc(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function xh(e,i){if(e!==i){var o=e!==r,c=e===null,f=e===e,y=Sr(e),b=i!==r,I=i===null,C=i===i,G=Sr(i);if(!I&&!G&&!y&&e>i||y&&b&&C&&!I&&!G||c&&b&&C||!o&&C||!f)return 1;if(!c&&!y&&!G&&e<i||G&&o&&f&&!c&&!y||I&&o&&f||!b&&f||!C)return-1}return 0}function a0(e,i,o){for(var c=-1,f=e.criteria,y=i.criteria,b=f.length,I=o.length;++c<b;){var C=xh(f[c],y[c]);if(C){if(c>=I)return C;var G=o[c];return C*(G=="desc"?-1:1)}}return e.index-i.index}function Ph(e,i,o,c){for(var f=-1,y=e.length,b=o.length,I=-1,C=i.length,G=Bt(y-b,0),W=j(C+G),Q=!c;++I<C;)W[I]=i[I];for(;++f<b;)(Q||f<y)&&(W[o[f]]=e[f]);for(;G--;)W[I++]=e[f++];return W}function Oh(e,i,o,c){for(var f=-1,y=e.length,b=-1,I=o.length,C=-1,G=i.length,W=Bt(y-I,0),Q=j(W+G),oe=!c;++f<W;)Q[f]=e[f];for(var ve=f;++C<G;)Q[ve+C]=i[C];for(;++b<I;)(oe||f<y)&&(Q[ve+o[b]]=e[f++]);return Q}function dr(e,i){var o=-1,c=e.length;for(i||(i=j(c));++o<c;)i[o]=e[o];return i}function Xr(e,i,o,c){var f=!o;o||(o={});for(var y=-1,b=i.length;++y<b;){var I=i[y],C=c?c(o[I],e[I],I,o,e):r;C===r&&(C=e[I]),f?ui(o,I,C):Jn(o,I,C)}return o}function c0(e,i){return Xr(e,uc(e),i)}function u0(e,i){return Xr(e,qh(e),i)}function _o(e,i){return function(o,c){var f=Ce(o)?pp:Ng,y=i?i():{};return f(o,e,me(c,2),y)}}function Sn(e){return Be(function(i,o){var c=-1,f=o.length,y=f>1?o[f-1]:r,b=f>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,b&&nr(o[0],o[1],b)&&(y=f<3?r:y,f=1),i=ut(i);++c<f;){var I=o[c];I&&e(i,I,c,y)}return i})}function Ah(e,i){return function(o,c){if(o==null)return o;if(!pr(o))return e(o,c);for(var f=o.length,y=i?f:-1,b=ut(o);(i?y--:++y<f)&&c(b[y],y,b)!==!1;);return o}}function Th(e){return function(i,o,c){for(var f=-1,y=ut(i),b=c(i),I=b.length;I--;){var C=b[e?I:++f];if(o(y[C],C,y)===!1)break}return i}}function h0(e,i,o){var c=i&K,f=ts(e);function y(){var b=this&&this!==Qe&&this instanceof y?f:e;return b.apply(c?o:this,arguments)}return y}function Rh(e){return function(i){i=it(i);var o=vn(i)?Hr(i):r,c=o?o[0]:i.charAt(0),f=o?Ri(o,1).join(""):i.slice(1);return c[e]()+f}}function In(e){return function(i){return Oa(Al(Ol(i).replace(Hn,"")),e,"")}}function ts(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=En(e.prototype),c=e.apply(o,i);return wt(c)?c:o}}function l0(e,i,o){var c=ts(e);function f(){for(var y=arguments.length,b=j(y),I=y,C=xn(f);I--;)b[I]=arguments[I];var G=y<3&&b[0]!==C&&b[y-1]!==C?[]:xi(b,C);if(y-=G.length,y<o)return Dh(e,i,mo,f.placeholder,r,b,G,r,r,o-y);var W=this&&this!==Qe&&this instanceof f?c:e;return kt(W,this,b)}return f}function Nh(e){return function(i,o,c){var f=ut(i);if(!pr(i)){var y=me(o,3);i=Vt(i),o=function(I){return y(f[I],I,f)}}var b=e(i,o,c);return b>-1?f[y?i[b]:b]:r}}function Ch(e){return li(function(i){var o=i.length,c=o,f=Lr.prototype.thru;for(e&&i.reverse();c--;){var y=i[c];if(typeof y!="function")throw new Cr(p);if(f&&!b&&So(y)=="wrapper")var b=new Lr([],!0)}for(c=b?c:o;++c<o;){y=i[c];var I=So(y),C=I=="wrapper"?ac(y):r;C&&lc(C[0])&&C[1]==(u|ne|q|m)&&!C[4].length&&C[9]==1?b=b[So(C[0])].apply(b,C[3]):b=y.length==1&&lc(y)?b[I]():b.thru(y)}return function(){var G=arguments,W=G[0];if(b&&G.length==1&&Ce(W))return b.plant(W).value();for(var Q=0,oe=o?i[Q].apply(this,G):W;++Q<o;)oe=i[Q].call(this,oe);return oe}})}function mo(e,i,o,c,f,y,b,I,C,G){var W=i&u,Q=i&K,oe=i&se,ve=i&(ne|F),be=i&J,ze=oe?r:ts(e);function Ee(){for(var Ge=arguments.length,Xe=j(Ge),Ir=Ge;Ir--;)Xe[Ir]=arguments[Ir];if(ve)var sr=xn(Ee),xr=Sp(Xe,sr);if(c&&(Xe=Ph(Xe,c,f,ve)),y&&(Xe=Oh(Xe,y,b,ve)),Ge-=xr,ve&&Ge<G){var Ct=xi(Xe,sr);return Dh(e,i,mo,Ee.placeholder,o,Xe,Ct,I,C,G-Ge)}var kr=Q?o:this,gi=oe?kr[e]:e;return Ge=Xe.length,I?Xe=N0(Xe,I):be&&Ge>1&&Xe.reverse(),W&&C<Ge&&(Xe.length=C),this&&this!==Qe&&this instanceof Ee&&(gi=ze||ts(gi)),gi.apply(kr,Xe)}return Ee}function Lh(e,i){return function(o,c){return jg(o,e,i(c),{})}}function wo(e,i){return function(o,c){var f;if(o===r&&c===r)return i;if(o!==r&&(f=o),c!==r){if(f===r)return c;typeof o=="string"||typeof c=="string"?(o=Er(o),c=Er(c)):(o=_h(o),c=_h(c)),f=e(o,c)}return f}}function ic(e){return li(function(i){return i=_t(i,br(me())),Be(function(o){var c=this;return e(i,function(f){return kt(f,c,o)})})})}function bo(e,i){i=i===r?" ":Er(i);var o=i.length;if(o<2)return o?Ja(i,e):i;var c=Ja(i,oo(e/yn(i)));return vn(i)?Ri(Hr(c),0,e).join(""):c.slice(0,e)}function f0(e,i,o,c){var f=i&K,y=ts(e);function b(){for(var I=-1,C=arguments.length,G=-1,W=c.length,Q=j(W+C),oe=this&&this!==Qe&&this instanceof b?y:e;++G<W;)Q[G]=c[G];for(;C--;)Q[G++]=arguments[++I];return kt(oe,f?o:this,Q)}return b}function Uh(e){return function(i,o,c){return c&&typeof c!="number"&&nr(i,o,c)&&(o=c=r),i=pi(i),o===r?(o=i,i=0):o=pi(o),c=c===r?i<o?1:-1:pi(c),Qg(i,o,c,e)}}function Eo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Mr(i),o=Mr(o)),e(i,o)}}function Dh(e,i,o,c,f,y,b,I,C,G){var W=i&ne,Q=W?b:r,oe=W?r:b,ve=W?y:r,be=W?r:y;i|=W?q:E,i&=~(W?E:q),i&fe||(i&=~(K|se));var ze=[e,i,f,ve,Q,be,oe,I,C,G],Ee=o.apply(r,ze);return lc(e)&&Gh(Ee,ze),Ee.placeholder=c,Wh(Ee,e,i)}function nc(e){var i=Kt[e];return function(o,c){if(o=Mr(o),c=c==null?0:Jt(Fe(c),292),c&&Wu(o)){var f=(it(o)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+c));return f=(it(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return i(o)}}var d0=wn&&1/Js(new wn([,-0]))[1]==Z?function(e){return new wn(e)}:Pc;function $h(e){return function(i){var o=Qt(i);return o==Ie?Ua(i):o==xe?Rp(i):Ep(i,e(i))}}function hi(e,i,o,c,f,y,b,I){var C=i&se;if(!C&&typeof e!="function")throw new Cr(p);var G=c?c.length:0;if(G||(i&=~(q|E),c=f=r),b=b===r?b:Bt(Fe(b),0),I=I===r?I:Fe(I),G-=f?f.length:0,i&E){var W=c,Q=f;c=f=r}var oe=C?r:ac(e),ve=[e,i,o,c,f,W,Q,y,b,I];if(oe&&A0(ve,oe),e=ve[0],i=ve[1],o=ve[2],c=ve[3],f=ve[4],I=ve[9]=ve[9]===r?C?0:e.length:Bt(ve[9]-G,0),!I&&i&(ne|F)&&(i&=~(ne|F)),!i||i==K)var be=h0(e,i,o);else i==ne||i==F?be=l0(e,i,I):(i==q||i==(K|q))&&!f.length?be=f0(e,i,o,c):be=mo.apply(r,ve);var ze=oe?vh:Gh;return Wh(ze(be,ve),e,i)}function Mh(e,i,o,c){return e===r||Br(e,mn[o])&&!nt.call(c,o)?i:e}function Fh(e,i,o,c,f,y){return wt(e)&&wt(i)&&(y.set(i,e),go(e,i,r,Fh,y),y.delete(i)),e}function p0(e){return ns(e)?r:e}function jh(e,i,o,c,f,y){var b=o&M,I=e.length,C=i.length;if(I!=C&&!(b&&C>I))return!1;var G=y.get(e),W=y.get(i);if(G&&W)return G==i&&W==e;var Q=-1,oe=!0,ve=o&H?new ki:r;for(y.set(e,i),y.set(i,e);++Q<I;){var be=e[Q],ze=i[Q];if(c)var Ee=b?c(ze,be,Q,i,e,y):c(be,ze,Q,e,i,y);if(Ee!==r){if(Ee)continue;oe=!1;break}if(ve){if(!Aa(i,function(Ge,Xe){if(!Bn(ve,Xe)&&(be===Ge||f(be,Ge,o,c,y)))return ve.push(Xe)})){oe=!1;break}}else if(!(be===ze||f(be,ze,o,c,y))){oe=!1;break}}return y.delete(e),y.delete(i),oe}function g0(e,i,o,c,f,y,b){switch(o){case Te:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Se:return!(e.byteLength!=i.byteLength||!y(new ro(e),new ro(i)));case U:case P:case He:return Br(+e,+i);case S:return e.name==i.name&&e.message==i.message;case je:case Le:return e==i+"";case Ie:var I=Ua;case xe:var C=c&M;if(I||(I=Js),e.size!=i.size&&!C)return!1;var G=b.get(e);if(G)return G==i;c|=H,b.set(e,i);var W=jh(I(e),I(i),c,f,y,b);return b.delete(e),W;case Ue:if(Yn)return Yn.call(e)==Yn.call(i)}return!1}function v0(e,i,o,c,f,y){var b=o&M,I=sc(e),C=I.length,G=sc(i),W=G.length;if(C!=W&&!b)return!1;for(var Q=C;Q--;){var oe=I[Q];if(!(b?oe in i:nt.call(i,oe)))return!1}var ve=y.get(e),be=y.get(i);if(ve&&be)return ve==i&&be==e;var ze=!0;y.set(e,i),y.set(i,e);for(var Ee=b;++Q<C;){oe=I[Q];var Ge=e[oe],Xe=i[oe];if(c)var Ir=b?c(Xe,Ge,oe,i,e,y):c(Ge,Xe,oe,e,i,y);if(!(Ir===r?Ge===Xe||f(Ge,Xe,o,c,y):Ir)){ze=!1;break}Ee||(Ee=oe=="constructor")}if(ze&&!Ee){var sr=e.constructor,xr=i.constructor;sr!=xr&&"constructor"in e&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return y.delete(e),y.delete(i),ze}function li(e){return dc(kh(e,r,el),e+"")}function sc(e){return sh(e,Vt,uc)}function oc(e){return sh(e,gr,qh)}var ac=co?function(e){return co.get(e)}:Pc;function So(e){for(var i=e.name+"",o=bn[i],c=nt.call(bn,i)?o.length:0;c--;){var f=o[c],y=f.func;if(y==null||y==e)return f.name}return i}function xn(e){var i=nt.call(g,"placeholder")?g:e;return i.placeholder}function me(){var e=g.iteratee||Ic;return e=e===Ic?ch:e,arguments.length?e(arguments[0],arguments[1]):e}function Io(e,i){var o=e.__data__;return I0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function cc(e){for(var i=Vt(e),o=i.length;o--;){var c=i[o],f=e[c];i[o]=[c,f,Kh(f)]}return i}function Wi(e,i){var o=Op(e,i);return ah(o)?o:r}function y0(e){var i=nt.call(e,Ki),o=e[Ki];try{e[Ki]=r;var c=!0}catch{}var f=eo.call(e);return c&&(i?e[Ki]=o:delete e[Ki]),f}var uc=$a?function(e){return e==null?[]:(e=ut(e),Si($a(e),function(i){return Vu.call(e,i)}))}:Oc,qh=$a?function(e){for(var i=[];e;)Ii(i,uc(e)),e=io(e);return i}:Oc,Qt=ir;(Ma&&Qt(new Ma(new ArrayBuffer(1)))!=Te||Vn&&Qt(new Vn)!=Ie||Fa&&Qt(Fa.resolve())!=pt||wn&&Qt(new wn)!=xe||Gn&&Qt(new Gn)!=Ae)&&(Qt=function(e){var i=ir(e),o=i==Me?e.constructor:r,c=o?Yi(o):"";if(c)switch(c){case Zp:return Te;case eg:return Ie;case tg:return pt;case rg:return xe;case ig:return Ae}return i});function _0(e,i,o){for(var c=-1,f=o.length;++c<f;){var y=o[c],b=y.size;switch(y.type){case"drop":e+=b;break;case"dropRight":i-=b;break;case"take":i=Jt(i,e+b);break;case"takeRight":e=Bt(e,i-b);break}}return{start:e,end:i}}function m0(e){var i=e.match(ht);return i?i[1].split(Ft):[]}function zh(e,i,o){i=Ti(i,e);for(var c=-1,f=i.length,y=!1;++c<f;){var b=Zr(i[c]);if(!(y=e!=null&&o(e,b)))break;e=e[b]}return y||++c!=f?y:(f=e==null?0:e.length,!!f&&No(f)&&fi(b,f)&&(Ce(e)||Ji(e)))}function w0(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Hh(e){return typeof e.constructor=="function"&&!rs(e)?En(io(e)):{}}function b0(e,i,o){var c=e.constructor;switch(i){case Se:return rc(e);case U:case P:return new c(+e);case Te:return n0(e,o);case Ke:case Oe:case Ve:case We:case et:case tt:case Je:case er:case lr:return Ih(e,o);case Ie:return new c;case He:case Le:return new c(e);case je:return s0(e);case xe:return new c;case Ue:return o0(e)}}function E0(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(Ot,`{
/* [wrapped with `+i+`] */
`)}function S0(e){return Ce(e)||Ji(e)||!!(Gu&&e&&e[Gu])}function fi(e,i){var o=typeof e;return i=i!=null?i:k,!!i&&(o=="number"||o!="symbol"&&fa.test(e))&&e>-1&&e%1==0&&e<i}function nr(e,i,o){if(!wt(o))return!1;var c=typeof i;return(c=="number"?pr(o)&&fi(i,o.length):c=="string"&&i in o)?Br(o[i],e):!1}function hc(e,i){if(Ce(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||Sr(e)?!0:Dt.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function I0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function lc(e){var i=So(e),o=g[i];if(typeof o!="function"||!(i in Ye.prototype))return!1;if(e===o)return!0;var c=ac(o);return!!c&&e===c[0]}function x0(e){return!!Ku&&Ku in e}var P0=Xs?di:Ac;function rs(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||mn;return e===o}function Kh(e){return e===e&&!wt(e)}function Bh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in ut(o))}}function O0(e){var i=To(e,function(c){return o.size===w&&o.clear(),c}),o=i.cache;return i}function A0(e,i){var o=e[1],c=i[1],f=o|c,y=f<(K|se|u),b=c==u&&o==ne||c==u&&o==m&&e[7].length<=i[8]||c==(u|m)&&i[7].length<=i[8]&&o==ne;if(!(y||b))return e;c&K&&(e[2]=i[2],f|=o&K?0:fe);var I=i[3];if(I){var C=e[3];e[3]=C?Ph(C,I,i[4]):I,e[4]=C?xi(e[3],x):i[4]}return I=i[5],I&&(C=e[5],e[5]=C?Oh(C,I,i[6]):I,e[6]=C?xi(e[5],x):i[6]),I=i[7],I&&(e[7]=I),c&u&&(e[8]=e[8]==null?i[8]:Jt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function T0(e){var i=[];if(e!=null)for(var o in ut(e))i.push(o);return i}function R0(e){return eo.call(e)}function kh(e,i,o){return i=Bt(i===r?e.length-1:i,0),function(){for(var c=arguments,f=-1,y=Bt(c.length-i,0),b=j(y);++f<y;)b[f]=c[i+f];f=-1;for(var I=j(i+1);++f<i;)I[f]=c[f];return I[i]=o(b),kt(e,this,I)}}function Vh(e,i){return i.length<2?e:Gi(e,Dr(i,0,-1))}function N0(e,i){for(var o=e.length,c=Jt(i.length,o),f=dr(e);c--;){var y=i[c];e[c]=fi(y,o)?f[y]:r}return e}function fc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Gh=Yh(vh),is=Vp||function(e,i){return Qe.setTimeout(e,i)},dc=Yh(e0);function Wh(e,i,o){var c=i+"";return dc(e,E0(c,C0(m0(c),o)))}function Yh(e){var i=0,o=0;return function(){var c=Jp(),f=ge-(c-o);if(o=c,f>0){if(++i>=ae)return arguments[0]}else i=0;return e.apply(r,arguments)}}function xo(e,i){var o=-1,c=e.length,f=c-1;for(i=i===r?c:i;++o<i;){var y=Ya(o,f),b=e[y];e[y]=e[o],e[o]=b}return e.length=i,e}var Jh=O0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace($t,function(o,c,f,y){i.push(f?y.replace(oa,"$1"):c||o)}),i});function Zr(e){if(typeof e=="string"||Sr(e))return e;var i=e+"";return i=="0"&&1/e==-Z?"-0":i}function Yi(e){if(e!=null){try{return Zs.call(e)}catch{}try{return e+""}catch{}}return""}function C0(e,i){return Nr(we,function(o){var c="_."+o[0];i&o[1]&&!Ws(e,c)&&e.push(c)}),e.sort()}function Qh(e){if(e instanceof Ye)return e.clone();var i=new Lr(e.__wrapped__,e.__chain__);return i.__actions__=dr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function L0(e,i,o){(o?nr(e,i,o):i===r)?i=1:i=Bt(Fe(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var f=0,y=0,b=j(oo(c/i));f<c;)b[y++]=Dr(e,f,f+=i);return b}function U0(e){for(var i=-1,o=e==null?0:e.length,c=0,f=[];++i<o;){var y=e[i];y&&(f[c++]=y)}return f}function D0(){var e=arguments.length;if(!e)return[];for(var i=j(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Ii(Ce(o)?dr(o):[o],Wt(i,1))}var $0=Be(function(e,i){return Nt(e)?Qn(e,Wt(i,1,Nt,!0)):[]}),M0=Be(function(e,i){var o=$r(i);return Nt(o)&&(o=r),Nt(e)?Qn(e,Wt(i,1,Nt,!0),me(o,2)):[]}),F0=Be(function(e,i){var o=$r(i);return Nt(o)&&(o=r),Nt(e)?Qn(e,Wt(i,1,Nt,!0),r,o):[]});function j0(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:Fe(i),Dr(e,i<0?0:i,c)):[]}function q0(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:Fe(i),i=c-i,Dr(e,0,i<0?0:i)):[]}function z0(e,i){return e&&e.length?yo(e,me(i,3),!0,!0):[]}function H0(e,i){return e&&e.length?yo(e,me(i,3),!0):[]}function K0(e,i,o,c){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&nr(e,i,o)&&(o=0,c=f),Dg(e,i,o,c)):[]}function Xh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=o==null?0:Fe(o);return f<0&&(f=Bt(c+f,0)),Ys(e,me(i,3),f)}function Zh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=c-1;return o!==r&&(f=Fe(o),f=o<0?Bt(c+f,0):Jt(f,c-1)),Ys(e,me(i,3),f,!0)}function el(e){var i=e==null?0:e.length;return i?Wt(e,1):[]}function B0(e){var i=e==null?0:e.length;return i?Wt(e,Z):[]}function k0(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:Fe(i),Wt(e,i)):[]}function V0(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var f=e[i];c[f[0]]=f[1]}return c}function tl(e){return e&&e.length?e[0]:r}function G0(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=o==null?0:Fe(o);return f<0&&(f=Bt(c+f,0)),gn(e,i,f)}function W0(e){var i=e==null?0:e.length;return i?Dr(e,0,-1):[]}var Y0=Be(function(e){var i=_t(e,ec);return i.length&&i[0]===e[0]?Ba(i):[]}),J0=Be(function(e){var i=$r(e),o=_t(e,ec);return i===$r(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Ba(o,me(i,2)):[]}),Q0=Be(function(e){var i=$r(e),o=_t(e,ec);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Ba(o,r,i):[]});function X0(e,i){return e==null?"":Wp.call(e,i)}function $r(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Z0(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=c;return o!==r&&(f=Fe(o),f=f<0?Bt(c+f,0):Jt(f,c-1)),i===i?Cp(e,i,f):Ys(e,Du,f,!0)}function e1(e,i){return e&&e.length?fh(e,Fe(i)):r}var t1=Be(rl);function rl(e,i){return e&&e.length&&i&&i.length?Wa(e,i):e}function r1(e,i,o){return e&&e.length&&i&&i.length?Wa(e,i,me(o,2)):e}function i1(e,i,o){return e&&e.length&&i&&i.length?Wa(e,i,r,o):e}var n1=li(function(e,i){var o=e==null?0:e.length,c=qa(e,i);return gh(e,_t(i,function(f){return fi(f,o)?+f:f}).sort(xh)),c});function s1(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,f=[],y=e.length;for(i=me(i,3);++c<y;){var b=e[c];i(b,c,e)&&(o.push(b),f.push(c))}return gh(e,f),o}function pc(e){return e==null?e:Xp.call(e)}function o1(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&nr(e,i,o)?(i=0,o=c):(i=i==null?0:Fe(i),o=o===r?c:Fe(o)),Dr(e,i,o)):[]}function a1(e,i){return vo(e,i)}function c1(e,i,o){return Qa(e,i,me(o,2))}function u1(e,i){var o=e==null?0:e.length;if(o){var c=vo(e,i);if(c<o&&Br(e[c],i))return c}return-1}function h1(e,i){return vo(e,i,!0)}function l1(e,i,o){return Qa(e,i,me(o,2),!0)}function f1(e,i){var o=e==null?0:e.length;if(o){var c=vo(e,i,!0)-1;if(Br(e[c],i))return c}return-1}function d1(e){return e&&e.length?yh(e):[]}function p1(e,i){return e&&e.length?yh(e,me(i,2)):[]}function g1(e){var i=e==null?0:e.length;return i?Dr(e,1,i):[]}function v1(e,i,o){return e&&e.length?(i=o||i===r?1:Fe(i),Dr(e,0,i<0?0:i)):[]}function y1(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:Fe(i),i=c-i,Dr(e,i<0?0:i,c)):[]}function _1(e,i){return e&&e.length?yo(e,me(i,3),!1,!0):[]}function m1(e,i){return e&&e.length?yo(e,me(i,3)):[]}var w1=Be(function(e){return Ai(Wt(e,1,Nt,!0))}),b1=Be(function(e){var i=$r(e);return Nt(i)&&(i=r),Ai(Wt(e,1,Nt,!0),me(i,2))}),E1=Be(function(e){var i=$r(e);return i=typeof i=="function"?i:r,Ai(Wt(e,1,Nt,!0),r,i)});function S1(e){return e&&e.length?Ai(e):[]}function I1(e,i){return e&&e.length?Ai(e,me(i,2)):[]}function x1(e,i){return i=typeof i=="function"?i:r,e&&e.length?Ai(e,r,i):[]}function gc(e){if(!(e&&e.length))return[];var i=0;return e=Si(e,function(o){if(Nt(o))return i=Bt(o.length,i),!0}),Ca(i,function(o){return _t(e,Ta(o))})}function il(e,i){if(!(e&&e.length))return[];var o=gc(e);return i==null?o:_t(o,function(c){return kt(i,r,c)})}var P1=Be(function(e,i){return Nt(e)?Qn(e,i):[]}),O1=Be(function(e){return Za(Si(e,Nt))}),A1=Be(function(e){var i=$r(e);return Nt(i)&&(i=r),Za(Si(e,Nt),me(i,2))}),T1=Be(function(e){var i=$r(e);return i=typeof i=="function"?i:r,Za(Si(e,Nt),r,i)}),R1=Be(gc);function N1(e,i){return bh(e||[],i||[],Jn)}function C1(e,i){return bh(e||[],i||[],es)}var L1=Be(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,il(e,o)});function nl(e){var i=g(e);return i.__chain__=!0,i}function U1(e,i){return i(e),e}function Po(e,i){return i(e)}var D1=li(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,f=function(y){return qa(y,e)};return i>1||this.__actions__.length||!(c instanceof Ye)||!fi(o)?this.thru(f):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:Po,args:[f],thisArg:r}),new Lr(c,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function $1(){return nl(this)}function M1(){return new Lr(this.value(),this.__chain__)}function F1(){this.__values__===r&&(this.__values__=_l(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function j1(){return this}function q1(e){for(var i,o=this;o instanceof ho;){var c=Qh(o);c.__index__=0,c.__values__=r,i?f.__wrapped__=c:i=c;var f=c;o=o.__wrapped__}return f.__wrapped__=e,i}function z1(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:Po,args:[pc],thisArg:r}),new Lr(i,this.__chain__)}return this.thru(pc)}function H1(){return wh(this.__wrapped__,this.__actions__)}var K1=_o(function(e,i,o){nt.call(e,o)?++e[o]:ui(e,o,1)});function B1(e,i,o){var c=Ce(e)?Lu:Ug;return o&&nr(e,i,o)&&(i=r),c(e,me(i,3))}function k1(e,i){var o=Ce(e)?Si:ih;return o(e,me(i,3))}var V1=Nh(Xh),G1=Nh(Zh);function W1(e,i){return Wt(Oo(e,i),1)}function Y1(e,i){return Wt(Oo(e,i),Z)}function J1(e,i,o){return o=o===r?1:Fe(o),Wt(Oo(e,i),o)}function sl(e,i){var o=Ce(e)?Nr:Oi;return o(e,me(i,3))}function ol(e,i){var o=Ce(e)?gp:rh;return o(e,me(i,3))}var Q1=_o(function(e,i,o){nt.call(e,o)?e[o].push(i):ui(e,o,[i])});function X1(e,i,o,c){e=pr(e)?e:On(e),o=o&&!c?Fe(o):0;var f=e.length;return o<0&&(o=Bt(f+o,0)),Co(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&gn(e,i,o)>-1}var Z1=Be(function(e,i,o){var c=-1,f=typeof i=="function",y=pr(e)?j(e.length):[];return Oi(e,function(b){y[++c]=f?kt(i,b,o):Xn(b,i,o)}),y}),ev=_o(function(e,i,o){ui(e,o,i)});function Oo(e,i){var o=Ce(e)?_t:uh;return o(e,me(i,3))}function tv(e,i,o,c){return e==null?[]:(Ce(i)||(i=i==null?[]:[i]),o=c?r:o,Ce(o)||(o=o==null?[]:[o]),dh(e,i,o))}var rv=_o(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function iv(e,i,o){var c=Ce(e)?Oa:Mu,f=arguments.length<3;return c(e,me(i,4),o,f,Oi)}function nv(e,i,o){var c=Ce(e)?vp:Mu,f=arguments.length<3;return c(e,me(i,4),o,f,rh)}function sv(e,i){var o=Ce(e)?Si:ih;return o(e,Ro(me(i,3)))}function ov(e){var i=Ce(e)?Xu:Xg;return i(e)}function av(e,i,o){(o?nr(e,i,o):i===r)?i=1:i=Fe(i);var c=Ce(e)?Tg:Zg;return c(e,i)}function cv(e){var i=Ce(e)?Rg:t0;return i(e)}function uv(e){if(e==null)return 0;if(pr(e))return Co(e)?yn(e):e.length;var i=Qt(e);return i==Ie||i==xe?e.size:Va(e).length}function hv(e,i,o){var c=Ce(e)?Aa:r0;return o&&nr(e,i,o)&&(i=r),c(e,me(i,3))}var lv=Be(function(e,i){if(e==null)return[];var o=i.length;return o>1&&nr(e,i[0],i[1])?i=[]:o>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),dh(e,Wt(i,1),[])}),Ao=kp||function(){return Qe.Date.now()};function fv(e,i){if(typeof i!="function")throw new Cr(p);return e=Fe(e),function(){if(--e<1)return i.apply(this,arguments)}}function al(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,hi(e,u,r,r,r,r,i)}function cl(e,i){var o;if(typeof i!="function")throw new Cr(p);return e=Fe(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var vc=Be(function(e,i,o){var c=K;if(o.length){var f=xi(o,xn(vc));c|=q}return hi(e,c,i,o,f)}),ul=Be(function(e,i,o){var c=K|se;if(o.length){var f=xi(o,xn(ul));c|=q}return hi(i,c,e,o,f)});function hl(e,i,o){i=o?r:i;var c=hi(e,ne,r,r,r,r,r,i);return c.placeholder=hl.placeholder,c}function ll(e,i,o){i=o?r:i;var c=hi(e,F,r,r,r,r,r,i);return c.placeholder=ll.placeholder,c}function fl(e,i,o){var c,f,y,b,I,C,G=0,W=!1,Q=!1,oe=!0;if(typeof e!="function")throw new Cr(p);i=Mr(i)||0,wt(o)&&(W=!!o.leading,Q="maxWait"in o,y=Q?Bt(Mr(o.maxWait)||0,i):y,oe="trailing"in o?!!o.trailing:oe);function ve(Ct){var kr=c,gi=f;return c=f=r,G=Ct,b=e.apply(gi,kr),b}function be(Ct){return G=Ct,I=is(Ge,i),W?ve(Ct):b}function ze(Ct){var kr=Ct-C,gi=Ct-G,Nl=i-kr;return Q?Jt(Nl,y-gi):Nl}function Ee(Ct){var kr=Ct-C,gi=Ct-G;return C===r||kr>=i||kr<0||Q&&gi>=y}function Ge(){var Ct=Ao();if(Ee(Ct))return Xe(Ct);I=is(Ge,ze(Ct))}function Xe(Ct){return I=r,oe&&c?ve(Ct):(c=f=r,b)}function Ir(){I!==r&&Eh(I),G=0,c=C=f=I=r}function sr(){return I===r?b:Xe(Ao())}function xr(){var Ct=Ao(),kr=Ee(Ct);if(c=arguments,f=this,C=Ct,kr){if(I===r)return be(C);if(Q)return Eh(I),I=is(Ge,i),ve(C)}return I===r&&(I=is(Ge,i)),b}return xr.cancel=Ir,xr.flush=sr,xr}var dv=Be(function(e,i){return th(e,1,i)}),pv=Be(function(e,i,o){return th(e,Mr(i)||0,o)});function gv(e){return hi(e,J)}function To(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Cr(p);var o=function(){var c=arguments,f=i?i.apply(this,c):c[0],y=o.cache;if(y.has(f))return y.get(f);var b=e.apply(this,c);return o.cache=y.set(f,b)||y,b};return o.cache=new(To.Cache||ci),o}To.Cache=ci;function Ro(e){if(typeof e!="function")throw new Cr(p);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function vv(e){return cl(2,e)}var yv=i0(function(e,i){i=i.length==1&&Ce(i[0])?_t(i[0],br(me())):_t(Wt(i,1),br(me()));var o=i.length;return Be(function(c){for(var f=-1,y=Jt(c.length,o);++f<y;)c[f]=i[f].call(this,c[f]);return kt(e,this,c)})}),yc=Be(function(e,i){var o=xi(i,xn(yc));return hi(e,q,r,i,o)}),dl=Be(function(e,i){var o=xi(i,xn(dl));return hi(e,E,r,i,o)}),_v=li(function(e,i){return hi(e,m,r,r,r,i)});function mv(e,i){if(typeof e!="function")throw new Cr(p);return i=i===r?i:Fe(i),Be(e,i)}function wv(e,i){if(typeof e!="function")throw new Cr(p);return i=i==null?0:Bt(Fe(i),0),Be(function(o){var c=o[i],f=Ri(o,0,i);return c&&Ii(f,c),kt(e,this,f)})}function bv(e,i,o){var c=!0,f=!0;if(typeof e!="function")throw new Cr(p);return wt(o)&&(c="leading"in o?!!o.leading:c,f="trailing"in o?!!o.trailing:f),fl(e,i,{leading:c,maxWait:i,trailing:f})}function Ev(e){return al(e,1)}function Sv(e,i){return yc(tc(i),e)}function Iv(){if(!arguments.length)return[];var e=arguments[0];return Ce(e)?e:[e]}function xv(e){return Ur(e,T)}function Pv(e,i){return i=typeof i=="function"?i:r,Ur(e,T,i)}function Ov(e){return Ur(e,N|T)}function Av(e,i){return i=typeof i=="function"?i:r,Ur(e,N|T,i)}function Tv(e,i){return i==null||eh(e,i,Vt(i))}function Br(e,i){return e===i||e!==e&&i!==i}var Rv=Eo(Ka),Nv=Eo(function(e,i){return e>=i}),Ji=oh(function(){return arguments}())?oh:function(e){return At(e)&&nt.call(e,"callee")&&!Vu.call(e,"callee")},Ce=j.isArray,Cv=rr?br(rr):qg;function pr(e){return e!=null&&No(e.length)&&!di(e)}function Nt(e){return At(e)&&pr(e)}function Lv(e){return e===!0||e===!1||At(e)&&ir(e)==U}var Ni=Gp||Ac,Uv=zr?br(zr):zg;function Dv(e){return At(e)&&e.nodeType===1&&!ns(e)}function $v(e){if(e==null)return!0;if(pr(e)&&(Ce(e)||typeof e=="string"||typeof e.splice=="function"||Ni(e)||Pn(e)||Ji(e)))return!e.length;var i=Qt(e);if(i==Ie||i==xe)return!e.size;if(rs(e))return!Va(e).length;for(var o in e)if(nt.call(e,o))return!1;return!0}function Mv(e,i){return Zn(e,i)}function Fv(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Zn(e,i,r,o):!!c}function _c(e){if(!At(e))return!1;var i=ir(e);return i==S||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!ns(e)}function jv(e){return typeof e=="number"&&Wu(e)}function di(e){if(!wt(e))return!1;var i=ir(e);return i==re||i==le||i==D||i==gt}function pl(e){return typeof e=="number"&&e==Fe(e)}function No(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function wt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function At(e){return e!=null&&typeof e=="object"}var gl=Rr?br(Rr):Kg;function qv(e,i){return e===i||ka(e,i,cc(i))}function zv(e,i,o){return o=typeof o=="function"?o:r,ka(e,i,cc(i),o)}function Hv(e){return vl(e)&&e!=+e}function Kv(e){if(P0(e))throw new Re(l);return ah(e)}function Bv(e){return e===null}function kv(e){return e==null}function vl(e){return typeof e=="number"||At(e)&&ir(e)==He}function ns(e){if(!At(e)||ir(e)!=Me)return!1;var i=io(e);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Zs.call(o)==zp}var mc=Jr?br(Jr):Bg;function Vv(e){return pl(e)&&e>=-k&&e<=k}var yl=Kn?br(Kn):kg;function Co(e){return typeof e=="string"||!Ce(e)&&At(e)&&ir(e)==Le}function Sr(e){return typeof e=="symbol"||At(e)&&ir(e)==Ue}var Pn=Hi?br(Hi):Vg;function Gv(e){return e===r}function Wv(e){return At(e)&&Qt(e)==Ae}function Yv(e){return At(e)&&ir(e)==De}var Jv=Eo(Ga),Qv=Eo(function(e,i){return e<=i});function _l(e){if(!e)return[];if(pr(e))return Co(e)?Hr(e):dr(e);if(kn&&e[kn])return Tp(e[kn]());var i=Qt(e),o=i==Ie?Ua:i==xe?Js:On;return o(e)}function pi(e){if(!e)return e===0?e:0;if(e=Mr(e),e===Z||e===-Z){var i=e<0?-1:1;return i*X}return e===e?e:0}function Fe(e){var i=pi(e),o=i%1;return i===i?o?i-o:i:0}function ml(e){return e?Vi(Fe(e),0,ee):0}function Mr(e){if(typeof e=="number")return e;if(Sr(e))return V;if(wt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=wt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Fu(e);var o=ua.test(e);return o||la.test(e)?Ne(e.slice(2),o?2:8):ca.test(e)?V:+e}function wl(e){return Xr(e,gr(e))}function Xv(e){return e?Vi(Fe(e),-k,k):e===0?e:0}function it(e){return e==null?"":Er(e)}var Zv=Sn(function(e,i){if(rs(i)||pr(i)){Xr(i,Vt(i),e);return}for(var o in i)nt.call(i,o)&&Jn(e,o,i[o])}),bl=Sn(function(e,i){Xr(i,gr(i),e)}),Lo=Sn(function(e,i,o,c){Xr(i,gr(i),e,c)}),ey=Sn(function(e,i,o,c){Xr(i,Vt(i),e,c)}),ty=li(qa);function ry(e,i){var o=En(e);return i==null?o:Zu(o,i)}var iy=Be(function(e,i){e=ut(e);var o=-1,c=i.length,f=c>2?i[2]:r;for(f&&nr(i[0],i[1],f)&&(c=1);++o<c;)for(var y=i[o],b=gr(y),I=-1,C=b.length;++I<C;){var G=b[I],W=e[G];(W===r||Br(W,mn[G])&&!nt.call(e,G))&&(e[G]=y[G])}return e}),ny=Be(function(e){return e.push(r,Fh),kt(El,r,e)});function sy(e,i){return Uu(e,me(i,3),Qr)}function oy(e,i){return Uu(e,me(i,3),Ha)}function ay(e,i){return e==null?e:za(e,me(i,3),gr)}function cy(e,i){return e==null?e:nh(e,me(i,3),gr)}function uy(e,i){return e&&Qr(e,me(i,3))}function hy(e,i){return e&&Ha(e,me(i,3))}function ly(e){return e==null?[]:po(e,Vt(e))}function fy(e){return e==null?[]:po(e,gr(e))}function wc(e,i,o){var c=e==null?r:Gi(e,i);return c===r?o:c}function dy(e,i){return e!=null&&zh(e,i,$g)}function bc(e,i){return e!=null&&zh(e,i,Mg)}var py=Lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=eo.call(i)),e[i]=o},Sc(vr)),gy=Lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=eo.call(i)),nt.call(e,i)?e[i].push(o):e[i]=[o]},me),vy=Be(Xn);function Vt(e){return pr(e)?Qu(e):Va(e)}function gr(e){return pr(e)?Qu(e,!0):Gg(e)}function yy(e,i){var o={};return i=me(i,3),Qr(e,function(c,f,y){ui(o,i(c,f,y),c)}),o}function _y(e,i){var o={};return i=me(i,3),Qr(e,function(c,f,y){ui(o,f,i(c,f,y))}),o}var my=Sn(function(e,i,o){go(e,i,o)}),El=Sn(function(e,i,o,c){go(e,i,o,c)}),wy=li(function(e,i){var o={};if(e==null)return o;var c=!1;i=_t(i,function(y){return y=Ti(y,e),c||(c=y.length>1),y}),Xr(e,oc(e),o),c&&(o=Ur(o,N|L|T,p0));for(var f=i.length;f--;)Xa(o,i[f]);return o});function by(e,i){return Sl(e,Ro(me(i)))}var Ey=li(function(e,i){return e==null?{}:Yg(e,i)});function Sl(e,i){if(e==null)return{};var o=_t(oc(e),function(c){return[c]});return i=me(i),ph(e,o,function(c,f){return i(c,f[0])})}function Sy(e,i,o){i=Ti(i,e);var c=-1,f=i.length;for(f||(f=1,e=r);++c<f;){var y=e==null?r:e[Zr(i[c])];y===r&&(c=f,y=o),e=di(y)?y.call(e):y}return e}function Iy(e,i,o){return e==null?e:es(e,i,o)}function xy(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:es(e,i,o,c)}var Il=$h(Vt),xl=$h(gr);function Py(e,i,o){var c=Ce(e),f=c||Ni(e)||Pn(e);if(i=me(i,4),o==null){var y=e&&e.constructor;f?o=c?new y:[]:wt(e)?o=di(y)?En(io(e)):{}:o={}}return(f?Nr:Qr)(e,function(b,I,C){return i(o,b,I,C)}),o}function Oy(e,i){return e==null?!0:Xa(e,i)}function Ay(e,i,o){return e==null?e:mh(e,i,tc(o))}function Ty(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:mh(e,i,tc(o),c)}function On(e){return e==null?[]:La(e,Vt(e))}function Ry(e){return e==null?[]:La(e,gr(e))}function Ny(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Mr(o),o=o===o?o:0),i!==r&&(i=Mr(i),i=i===i?i:0),Vi(Mr(e),i,o)}function Cy(e,i,o){return i=pi(i),o===r?(o=i,i=0):o=pi(o),e=Mr(e),Fg(e,i,o)}function Ly(e,i,o){if(o&&typeof o!="boolean"&&nr(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=pi(e),i===r?(i=e,e=0):i=pi(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var f=Yu();return Jt(e+f*(i-e+at("1e-"+((f+"").length-1))),i)}return Ya(e,i)}var Uy=In(function(e,i,o){return i=i.toLowerCase(),e+(o?Pl(i):i)});function Pl(e){return Ec(it(e).toLowerCase())}function Ol(e){return e=it(e),e&&e.replace(si,Ip).replace(Ia,"")}function Dy(e,i,o){e=it(e),i=Er(i);var c=e.length;o=o===r?c:Vi(Fe(o),0,c);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function $y(e){return e=it(e),e&&vt.test(e)?e.replace(Mi,xp):e}function My(e){return e=it(e),e&&Mt.test(e)?e.replace(xt,"\\$&"):e}var Fy=In(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),jy=In(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),qy=Rh("toLowerCase");function zy(e,i,o){e=it(e),i=Fe(i);var c=i?yn(e):0;if(!i||c>=i)return e;var f=(i-c)/2;return bo(ao(f),o)+e+bo(oo(f),o)}function Hy(e,i,o){e=it(e),i=Fe(i);var c=i?yn(e):0;return i&&c<i?e+bo(i-c,o):e}function Ky(e,i,o){e=it(e),i=Fe(i);var c=i?yn(e):0;return i&&c<i?bo(i-c,o)+e:e}function By(e,i,o){return o||i==null?i=0:i&&(i=+i),Qp(it(e).replace(Pt,""),i||0)}function ky(e,i,o){return(o?nr(e,i,o):i===r)?i=1:i=Fe(i),Ja(it(e),i)}function Vy(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Gy=In(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Wy(e,i,o){return o&&typeof o!="number"&&nr(e,i,o)&&(i=o=r),o=o===r?ee:o>>>0,o?(e=it(e),e&&(typeof i=="string"||i!=null&&!mc(i))&&(i=Er(i),!i&&vn(e))?Ri(Hr(e),0,o):e.split(i,o)):[]}var Yy=In(function(e,i,o){return e+(o?" ":"")+Ec(i)});function Jy(e,i,o){return e=it(e),o=o==null?0:Vi(Fe(o),0,e.length),i=Er(i),e.slice(o,o+i.length)==i}function Qy(e,i,o){var c=g.templateSettings;o&&nr(e,i,o)&&(i=r),e=it(e),i=Lo({},i,c,Mh);var f=Lo({},i.imports,c.imports,Mh),y=Vt(f),b=La(f,y),I,C,G=0,W=i.interpolate||cn,Q="__p += '",oe=Da((i.escape||cn).source+"|"+W.source+"|"+(W===mt?aa:cn).source+"|"+(i.evaluate||cn).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++xa+"]")+`
`;e.replace(oe,function(Ee,Ge,Xe,Ir,sr,xr){return Xe||(Xe=Ir),Q+=e.slice(G,xr).replace(da,Pp),Ge&&(I=!0,Q+=`' +
__e(`+Ge+`) +
'`),sr&&(C=!0,Q+=`';
`+sr+`;
__p += '`),Xe&&(Q+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),G=xr+Ee.length,Ee}),Q+=`';
`;var be=nt.call(i,"variable")&&i.variable;if(!be)Q=`with (obj) {
`+Q+`
}
`;else if(sa.test(be))throw new Re(d);Q=(C?Q.replace(Wr,""):Q).replace(tr,"$1").replace(ni,"$1;"),Q="function("+(be||"obj")+`) {
`+(be?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q+`return __p
}`;var ze=Tl(function(){return rt(y,ve+"return "+Q).apply(r,b)});if(ze.source=Q,_c(ze))throw ze;return ze}function Xy(e){return it(e).toLowerCase()}function Zy(e){return it(e).toUpperCase()}function e_(e,i,o){if(e=it(e),e&&(o||i===r))return Fu(e);if(!e||!(i=Er(i)))return e;var c=Hr(e),f=Hr(i),y=ju(c,f),b=qu(c,f)+1;return Ri(c,y,b).join("")}function t_(e,i,o){if(e=it(e),e&&(o||i===r))return e.slice(0,Hu(e)+1);if(!e||!(i=Er(i)))return e;var c=Hr(e),f=qu(c,Hr(i))+1;return Ri(c,0,f).join("")}function r_(e,i,o){if(e=it(e),e&&(o||i===r))return e.replace(Pt,"");if(!e||!(i=Er(i)))return e;var c=Hr(e),f=ju(c,Hr(i));return Ri(c,f).join("")}function i_(e,i){var o=B,c=ie;if(wt(i)){var f="separator"in i?i.separator:f;o="length"in i?Fe(i.length):o,c="omission"in i?Er(i.omission):c}e=it(e);var y=e.length;if(vn(e)){var b=Hr(e);y=b.length}if(o>=y)return e;var I=o-yn(c);if(I<1)return c;var C=b?Ri(b,0,I).join(""):e.slice(0,I);if(f===r)return C+c;if(b&&(I+=C.length-I),mc(f)){if(e.slice(I).search(f)){var G,W=C;for(f.global||(f=Da(f.source,it(Tr.exec(f))+"g")),f.lastIndex=0;G=f.exec(W);)var Q=G.index;C=C.slice(0,Q===r?I:Q)}}else if(e.indexOf(Er(f),I)!=I){var oe=C.lastIndexOf(f);oe>-1&&(C=C.slice(0,oe))}return C+c}function n_(e){return e=it(e),e&&Et.test(e)?e.replace(bi,Lp):e}var s_=In(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),Ec=Rh("toUpperCase");function Al(e,i,o){return e=it(e),i=o?r:i,i===r?Ap(e)?$p(e):mp(e):e.match(i)||[]}var Tl=Be(function(e,i){try{return kt(e,r,i)}catch(o){return _c(o)?o:new Re(o)}}),o_=li(function(e,i){return Nr(i,function(o){o=Zr(o),ui(e,o,vc(e[o],e))}),e});function a_(e){var i=e==null?0:e.length,o=me();return e=i?_t(e,function(c){if(typeof c[1]!="function")throw new Cr(p);return[o(c[0]),c[1]]}):[],Be(function(c){for(var f=-1;++f<i;){var y=e[f];if(kt(y[0],this,c))return kt(y[1],this,c)}})}function c_(e){return Lg(Ur(e,N))}function Sc(e){return function(){return e}}function u_(e,i){return e==null||e!==e?i:e}var h_=Ch(),l_=Ch(!0);function vr(e){return e}function Ic(e){return ch(typeof e=="function"?e:Ur(e,N))}function f_(e){return hh(Ur(e,N))}function d_(e,i){return lh(e,Ur(i,N))}var p_=Be(function(e,i){return function(o){return Xn(o,e,i)}}),g_=Be(function(e,i){return function(o){return Xn(e,o,i)}});function xc(e,i,o){var c=Vt(i),f=po(i,c);o==null&&!(wt(i)&&(f.length||!c.length))&&(o=i,i=e,e=this,f=po(i,Vt(i)));var y=!(wt(o)&&"chain"in o)||!!o.chain,b=di(e);return Nr(f,function(I){var C=i[I];e[I]=C,b&&(e.prototype[I]=function(){var G=this.__chain__;if(y||G){var W=e(this.__wrapped__),Q=W.__actions__=dr(this.__actions__);return Q.push({func:C,args:arguments,thisArg:e}),W.__chain__=G,W}return C.apply(e,Ii([this.value()],arguments))})}),e}function v_(){return Qe._===this&&(Qe._=Hp),this}function Pc(){}function y_(e){return e=Fe(e),Be(function(i){return fh(i,e)})}var __=ic(_t),m_=ic(Lu),w_=ic(Aa);function Rl(e){return hc(e)?Ta(Zr(e)):Jg(e)}function b_(e){return function(i){return e==null?r:Gi(e,i)}}var E_=Uh(),S_=Uh(!0);function Oc(){return[]}function Ac(){return!1}function I_(){return{}}function x_(){return""}function P_(){return!0}function O_(e,i){if(e=Fe(e),e<1||e>k)return[];var o=ee,c=Jt(e,ee);i=me(i),e-=ee;for(var f=Ca(c,i);++o<e;)i(o);return f}function A_(e){return Ce(e)?_t(e,Zr):Sr(e)?[e]:dr(Jh(it(e)))}function T_(e){var i=++qp;return it(e)+i}var R_=wo(function(e,i){return e+i},0),N_=nc("ceil"),C_=wo(function(e,i){return e/i},1),L_=nc("floor");function U_(e){return e&&e.length?fo(e,vr,Ka):r}function D_(e,i){return e&&e.length?fo(e,me(i,2),Ka):r}function $_(e){return $u(e,vr)}function M_(e,i){return $u(e,me(i,2))}function F_(e){return e&&e.length?fo(e,vr,Ga):r}function j_(e,i){return e&&e.length?fo(e,me(i,2),Ga):r}var q_=wo(function(e,i){return e*i},1),z_=nc("round"),H_=wo(function(e,i){return e-i},0);function K_(e){return e&&e.length?Na(e,vr):0}function B_(e,i){return e&&e.length?Na(e,me(i,2)):0}return g.after=fv,g.ary=al,g.assign=Zv,g.assignIn=bl,g.assignInWith=Lo,g.assignWith=ey,g.at=ty,g.before=cl,g.bind=vc,g.bindAll=o_,g.bindKey=ul,g.castArray=Iv,g.chain=nl,g.chunk=L0,g.compact=U0,g.concat=D0,g.cond=a_,g.conforms=c_,g.constant=Sc,g.countBy=K1,g.create=ry,g.curry=hl,g.curryRight=ll,g.debounce=fl,g.defaults=iy,g.defaultsDeep=ny,g.defer=dv,g.delay=pv,g.difference=$0,g.differenceBy=M0,g.differenceWith=F0,g.drop=j0,g.dropRight=q0,g.dropRightWhile=z0,g.dropWhile=H0,g.fill=K0,g.filter=k1,g.flatMap=W1,g.flatMapDeep=Y1,g.flatMapDepth=J1,g.flatten=el,g.flattenDeep=B0,g.flattenDepth=k0,g.flip=gv,g.flow=h_,g.flowRight=l_,g.fromPairs=V0,g.functions=ly,g.functionsIn=fy,g.groupBy=Q1,g.initial=W0,g.intersection=Y0,g.intersectionBy=J0,g.intersectionWith=Q0,g.invert=py,g.invertBy=gy,g.invokeMap=Z1,g.iteratee=Ic,g.keyBy=ev,g.keys=Vt,g.keysIn=gr,g.map=Oo,g.mapKeys=yy,g.mapValues=_y,g.matches=f_,g.matchesProperty=d_,g.memoize=To,g.merge=my,g.mergeWith=El,g.method=p_,g.methodOf=g_,g.mixin=xc,g.negate=Ro,g.nthArg=y_,g.omit=wy,g.omitBy=by,g.once=vv,g.orderBy=tv,g.over=__,g.overArgs=yv,g.overEvery=m_,g.overSome=w_,g.partial=yc,g.partialRight=dl,g.partition=rv,g.pick=Ey,g.pickBy=Sl,g.property=Rl,g.propertyOf=b_,g.pull=t1,g.pullAll=rl,g.pullAllBy=r1,g.pullAllWith=i1,g.pullAt=n1,g.range=E_,g.rangeRight=S_,g.rearg=_v,g.reject=sv,g.remove=s1,g.rest=mv,g.reverse=pc,g.sampleSize=av,g.set=Iy,g.setWith=xy,g.shuffle=cv,g.slice=o1,g.sortBy=lv,g.sortedUniq=d1,g.sortedUniqBy=p1,g.split=Wy,g.spread=wv,g.tail=g1,g.take=v1,g.takeRight=y1,g.takeRightWhile=_1,g.takeWhile=m1,g.tap=U1,g.throttle=bv,g.thru=Po,g.toArray=_l,g.toPairs=Il,g.toPairsIn=xl,g.toPath=A_,g.toPlainObject=wl,g.transform=Py,g.unary=Ev,g.union=w1,g.unionBy=b1,g.unionWith=E1,g.uniq=S1,g.uniqBy=I1,g.uniqWith=x1,g.unset=Oy,g.unzip=gc,g.unzipWith=il,g.update=Ay,g.updateWith=Ty,g.values=On,g.valuesIn=Ry,g.without=P1,g.words=Al,g.wrap=Sv,g.xor=O1,g.xorBy=A1,g.xorWith=T1,g.zip=R1,g.zipObject=N1,g.zipObjectDeep=C1,g.zipWith=L1,g.entries=Il,g.entriesIn=xl,g.extend=bl,g.extendWith=Lo,xc(g,g),g.add=R_,g.attempt=Tl,g.camelCase=Uy,g.capitalize=Pl,g.ceil=N_,g.clamp=Ny,g.clone=xv,g.cloneDeep=Ov,g.cloneDeepWith=Av,g.cloneWith=Pv,g.conformsTo=Tv,g.deburr=Ol,g.defaultTo=u_,g.divide=C_,g.endsWith=Dy,g.eq=Br,g.escape=$y,g.escapeRegExp=My,g.every=B1,g.find=V1,g.findIndex=Xh,g.findKey=sy,g.findLast=G1,g.findLastIndex=Zh,g.findLastKey=oy,g.floor=L_,g.forEach=sl,g.forEachRight=ol,g.forIn=ay,g.forInRight=cy,g.forOwn=uy,g.forOwnRight=hy,g.get=wc,g.gt=Rv,g.gte=Nv,g.has=dy,g.hasIn=bc,g.head=tl,g.identity=vr,g.includes=X1,g.indexOf=G0,g.inRange=Cy,g.invoke=vy,g.isArguments=Ji,g.isArray=Ce,g.isArrayBuffer=Cv,g.isArrayLike=pr,g.isArrayLikeObject=Nt,g.isBoolean=Lv,g.isBuffer=Ni,g.isDate=Uv,g.isElement=Dv,g.isEmpty=$v,g.isEqual=Mv,g.isEqualWith=Fv,g.isError=_c,g.isFinite=jv,g.isFunction=di,g.isInteger=pl,g.isLength=No,g.isMap=gl,g.isMatch=qv,g.isMatchWith=zv,g.isNaN=Hv,g.isNative=Kv,g.isNil=kv,g.isNull=Bv,g.isNumber=vl,g.isObject=wt,g.isObjectLike=At,g.isPlainObject=ns,g.isRegExp=mc,g.isSafeInteger=Vv,g.isSet=yl,g.isString=Co,g.isSymbol=Sr,g.isTypedArray=Pn,g.isUndefined=Gv,g.isWeakMap=Wv,g.isWeakSet=Yv,g.join=X0,g.kebabCase=Fy,g.last=$r,g.lastIndexOf=Z0,g.lowerCase=jy,g.lowerFirst=qy,g.lt=Jv,g.lte=Qv,g.max=U_,g.maxBy=D_,g.mean=$_,g.meanBy=M_,g.min=F_,g.minBy=j_,g.stubArray=Oc,g.stubFalse=Ac,g.stubObject=I_,g.stubString=x_,g.stubTrue=P_,g.multiply=q_,g.nth=e1,g.noConflict=v_,g.noop=Pc,g.now=Ao,g.pad=zy,g.padEnd=Hy,g.padStart=Ky,g.parseInt=By,g.random=Ly,g.reduce=iv,g.reduceRight=nv,g.repeat=ky,g.replace=Vy,g.result=Sy,g.round=z_,g.runInContext=R,g.sample=ov,g.size=uv,g.snakeCase=Gy,g.some=hv,g.sortedIndex=a1,g.sortedIndexBy=c1,g.sortedIndexOf=u1,g.sortedLastIndex=h1,g.sortedLastIndexBy=l1,g.sortedLastIndexOf=f1,g.startCase=Yy,g.startsWith=Jy,g.subtract=H_,g.sum=K_,g.sumBy=B_,g.template=Qy,g.times=O_,g.toFinite=pi,g.toInteger=Fe,g.toLength=ml,g.toLower=Xy,g.toNumber=Mr,g.toSafeInteger=Xv,g.toString=it,g.toUpper=Zy,g.trim=e_,g.trimEnd=t_,g.trimStart=r_,g.truncate=i_,g.unescape=n_,g.uniqueId=T_,g.upperCase=s_,g.upperFirst=Ec,g.each=sl,g.eachRight=ol,g.first=tl,xc(g,function(){var e={};return Qr(g,function(i,o){nt.call(g.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),g.VERSION=s,Nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){g[e].placeholder=g}),Nr(["drop","take"],function(e,i){Ye.prototype[e]=function(o){o=o===r?1:Bt(Fe(o),0);var c=this.__filtered__&&!i?new Ye(this):this.clone();return c.__filtered__?c.__takeCount__=Jt(o,c.__takeCount__):c.__views__.push({size:Jt(o,ee),type:e+(c.__dir__<0?"Right":"")}),c},Ye.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Nr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==O||o==he;Ye.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:me(f,3),type:o}),y.__filtered__=y.__filtered__||c,y}}),Nr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[o](1).value()[0]}}),Nr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(vr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Be(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(o){return Xn(o,e,i)})}),Ye.prototype.reject=function(e){return this.filter(Ro(me(e)))},Ye.prototype.slice=function(e,i){e=Fe(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Ye(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=Fe(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(ee)},Qr(Ye.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),f=g[c?"take"+(i=="last"?"Right":""):i],y=c||/^find/.test(i);f&&(g.prototype[i]=function(){var b=this.__wrapped__,I=c?[1]:arguments,C=b instanceof Ye,G=I[0],W=C||Ce(b),Q=function(Ge){var Xe=f.apply(g,Ii([Ge],I));return c&&oe?Xe[0]:Xe};W&&o&&typeof G=="function"&&G.length!=1&&(C=W=!1);var oe=this.__chain__,ve=!!this.__actions__.length,be=y&&!oe,ze=C&&!ve;if(!y&&W){b=ze?b:new Ye(this);var Ee=e.apply(b,I);return Ee.__actions__.push({func:Po,args:[Q],thisArg:r}),new Lr(Ee,oe)}return be&&ze?e.apply(this,I):(Ee=this.thru(Q),be?c?Ee.value()[0]:Ee.value():Ee)})}),Nr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Qs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);g.prototype[e]=function(){var f=arguments;if(c&&!this.__chain__){var y=this.value();return i.apply(Ce(y)?y:[],f)}return this[o](function(b){return i.apply(Ce(b)?b:[],f)})}}),Qr(Ye.prototype,function(e,i){var o=g[i];if(o){var c=o.name+"";nt.call(bn,c)||(bn[c]=[]),bn[c].push({name:i,func:o})}}),bn[mo(r,se).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=ng,Ye.prototype.reverse=sg,Ye.prototype.value=og,g.prototype.at=D1,g.prototype.chain=$1,g.prototype.commit=M1,g.prototype.next=F1,g.prototype.plant=q1,g.prototype.reverse=z1,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=H1,g.prototype.first=g.prototype.head,kn&&(g.prototype[kn]=j1),g},_n=Mp();Rt?((Rt.exports=_n)._=_n,ct._=_n):Qe._=_n}).call(vs)})(cu,cu.exports);var E5=Object.defineProperty,S5=Object.defineProperties,I5=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,x5=Object.prototype.hasOwnProperty,P5=Object.prototype.propertyIsEnumerable,td=(n,t,r)=>t in n?E5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,$o=(n,t)=>{for(var r in t||(t={}))x5.call(t,r)&&td(n,r,t[r]);if(ed)for(var r of ed(t))P5.call(t,r)&&td(n,r,t[r]);return n},O5=(n,t)=>S5(n,I5(t));function jn(n,t,r){var s;const a=Gw(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${b5}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function an(n){return n.includes(":")?n.split(":")[1]:n}function fp(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function A5(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=t.namespaces[a].accounts;s.push(...l)}),s}function T5(n={},t={}){const r=rd(n),s=rd(t);return cu.exports.merge(r,s)}function rd(n){var t,r,s,a;const l={};if(!Ln(n))return l;for(const[p,d]of Object.entries(n)){const v=bu(p)?[p]:d.chains,w=d.methods||[],x=d.events||[],N=d.rpcMap||{},L=ys(p);l[L]=O5($o($o({},l[L]),d),{chains:Fc(v,(t=l[L])==null?void 0:t.chains),methods:Fc(w,(r=l[L])==null?void 0:r.methods),events:Fc(x,(s=l[L])==null?void 0:s.events),rpcMap:$o($o({},N),(a=l[L])==null?void 0:a.rpcMap)})}return l}function R5(n){return n.includes(":")?n.split(":")[2]:n}function N5(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],l=s.events||[],p=s.accounts||[],d=bu(r)?[r]:s.chains?s.chains:fp(s.accounts);t[r]={chains:d,methods:a,events:l,accounts:p}}return t}function kc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const dp={},Ut=n=>dp[n],Vc=(n,t)=>{dp[n]=t};class C5{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=an(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}class L5{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||jn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(an(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class U5{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=an(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}class D5{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=an(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}class $5{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=an(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}class M5{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=an(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}class F5{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ut("events"),this.client=Ut("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=an(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||jn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Di(new on(s,Ut("disableProviderPing")))}}var j5=Object.defineProperty,q5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,id=Object.getOwnPropertySymbols,H5=Object.prototype.hasOwnProperty,K5=Object.prototype.propertyIsEnumerable,nd=(n,t,r)=>t in n?j5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Mo=(n,t)=>{for(var r in t||(t={}))H5.call(t,r)&&nd(n,r,t[r]);if(id)for(var r of id(t))K5.call(t,r)&&nd(n,r,t[r]);return n},Gc=(n,t)=>q5(n,z5(t));class Nu{constructor(t){this.events=new hr.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Xf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Nu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Mo({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Lt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=N5(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==lp)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ii(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Ru.init({logger:this.providerOpts.logger||Xf,relayUrl:this.providerOpts.relayUrl||_5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ys(r)))];Vc("client",this.client),Vc("events",this.events),Vc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=A5(r,this.session),a=fp(s),l=T5(this.namespaces,this.optionalNamespaces),p=Gc(Mo({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new L5({namespace:p});break;case"solana":this.rpcProviders[r]=new U5({namespace:p});break;case"cosmos":this.rpcProviders[r]=new D5({namespace:p});break;case"polkadot":this.rpcProviders[r]=new C5({namespace:p});break;case"cip34":this.rpcProviders[r]=new $5({namespace:p});break;case"elrond":this.rpcProviders[r]=new M5({namespace:p});break;case"multiversx":this.rpcProviders[r]=new F5({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&ii(a)&&this.events.emit("accountsChanged",a.map(R5))}else if(s.name==="chainChanged"){const a=r.chainId,l=r.event.data,p=ys(a),d=kc(a)!==kc(l)?`${p}:${kc(l)}`:a;this.onChainChanged(d)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Gc(Mo({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Gc(Mo({},Lt("USER_DISCONNECTED")),{data:t.topic}))}),this.on($i.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>ys(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=ys(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Zf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Zf}/${t}`)}}const B5=Nu,k5="wc",V5="ethereum_provider",G5=`${k5}@2:${V5}:`,W5="https://rpc.walletconnect.com/v1/",uu=["eth_sendTransaction","personal_sign"],Y5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],hu=["chainChanged","accountsChanged"],J5=["chainChanged","accountsChanged","message","disconnect","connect"];var Q5=Object.defineProperty,X5=Object.defineProperties,Z5=Object.getOwnPropertyDescriptors,sd=Object.getOwnPropertySymbols,e3=Object.prototype.hasOwnProperty,t3=Object.prototype.propertyIsEnumerable,od=(n,t,r)=>t in n?Q5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ms=(n,t)=>{for(var r in t||(t={}))e3.call(t,r)&&od(n,r,t[r]);if(sd)for(var r of sd(t))t3.call(t,r)&&od(n,r,t[r]);return n},ad=(n,t)=>X5(n,Z5(t));function Go(n){return Number(n[0].split(":")[1])}function Wc(n){return`0x${n.toString(16)}`}function r3(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:p,rpcMap:d}=n;if(!ii(t))throw new Error("Invalid chains");const v={chains:t,methods:s||uu,events:l||hu,rpcMap:ms({},t.length?{[Go(t)]:d[Go(t)]}:{})},w=l==null?void 0:l.filter(T=>!hu.includes(T)),x=s==null?void 0:s.filter(T=>!uu.includes(T));if(!r&&!p&&!a&&!(w!=null&&w.length)&&!(x!=null&&x.length))return{required:t.length?v:void 0};const N=(w==null?void 0:w.length)&&(x==null?void 0:x.length)||!r,L={chains:[...new Set(N?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(a!=null&&a.length?a:Y5))],events:[...new Set(v.events.concat(p!=null&&p.length?p:J5))],rpcMap:d};return{required:t.length?v:void 0,optional:r.length?L:void 0}}class Cu{constructor(){this.events=new hr.exports.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=G5,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Cu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=r3(this.rpc);try{const a=await new Promise(async(p,d)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(w=>{!w.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ad(ms({namespaces:ms({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(w=>{p(w)}).catch(w=>{d(new Error(w.message))})});if(!a)return;const l=Ww(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:Wc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Wc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",ad(ms({},Lt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Wc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],l=(s=t==null?void 0:t.optionalChains)!=null?s:[],p=a.concat(l);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=a.length?(t==null?void 0:t.methods)||uu:[],v=a.length?(t==null?void 0:t.events)||hu:[],w=(t==null?void 0:t.optionalMethods)||[],x=(t==null?void 0:t.optionalEvents)||[],N=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),L=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(T=>this.formatChainId(T)),optionalChains:l.map(T=>this.formatChainId(T)),methods:d,events:v,optionalMethods:w,optionalEvents:x,rpcMap:N,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:L,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Go(this.rpc.chains):Go(this.rpc.optionalChains),this.signer=await B5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await G_(()=>import("./index.cb201b7c.js").then(a=>a.i),["assets/index.cb201b7c.js","assets/index.e9e0d510.js","assets/index.50fd1e61.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ms({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&ii(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),s&&ii(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${W5}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const a3=Cu;export{a3 as EthereumProvider,J5 as OPTIONAL_EVENTS,Y5 as OPTIONAL_METHODS,hu as REQUIRED_EVENTS,uu as REQUIRED_METHODS,Cu as default};
